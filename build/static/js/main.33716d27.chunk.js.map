{"version":3,"sources":["services/utils.js","media/ua-logo.png","media/github-logo.png","media/applaud.svg","media/iphone_app.png","media sync /^/.//ios_app_store_button_.*/.png$","media/ios_app_store_button_en.png","media/ios_app_store_button_fr.png","initialStore.js","constants.js","reducers/auth.js","reducers/settings.js","reducers/authUser.js","reducers/image-cache.js","reducers/index.js","store.js","components/ScrollToTop.js","services/auth-service.js","services/api-service.js","actions/users.js","actions/auth.js","components/Navbar.js","actions/settings.js","hoc/NavbarContainer.js","components/Footer.js","services/image-service.js","components/ExifOrientationImage.js","components/PostImage.js","components/IconAndText.js","rbac-rules.js","components/Can.js","components/ReportContentModal.js","components/OptionsMenu.js","components/ImageModal.js","components/PostList/PostListItem/index.js","components/PostList/index.js","components/SearchBar/index.js","pages/PostListPage.js","components/RangeSlider/index.js","components/PostEditForm.js","components/UserLink.js","components/CommentList/EditableComment/index.js","components/CommentList/index.js","components/InfoField.js","components/PostDetailInfo.js","pages/PostDetailPage.js","components/SelectedImage.js","components/SelectInput.js","components/InputStatusTag.js","components/ChooseArtist.js","components/TextInput.js","components/GoogleMap.js","components/ChooseLocation.js","components/ChooseDate.js","components/NewPostForm.js","pages/NewPostPage.js","services/location.js","actions/image-cache.js","components/ArtistList/ArtistListItem/index.js","hoc/withArtistProps.js","components/ArtistList/index.js","components/ArtistInfo.js","pages/ArtistListPage.js","components/ArtistEditForm.js","components/PostGallery.js","pages/ArtistProfilePage.js","components/ArtistForm.js","pages/ArtistFormPage.js","actions/artists.js","hoc/ArtistFormContainer.js","components/UserInfo.js","components/UserProfileForm.js","pages/UserProfilePage.js","components/AuthForm.js","pages/LoginPage.js","pages/RegisterPage.js","pages/AboutPage.js","pages/ErrorPage.js","pages/ContactPage.js","hoc/ContactPageContainer.js","pages/PrivacyPolicy.js","pages/TermsOfService.js","pages/UpdatePasswordPage.js","pages/CookieUsage.js","components/MapKitMap.js","hoc/withPostProps.js","pages/IntroPage.js","components/PrivateRoute.js","router/history.js","index.js","router/index.js"],"names":["module","exports","getAddressComponents","place","address","address_components","forEach","c","types","StreetNumber","StreetName","City","State","Zip","Country","timeSince","date","seconds","Math","floor","Date","interval","getUploadsImUrl","file","Promise","resolve","reject","type","match","document","body","className","fd","FormData","append","xhr","XMLHttpRequest","open","onload","url","JSON","parse","responseText","data","img_url","send","getMonthName","getMonth","getCoord","number","ref","l","numerator","denominator","dataURLtoFile","dataurl","filename","arr","split","mime","bstr","atob","n","length","u8arr","Uint8Array","charCodeAt","File","map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","initialstate","auth","role","loggedIn","loading","error","sessionExpires","settings","languagePref","authUser","imageCache","GOOGLE_MAPS_API_KEY","process","REACT_APP_GOOGLE_MAPS_API_KEY","APPLE_MAPS_TOKEN","REACT_APP_APPLE_MAPS_TOKEN","AWS_BUCKET_NAME","REACT_APP_AWS_BUCKET_NAME","AWS_ACCESS_KEY_ID","REACT_APP_AWS_ACCESS_KEY_ID","AWS_SECRET_ACCESS_KEY","REACT_APP_AWS_SECRET_ACCESS_KEY","IMAGES_URL","SERVER_URL","UPLOADS_SUBPATH","REGISTER_REQUEST","REGISTER_SUCCESS","REGISTER_FAILURE","REGISTER_RESET","LOGIN_RESET","LOGIN_REQUEST","LOGIN_SUCCESS","LOGIN_FAILURE","authReducer","currentState","action","assign","expires","passwordCheck","check","settingsReducer","require","isLoaded","initialState","authUserReducer","user","imageCacheReducer","images","rootReducer","combineReducers","middleware","thunk","store","applyMiddleware","createStore","initialStore","ScrollToTop","prevProps","this","props","location","hash","window","scrollTo","children","Component","withRouter","token","base64Url","base64","replace","jsonPayload","decodeURIComponent","toString","slice","join","access_token","refresh_token","tokenPayload","parseJwt","exp","moment","unix","localStorage","setItem","stringify","removeItem","getItem","millisecondsToExpiry","isMoment","diff","_user","APIService","routerPath","httpResponse","console","log","message","path","opts","queryParams","qs","key","encodeURIComponent","endpoint","fetch","then","response","status","handleError","json","catch","options","method","headers","makeRequest","files","fileField","formData","Authorization","res","authService","C","baseURL","apiService","authenticate","values","isNewUser","dispatch","getState","onRegister","onLogin","post","result","onAuthSuccess","beginSession","onLogout","logout","checkLocalAuthState","isAuthenticated","expiry","tokenExpiry","checkPassword","password","feedback","Navbar","toggleHamburger","setState","isHamburgerActive","state","handleClick","hamburgerRef","contains","target","handleLogout","redirect","addEventListener","nextProps","locale","removeEventListener","lang","to","isLoggedIn","username","uid","aria-label","href","src","logo","style","marginRight","copy","node","onClick","setLanguage","paddingRight","activeClassName","initSettings","savedLanguage","initLanguage","connect","appState","authActions","settingsActions","Footer","toggleLanguagePref","nextLang","textAlign","display","flexDirection","alignItems","alignContent","justifyContent","marginTop","marginBottom","githubLogo","spacesEndpoint","AWS","Endpoint","s3","S3","accessKeyId","secretAccessKey","bucketName","postId","upload","Key","uploadsDir","params","Bucket","getObject","err","Body","ExifOrientationImage","getOrientationFromImageURL","imageUrl","blob","arrayBuffer","getOrientation","updateImage","canvas","canvasRef","current","ctx","getContext","clearRect","width","height","image","Image","exifOrientation","indexOf","transform","fill","drawImage","buffer","view","DataView","getUint16","byteLength","offset","marker","getUint32","little","tags","i","React","createRef","prevState","canvasStyle","verticalAlign","CacheableImage","imageSrc","imageURL","storage_location","storageLocation","cachedImageURL","imageService","download","arrayBufferView","Blob","URL","webkitURL","createObjectURL","IconAndText","iconName","iconClassName","iconSrc","defaultProps","iconWidth","rules","contributor","static","dynamic","authUserId","emailOwnerId","postOwnerId","profileOwnerId","admin","artist","anonymous","Can","permissions","staticPermissions","includes","dynamicPermissions","permissionCondition","perform","yes","no","ReportContentModal","onSelect","reason","post_flag","user_reason","didSubmit","submitting","isActive","onClose","promptTitle","report_content_reason_prompt","successTitle","report_content_success","done","cancel","ReasonButton","reasonCopy","OptionsMenu","toggleDropdown","handleClickOutside","refs","dropdown","closeDropdown","onPressReportPost","showReportModal","onCloseReportModal","onDelete","float","UserId","name","delete","report_this_post","ImageModal","handleKeyDown","event","keyCode","showPrevious","showNext","nextIndex","index","imageStorageLocations","class","position","top","maxWidth","flexWrap","PostListItem","handleDelete","handleApplaud","applaudPost","showImageModal","isImageModalActive","hideImageModal","flagPost","cityCopy","Location","city","previewImage","PostImages","Artists","signing_name","count","street_address","country","postal_code","User","createdAt","calendar","onFlag","applauseIcon","Applause","viewComments","Comments","img","PostList","getPosts","query","page","limit","include","posts","get","concat","loadMorePosts","PostId","applause","newItems","item","updatedApplause","push","deleted","splice","selectPost","history","deletePost","confirmDeletePost","onConfirmDeletePost","filter","cancelDeletePost","listItems","onSearchKeyChange","showSearchBar","showAddButton","search","no_post_results","canLoadMore","load_more","itemLimitPerPage","SearchBar","clearText","searchKey","onChange","value","placeholder","searchKeyChangeHandler","bind","cursor","PostListPage","openMap","mapView","closeMap","PostPreview","UserLink","user_id","EditableComment","startEdit","isEditing","editedText","comment","content","cancelEdit","text","saveEdit","submitEdit","onChangeText","work_id","saveEditCopy","cancelEditCopy","onEdit","CommentList","updateNewCommentText","newCommentText","onEnterSubmit","submitComment","getComments","comments","newComment","Post","authModalActive","editComment","commentId","put","deleteComment","toggleShowAllComments","showAllComments","newCommentForm","paddingTop","onKeyUp","maxComments","visibleComments","editedContent","deleteCopy","InfoField","label","emptyText","PostDetail","showModal","galleryModalActive","hideModal","description","PostDetailPage","closeForm","openForm","handleUpdate","onUpdate","getPost","PostEditForm","onSubmit","onCancel","PostDetailInfo","SelectedImage","handleFocus","removeImage","isFocused","handleBlur","imageSource","focusStyle","backgroundColor","overflow","containerStyle","onMouseOver","onMouseOut","color","left","right","zIndex","opacity","objectFit","SelectInput","shouldShowMatches","isCreatingNew","activeElement","input_box","focused","onInputChange","onChangeQuery","setCreatingNew","focus","onChangeSelectionMode","onKeyDown","highlightedOptionIndex","preventDefault","onSelectOption","option","matchList","showMatches","onSelectCreateNew","createNewText","InputStatusTag","successText","onClear","dangerText","ChooseArtist","setUnknown","onCreateArtist","clearInput","onSelectArtist","getArtistMatches","artistMatches","artists","changeSelectionMode","mode","artistName","artistInputType","selectedOption","artistId","TextInput","handleChange","onFocus","refName","idName","title","defaultValue","errorMsg","validationMsg","icon","disabled","didError","isValidated","inputComponent","autoComplete","disableAutocomplete","htmlFor","GoogleMap","placeMarker","google","maps","Marker","panTo","imageData","isScriptLoaded","isScriptLoadSucceed","Map","center","lat","lng","zoom","input","locationQuery","searchBox","places","SearchBox","controls","ControlPosition","TOP_LEFT","handleLocationChange","onLocationChange","markers","geocoder","Geocoder","addListener","geocode","latLng","results","GeocoderStatus","OK","setMap","geometry","setBounds","getBounds","getPlaces","bounds","LatLngBounds","viewport","union","extend","fitBounds","onError","searchPlaceholder","paddingLeft","scriptLoader","constants","ChooseLocation","handleClear","isSelected","formatted_address","ChooseDate","handleDayChange","day","handleSetNow","format","onDayClick","localeUtils","MomentLocaleUtils","NewPostForm","newPost","photo_date","onSelectImages","multiple","fileURLs","borderRadius","artist_signing_name","ArtistId","fieldName","updateNewPost","google_place","NewPostPage","Array","from","getBase64","exifData","setGooglePlaceFromCoords","EXIF","getData","dateString","GPSLongitude","getTag","GPSLongitudeRef","GPSLatitude","GPSLatitudeRef","DateTime","coords","gpsLongitude","gpsLongitudeRef","gpsLatitude","gpsLatitudeRef","buildCoordinatesFromExif","setDateIfEmpty","reader","FileReader","fileURL","urls","addFile","onerror","readAsDataURL","entry","entryParts","comp","currValues","long_name","locality","neighbourhood","neightbourhood","street_num","street_number","route","coordinates","longitude","latitude","google_place_id","place_id","cache","objectURL","addImagesToCache","createdPost","errors","latlng","setPlaceIfEmpty","field","nextState","ArtistListItem","nameText","first_name","last_name","WrappedComponent","ArtistList","getArtists","withArtistProps","getArtist","applaudArtist","selectArtist","deleteArtist","ArtistInfo","bio","none_provided","ArtistEditForm","newValue","newState","handleSubmit","PostGallery","ArtistProfilePage","editing","getArtistPosts","total","ArtistForm","forceUpdate","ArtistFormPage","findArtists","artistQuery","handleCancel","isOpen","redirectTarget","artistList","items","pageSize","receivedAt","now","receiveArtists","findById","receiveArtist","submitNewArtist","AWAIT_NEW_ARTIST_RESPONSE","RECEIVE_NEW_ARTIST_RESPONSE","FAILED_NEW_ARTIST_RESPONSE","startArtistEdit","qid","START_ARTIST_EDIT","cancelArtistEdit","FINISH_ARTIST_EDIT","submitArtistEdit","successful","param","msg","ARTIST_EDIT_ERROR","artistActions","UserInfo","date_joined","UserProfileForm","editedUser","UserProfilePage","toggleEditingMode","isAuthUser","submitUserEdit","getUser","setActiveTab","tabName","activeTab","tabs","tabContent","userId","edit","isEditable","onSubmitUserEdit","applaudedBy","email","tab","AuthForm","form","empty_field_error","toggle","resetAuthForm","registrationStatus","score","warning","suggestions","suggestion","LoginPage","AboutPage","ErrorPage","ContactPage","hasErrors","validateForm","formSubmitted","submit","test","String","toLowerCase","showForm","resetLoginStatus","PrivacyPolicy","TermsOfService","UpdatePasswordPage","fieldErrors","password_again","formError","didSucceed","validate","reduce","memo","pageError","didCheckToken","CookieUsage","withPostProps","mapkit","Coordinate","AnnotationCallout","calloutElementForAnnotation","border","annotation","MarkerAnnotation","callout","addAnnotation","init","authorizationCallback","IntroPage","iosAppStoreButton","copyParts","agreement_on_register","iphoneImg","tagline","terms_of_service","privacy_policy","PrivateRoute","shouldRedirect","rest","render","pathname","createBrowserHistory","App","Cookie","exact","component","UpdatePassword","ReactDOM","getElementById"],"mappings":"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","file":"static/js/main.33716d27.chunk.js","sourcesContent":["function dataURLtoFile(dataurl, filename) {\n            var arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1],\n                bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);\n            while(n--){\n                u8arr[n] = bstr.charCodeAt(n);\n            }\n            return new File([u8arr], filename, {type:mime});\n        }\n\n\nconst getUploadsImUrl = (file) => {\n  return new Promise((resolve, reject) => {\n      if (!file || !file.type.match(/image.*/)) return;\n        document.body.className = \"uploading\";\n        var fd = new FormData();\n        fd.append(\"upload\", file); // Append the file\n        var xhr = new XMLHttpRequest();\n        xhr.open(\"POST\", \"https://uploads.im/api\");\n        xhr.onload = function() {\n        var url = JSON.parse(xhr.responseText).data.img_url\n          resolve(url);\n        }\n        xhr.send(fd);\n  })\n}\n\nconst getMonthName = (date) => {\n  var monthNames = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\n  \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"\n];\n\n  return monthNames[date.getMonth()];\n}\n\n\nconst getAddressComponents = (place) => {\n  var address = {};\n        place.address_components.forEach(function(c) {\n            switch(c.types[0]){\n                case 'street_number':\n                    address.StreetNumber = c;\n                    break;\n                case 'route':\n                    address.StreetName = c;\n                    break;\n                case 'neighborhood': case 'locality':    // North Hollywood or Los Angeles?\n                    address.City = c;\n                    break;\n                case 'administrative_area_level_1':     //  Note some countries don't have states\n                    address.State = c;\n                    break;\n                case 'postal_code':\n                    address.Zip = c;\n                    break;\n                case 'country':\n                    address.Country = c;\n                    break;\n            }\n        });\n\n  return address;\n}\n\nconst timeSince = (date) => {\n\n  var seconds = Math.floor((new Date() - date) / 1000);\n\n  var interval = Math.floor(seconds / 31536000);\n\n  if (interval > 1) {\n    return interval + \" years\";\n  }\n  interval = Math.floor(seconds / 2592000);\n  if (interval > 1) {\n    return interval + \" months\";\n  }\n  interval = Math.floor(seconds / 86400);\n  if (interval > 1) {\n    return interval + \" days\";\n  }\n  interval = Math.floor(seconds / 3600);\n  if (interval > 1) {\n    return interval + \" hours\";\n  }\n  interval = Math.floor(seconds / 60);\n  if (interval > 1) {\n    return interval + \" minutes\";\n  }\n  return Math.floor(seconds) + \" seconds\";\n}\n\nconst memberSince = (date) => {\n  return new Date(date).getFullYear()\n}\n\nconst getCoord = (number, ref) => {\n    var l = number[0].numerator + number[1].numerator /\n      (60 * number[1].denominator) + number[2].numerator / (3600 * number[2].denominator);\n    if (ref == 'W'|'S') {\n      return l*(-1)\n    } else {\n      return l\n    }\n}\n\nmodule.exports = {\n  getAddressComponents: getAddressComponents,\n  timeSince: timeSince,\n  getUploadsImUrl: getUploadsImUrl,\n  getMonthName: getMonthName,\n  getCoord: getCoord,\n  dataURLtoFile: dataURLtoFile\n}\n\n\n\n","module.exports = __webpack_public_path__ + \"static/media/ua-logo.0cebb71a.png\";","module.exports = \"data:image/png;base64,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\"","module.exports = __webpack_public_path__ + \"static/media/applaud.d6f9d63b.svg\";","module.exports = __webpack_public_path__ + \"static/media/iphone_app.ff5030fd.png\";","var map = {\n\t\"./ios_app_store_button_en.png\": 735,\n\t\"./ios_app_store_button_fr.png\": 736\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 734;","module.exports = \"data:image/png;base64,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\"","module.exports = __webpack_public_path__ + \"static/media/ios_app_store_button_fr.7d165d2a.png\";","// @flow\nimport type { AppState } from './types/store';\n\nconst initialstate: AppState = {\n  auth: {\n    role: null,\n    loggedIn: false,\n    loading: false,\n    error: null,\n    sessionExpires: null\n  },\n  settings: {\n    languagePref: \"en\"\n  },\n  authUser: {\n    data: null,\n    loading: false,\n    error: null\n  },\n  imageCache: {}\n};\n\nexport default initialstate;\n","export default {\n  GOOGLE_MAPS_API_KEY: process.env.REACT_APP_GOOGLE_MAPS_API_KEY,\n  APPLE_MAPS_TOKEN: process.env.REACT_APP_APPLE_MAPS_TOKEN,\n  AWS_BUCKET_NAME: process.env.REACT_APP_AWS_BUCKET_NAME,\n  AWS_ACCESS_KEY_ID: process.env.REACT_APP_AWS_ACCESS_KEY_ID,\n  AWS_SECRET_ACCESS_KEY: process.env.REACT_APP_AWS_SECRET_ACCESS_KEY,\n  IMAGES_URL: `https://${process.env.REACT_APP_AWS_BUCKET_NAME}.nyc3.cdn.digitaloceanspaces.com/uploads`,\n  // https://urbanapplausedev.nyc3.cdn.digitaloceanspaces.com/uploads/24af45e0-0c68-11ea-99ea-7fe7b8110c7d\n  //SERVER URLS\n  SERVER_URL: process.env.NODE_ENV==\"development\" ? \"http://localhost:8080\" : \"https://api.urbanapplause.com\",\n  UPLOADS_SUBPATH: \"api/uploads\",\n\n // AUTH ACTIONS\n  REGISTER_REQUEST: \"REGISTER_REQUEST\",\n  REGISTER_SUCCESS: \"REGISTER_SUCCESS\",\n  REGISTER_FAILURE: \"REGISTER_FAILURE\",\n  REGISTER_RESET: \"REGISTER_RESET\",\n  LOGIN_RESET: \"LOGIN_RESET\",\n\n\n  LOGIN_REQUEST: \"LOGIN_REQUEST\",\n  LOGIN_SUCCESS: \"LOGIN_SUCCESS\",\n  LOGIN_FAILURE: \"LOGIN_FAILURE\",\n\n  REGISTER_RESET: \"REGISTER_RESET\",\n\tATTEMPTING_LOGIN: \"ATTEMPTING_LOGIN\",\n\tLOGIN_USER: \"LOGIN_USER\",\n\tLOGOUT: \"LOGOUT\",\n\n\t// AUTH STATES\n\tLOGGED_IN: \"LOGGED_IN\",\n\tANONYMOUS: \"ANONYMOUS\",\n  AWAITING_AUTH_RESPONSE: \"AWAITING_AUTH_RESPONSE\",\n\n  // WORK ACTIONS\n  SET_NEW_FILES: \"SET_NEW_FILES\",\n  AWAIT_IMAGE_UPLOAD_RESPONSE: \"AWAIT_IMAGE_UPLOAD_RESPONSE\",\n  IMAGE_UPLOAD_SUCCESS: \"IMAGE_UPLOAD_SUCCESS\",\n\n  REQUEST_WORKS_DATA: \"REQUEST_WORKS_DATA\",\n  RECEIVE_WORKS_DATA: \"RECEIVE_WORKS_DATA\",\n  WORKS_DATA_ERROR: \"WORKS_DATA_ERROR\",\n\n  REQUEST_WORK_DATA: \"REQUEST_WORK_DATA\",\n\tRECEIVE_WORK_DATA: \"RECEIVE_WORK_DATA\",\n\tAWAIT_NEW_WORK_RESPONSE: \"AWAIT_NEW_WORK_RESPONSE\",\n  RECEIVE_NEW_WORK_RESPONSE: \"RECEIVE_NEW_WORK_RESPONSE\",\n\n\tFAILED_NEW_WORK_RESPONSE: \"FAILED_NEW_WORK_RESPONSE\",\n\tSTART_WORK_EDIT: \"START_WORK_EDIT\",\n\tFINISH_WORK_EDIT: \"FINISH_WORK_EDIT\",\n  SUBMIT_WORK_EDIT: \"SUBMIT_WORK_EDIT\",\n\n  // COMMENT ACTIONS\n\n  REQUEST_COMMENTS_DATA: \"REQUEST_COMMENTS_DATA\",\n  RECEIVE_COMMENTS_DATA: \"RECEIVE_COMMENTS_DATA\",\n\n\tAWAIT_NEW_COMMENT_RESPONSE: \"AWAIT_NEW_COMMENT_RESPONSE\",\n  RECEIVE_NEW_COMMENT_RESPONSE: \"RECEIVE_NEW_COMMENT_RESPONSE\",\n  FAILED_NEW_COMMENT_RESPONSE: \"FAILED_NEW_COMMENT_RESPONSE\",\n\n\tSTART_COMMENT_EDIT: \"START_COMMENT_EDIT\",\n\tFINISH_COMMENT_EDIT: \"FINISH_COMMENT_EDIT\",\n  SUBMIT_COMMENT_EDIT: \"SUBMIT_COMMENT_EDIT\",\n\n  // ARTIST ACTIONS\n  REQUEST_ARTISTS_DATA: \"REQUEST_ARTISTS_DATA\",\n  RECEIVE_ARTISTS_DATA: \"RECEIVE_ARTISTS_DATA\",\n\n  REQUEST_ARTIST_DATA: \"REQUEST_ARTIST_DATA\",\n  RECEIVE_ARTIST_DATA: \"RECEIVE_ARTIST_DATA\",\n\tAWAIT_NEW_ARTIST_RESPONSE: \"AWAIT_NEW_ARTIST_RESPONSE\",\n\tRECEIVE_NEW_ARTIST_RESPONSE: \"RECEIVE_NEW_ARTIST_RESPONSE\",\n\tSTART_ARTIST_EDIT: \"START_ARTIST_EDIT\",\n  ARTIST_EDIT_ERROR: \"ARTIST_EDIT_ERROR\",\n\tARITST_EDIT_SUCCESS: \"ARTIST_EDIT_SUCCESS\",\n\n  //USER ACTIONS\n  //\n  REQUEST_USERS_DATA: \"REQUEST_USERS_DATA\",\n  RECEIVE_USERS_DATA: \"RECEIVE_USERS_DATA\",\n  REQUEST_USER_DATA: \"REQUEST_USER_DATA\",\n\tRECEIVE_USER_DATA: \"RECEIVE_USER_DATA\",\n\tAWAIT_NEW_USER_RESPONSE: \"AWAIT_NEW_USER_RESPONSE\",\n\tRECEIVE_NEW_USER_RESPONSE: \"RECEIVE_NEW_USER_RESPONSE\",\n\tSTART_USER_EDIT: \"START_USER_EDIT\",\n\tFINISH_USER_EDIT: \"FINISH_USER_EDIT\",\n  SUBMIT_USER_EDIT: \"SUBMIT_USER_EDIT\",\n\n  };\n\n\n","import initialstate from \"../initialStore\";\nimport C from '../constants';\n\nconst authReducer = (currentState,action) => {\n  switch(action.type){\n    case 'RESET_AUTH_FORM':\n      return initialstate.auth;\n    case 'AUTH_REQUEST':\n      return Object.assign({},currentState, {\n        loading: true\n      })\n    case 'AUTH_SUCCESS':\n      return Object.assign({},currentState,{\n        role: action.role,\n        loggedIn: true,\n        loading: false,\n        sessionExpires: action.expires,\n        error: null\n      })\n    case 'AUTH_ERROR':\n      return Object.assign({},currentState,{\n        loggedIn: false,\n        loading: false,\n        error: action.error\n      })\n\t\tcase 'LOGOUT':\n\t\t\treturn Object.assign({},currentState,{\n        loggedIn: false,\n        loading: false,\n        error: null,\n        sessionExpires: null\n      });\n\t\tcase 'GET_PASSWORD_CHECK_SUCCESS':\n\t\t\treturn Object.assign({},currentState,{\n        passwordCheck: action.check\n\t\t\t});\n    default:\n      return currentState || initialstate.auth;\n\t}\n}\n\nexport default authReducer;\n","import C from \"../constants\";\nimport initialState from \"../initialStore\";\nvar  _ = require(\"lodash\");\n\n\nconst settingsReducer = (currentState, action) => {\n\tvar newstate;\n  switch(action.type){\n    case 'INIT_SETTINGS_SUCCESS':\n      return Object.assign({}, currentState, {\n        isLoaded: true\n      });\n    case 'SET_LANGUAGE':\n      return Object.assign({}, currentState, {\n        languagePref: action.languagePref\n      });\n  default:\n      return currentState || initialState.settings;\n\t}\n};\n\nexport default settingsReducer;\n","import initialstate from \"../initialStore\";\nimport C from '../constants';\n\nconst authUserReducer = (currentState,action) => {\n  switch(action.type){\n    case 'GET_AUTH_USER_REQUEST':\n      return Object.assign({},currentState, {\n        loading: true\n      })\n    case 'GET_AUTH_USER_SUCCESS':\n      return Object.assign({},currentState,{\n        loading: false,\n        data: action.user,\n        error: null\n      })\n    case 'GET_AUTH_USER_ERROR':\n      return Object.assign({},currentState,{\n        loading: false,\n        error: action.error\n      })\n    default:\n      return currentState || initialstate.auth;\n\t}\n}\n\nexport default authUserReducer;\n","import initialstate from \"../initialStore\";\nimport C from '../constants';\n\nconst imageCacheReducer = (currentState,action) => {\n  switch(action.type){\n    case 'ADD_IMAGES':\n      return Object.assign({}, currentState, action.images)\n    case 'CLEAR':\n      return {}\n    default:\n      return currentState || initialstate.imageCache;\n\t}\n}\n\nexport default imageCacheReducer;\n","// @flow\nimport { combineReducers } from 'redux';\n\nimport auth from './auth';\nimport settings from './settings';\nimport authUser from './authUser';\nimport imageCache from './image-cache';\n\nconst rootReducer = combineReducers({\n  auth,\n  settings,\n  authUser,\n  imageCache\n});\n\nexport default rootReducer;\n\n","// @flow\nimport {createStore, applyMiddleware } from 'redux';\nimport thunk from 'redux-thunk';\nimport logger from 'redux-logger';\nimport rootReducer from './reducers';\nimport initialStore from './initialStore';\n\nvar middleware = [thunk];\nif(process.env.NODE_ENV==\"development\"){\n  middleware = [...middleware, logger]\n}\nconst store = applyMiddleware(...middleware)(createStore)(rootReducer,initialStore);\n\nexport default store;\n\n","// @flow\nimport React, { Component } from 'react';\nimport { withRouter } from 'react-router-dom';\n\ntype Props = {\n  location: {\n    hash: string\n  },\n  children: any\n}\n\nclass ScrollToTop extends Component<Props> {\n  componentDidUpdate(prevProps: Props) {\n    if (this.props.location !== prevProps.location) {\n      // location has changed\n      const hasHash = this.props.location.hash && this.props.location.hash.length;\n      if (hasHash) return;\n      window.scrollTo(0, 0)\n    }\n  }\n\n  render() {\n    return this.props.children\n  }\n}\n\nexport default withRouter(ScrollToTop)\n","// @flow\nimport moment from 'moment';\nimport type { User } from '../types/user';\nimport type { AccessTokenPayload } from '../types/auth';\n\nexport class AuthService {\n  get isAuthenticated(): boolean {\n    const token: ?string = localStorage.getItem('token');\n    const tokenPayload = token && this.parseJwt(token);\n    const expires = tokenPayload && tokenPayload.exp && moment.unix(tokenPayload.exp);\n    const millisecondsToExpiry = (expires && moment.isMoment(expires)) ? expires.diff(moment()) : 0;\n    if (token && millisecondsToExpiry > 0) {\n      return true;\n    }\n    return false;\n  }\n\n  parseJwt (token: string): ?AccessTokenPayload {\n    if (token) {\n      var base64Url = token.split('.')[1];\n      if (!base64Url) { return null }\n\n      var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\n      var jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {\n        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\n      }).join(''));\n\n      return JSON.parse(jsonPayload);\n    } else {\n      return null\n    }\n  };\n  beginSession (access_token: string, refresh_token: string, user: User) {\n    const tokenPayload = this.parseJwt(access_token);\n    const expires = tokenPayload && tokenPayload.exp ? moment.unix(tokenPayload.exp) : '';\n    const role = tokenPayload ? tokenPayload['role'] : '';\n    localStorage.setItem('exp', expires);\n    localStorage.setItem('token', access_token);\n    localStorage.setItem('user', JSON.stringify(user));\n  }\n  logout () {\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n    localStorage.removeItem('exp');\n  }\n\n  tokenExpiry(): ?moment {\n    let tokenPayload = this.token && this.parseJwt(this.token);\n    return tokenPayload && tokenPayload.exp && moment.unix(tokenPayload.exp);\n  }\n\n  get user(): ?User {\n    const _user = localStorage.getItem('user');\n    if (_user) {\n      return JSON.parse(_user)\n    }\n    return null;\n  }\n\n  get token(): ?string {\n    return localStorage.getItem('token');\n  }\n  get tokenPayload(): ?AccessTokenPayload {\n    return this.token ? this.parseJwt(this.token) : null;\n  }\n  get role (): ?Role {\n    return this.tokenPayload ? this.tokenPayload.role : null;\n  }\n}\n\nexport default new AuthService();\n","// @flow\n\nimport C from '../constants';\nimport authService from './auth-service';\n\ntype APIError = {\n  name: string,\n  message: string,\n  code: string,\n  status: number\n}\ntype APIResponseBody = {\n  error: ?APIError,\n  [string]: any\n}\n\nexport class APIService {\n  routerPath: ?string\n\n  constructor(routerPath: ?string) {\n    this.routerPath = routerPath;\n  }\n  get token(): ?string {\n    return authService.token;\n  }\n\n  get endpoint(): string {\n    if (this.routerPath) {\n      return `${C.SERVER_URL}/${this.routerPath}`\n    }\n    return `${C.SERVER_URL}/app`;\n  }\n  get headers(): any {\n    const token = localStorage.getItem('token');\n    const headers = {};\n    headers['Content-Type'] = 'application/json';\n    headers.Authorization = `Bearer ${token || ''}`;\n    return headers;\n  }\n\n    /* handleAPIError(error: APIError): Promise<string> {\n    console.log('handle api error ', error);\n    if (error.message) {\n      return Promise.reject(error.message);\n    }\n    return Promise.reject('An error occurred');\n  } */\n  handleError(error: Error, httpResponse: ?Response): Promise<string> {\n    console.log('handle error: ', error);\n    if (httpResponse) {\n      console.log('response: ', httpResponse);\n    } else {\n      console.log('no response');\n    }\n    if (error.message) {\n      return Promise.reject(error.message);\n    }\n    return Promise.reject('An error occurred');\n  }\n  makeRequest(path: string, opts: RequestOptions = {}, queryParams: {[string]: any} = {}): Promise<any> {\n    let qs = \"\";\n    if (queryParams) {\n      qs = Object.keys(queryParams).map(key => {\n        return encodeURIComponent(key) + '=' + encodeURIComponent(queryParams[key]);\n      }).join('&');\n    }\n    if (qs.length) {\n      qs = \"?\" + qs;\n    }\n    const endpoint = `${this.endpoint}${path}${qs}`;\n    var httpResponse: ?Response;\n    return fetch(endpoint, opts)\n    .then((response: Response) => {\n      httpResponse = response;\n      if (response.status == 404) {\n        return this.handleError(Error('404 Error'))\n      }\n      return response.json()\n    })\n    .then((json) => {\n      /*      if (!response.ok) {\n        return Promise.reject({ error: response.statusText });\n      } */\n      if (json.error) {\n        return Promise.reject(json.error);\n      } else {\n        return Promise.resolve(json);\n      }\n    })\n    .catch((error) => this.handleError(error, httpResponse)); // json parsing errors caught here.\n  }\n\n  get(path: string, options: any = {}, queryParams: {[string]: any}): Promise<any> {\n    const opts = Object.assign({}, {\n      method: 'get',\n      headers: this.headers\n    }, options);\n    return this.makeRequest(path, opts, queryParams);\n  }\n\n  post(path: string, body: any): Promise<any> {\n    const opts = {\n      method: 'post',\n      headers: this.headers,\n      body: JSON.stringify(body)\n    }\n    return this.makeRequest(path, opts);\n  }\n\n  put(path: string, body: any): Promise<any> {\n    const opts = {\n      method: 'put',\n      headers: this.headers,\n      body: JSON.stringify(body)\n    }\n    return this.makeRequest(path, opts);\n  }\n  patch(path: string, body: any): Promise<any> {\n    const opts = {\n      method: 'patch',\n      headers: this.headers,\n      body: JSON.stringify(body)\n    }\n    return this.makeRequest(path, opts);\n  }\n\n  delete(path: string, body: any): Promise<any> {\n    const opts = {\n      method: 'delete',\n      headers: this.headers,\n    }\n    return this.makeRequest(path, opts);\n  }\n\n  upload(path: string, files: Array<File>, fileField: string) {\n    var formData  = new FormData();\n    files.forEach(file => {\n      formData.append(fileField, file);\n    })\n\n    const token = localStorage.getItem('token');\n    const headers = {};\n    headers.Authorization = `Bearer ${token || ''}`;\n\n    return fetch(this.endpoint + path, {\n      method: \"POST\",\n      body: formData,\n      headers\n      })\n      .then((res) => res.json())\n      .then((json) => {\n          return Promise.resolve(json);\n        })\n  }\n}\n\nexport default new APIService();\n\n","import { User } from '../types/user';\nimport C from '../constants';\nimport apiService from '../services/api-service';\n\nlet baseURL = C.SERVER_URL;\n\nfunction requestUsers(values) {\n  return {\n    type: C.REQUEST_USERS_DATA,\n  }\n}\n\nfunction receiveUsers(data) {\n  return {\n    type: C.RECEIVE_USERS_DATA,\n    items: data.items,\n    page: data.page,\n    pageSize: data.pageSize,\n    total: data.total,\n    receivedAt: Date.now()\n  }\n}\nfunction setUser(user) {\n  return {\n    type: 'GET_USER_SUCCESS',\n    user\n  }\n}\n\nfunction getUsers(values: Array<string>) {\n  return function(dispatch){\n    dispatch(requestUsers(values));\n    let qs = \"\";\n    if (values) {\n        qs = Object.keys(values).map(key => {\n            return encodeURIComponent(key) + '=' + encodeURIComponent(values[key]);\n        }).join('&');\n        qs = \"?\" + qs;\n    }\n    return apiService.get(\"/users\" + qs, {})\n      .then(data => dispatch(receiveUsers(data)));\n  }\n}\n\nfunction getUserApplause(userId: number) {\n  return function(dispatch: Dispatch, getState: GetState) {\n    dispatch({ type: 'GET_USER_APPLAUSE_REQUEST' });\n    const qs = `?UserId=${userId}&include=post`;\n    const opts = {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }\n    return apiService.get(\"/applause\" + qs, opts)\n      .then((json) => {\n        if (json.applause) {\n          return dispatch({ type: 'GET_USER_APPLAUSE_SUCCESS', applause: json.applause })\n        }\n      })\n      .catch((error) => {\n        dispatch({\n          type: 'GET_USER_APPLAUSE_ERROR',\n          error\n        })\n      });\n  }\n}\nfunction getUserPosts(userId: number) {\n  return function(dispatch: Dispatch, getState: GetState) {\n    dispatch({ type: 'GET_USER_POSTS_REQUEST' });\n    const qs = `?UserId=${userId}`;\n    const opts = {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }\n    return apiService(\"/posts\" + qs, opts)\n      .then((json) => {\n        if (json.posts) {\n          return dispatch({ type: 'GET_USER_POSTS_SUCCESS', posts: json.posts})\n        }\n      })\n      .catch((error) => {\n        dispatch({\n          type: 'GET_USER_POSTS_ERROR',\n          error\n        })\n      });\n  }\n}\nfunction submitUserEdit(id, values) {\n  return function(dispatch, getState){\n    const token = localStorage.getItem('token');\n    const userString = localStorage.getItem('user');\n    const user = userString && JSON.parse(userString);\n    dispatch({type: 'UPDATE_USER_REQUEST', id: id, values: values});\n    return fetch(baseURL + \"/api/users/\" + id, {\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      method: \"PUT\",\n      body: JSON.stringify({ user: Object.assign({}, values, {\n        UserId: user.id\n      })}),\n    })\n      .then((res) => res.json())\n      .then((json) => {\n        return dispatch ({\n          type: 'UPDATE_USER_SUCCESS',\n          user: json.user\n        });\n      })\n      .catch((error) => dispatch({ type: 'UPDATE_USER_ERROR', error }));\n  }\n}\n\nfunction findById(id) {\n  console.log('find id for', id);\n  return function(dispatch){\n    dispatch(requestUser(id));\n    return fetch(baseURL + \"/api/users/\" + id + \"?include=applause\")\n      .then(res => res.json())\n      .then(data => dispatch(receiveUser(data)));\n  }\n}\nfunction requestUser(id) {\n  return {\n    type: 'GET_USER_REQUEST',\n  }\n}\n\nfunction receiveUser(data) {\n  return {\n    type: 'GET_USER_SUCCESS',\n    user: data.user\n  }\n}\n\nconst startUserEdit = (qid) => {\n\t\treturn {type:C.START_USER_EDIT,qid};\n}\n\nconst cancelUserEdit = (qid) => {\n\t\treturn {type:C.FINISH_USER_EDIT,qid};\n}\n\nexport default {\n  getUsers,\n  findById,\n  startUserEdit,\n  cancelUserEdit,\n  submitUserEdit,\n  setUser,\n  getUserApplause,\n  getUserPosts\n};\n","// @flow\nimport C from '../constants';\nimport moment from 'moment';\nimport type { User, AuthForm, Role } from '../types/user';\nimport type { Dispatch, GetState } from '../types/redux';\n//import {history} from '../router'\nimport userActions from './users';\nimport { APIService } from '../services/api-service';\nimport authService from '../services/auth-service';\nlet baseURL = C.SERVER_URL;\n\nconst apiService = new APIService()\napiService.routerPath = 'auth';\n\nexport const resetAuthForm = () => {\n  return function(dispatch: Dispatch, getState: GetState){\n    return dispatch({ type: 'RESET_AUTH_FORM' });\n  };\n}\nexport const authenticate = (values: AuthForm, isNewUser: boolean) => {\n  return function(dispatch: Dispatch, getState: GetState){\n    if (isNewUser) {\n      return dispatch(onRegister(values));\n    } else {\n      return dispatch(onLogin(values));\n    }\n  }\n}\n\nconst onLogin = (values: AuthForm) => {\n  return function(dispatch: Dispatch, getState: GetState){\n    dispatch({ type: 'AUTH_REQUEST' });\n    return apiService.post('/login', { user: values })\n      .then((result) => {\n        if (result.error) {\n          return dispatch({ type:'AUTH_ERROR', error: result.error.message });\n        } else {\n          return dispatch(onAuthSuccess(result.access_token, result.refresh_token, result.user));\n        }\n      })\n      .catch((error) => {\n        return dispatch({ type:'AUTH_ERROR', error });\n      });\n  }\n}\n\nconst onAuthSuccess = (access_token: string, refresh_token: string, user: User) => {\n  return function(dispatch: Dispatch, getState: GetState){\n    authService.beginSession(access_token, refresh_token, user);\n    dispatch({ type: 'GET_AUTH_USER_SUCCESS', user });\n    return dispatch({ type: 'AUTH_SUCCESS', role: authService.role });\n  }\n}\n\nconst onRegister = (values: AuthForm) => {\n  return function(dispatch: Dispatch, getState: GetState){\n    dispatch({type: 'AUTH_REQUEST'});\n    return apiService.post('/register', { user: values })\n      .then((result) => {\n        if (result.error) {\n          return dispatch({ type:'AUTH_ERROR', error: result.error.message });\n        }\n        return dispatch(onAuthSuccess(result.access_token, result.refresh_token, result.user));\n      })\n      .catch((error) => {\n        dispatch({ type:'AUTH_ERROR', error });\n      });\n  }\n}\nconst checkPassword = (password: string) => {\n  return function(dispatch: Dispatch, getState: GetState) {\n    dispatch({ type: 'GET_PASSWORD_CHECK_REQUEST' });\n    return fetch(baseURL + \"/public/password-check\", {method: \"POST\", body: JSON.stringify({ password }), headers: {'Content-Type': 'application/json'}})\n      .then((res) => {\n        return res.json()\n      })\n      .then((result) => {\n        return dispatch({ type: 'GET_PASSWORD_CHECK_SUCCESS', check: result.feedback });\n      })\n      .catch((error) => {\n        dispatch({ type:'GET_PASSWORD_CHECK_ERROR', error });\n      });\n  }\n}\nconst onLogout = () => {\n  authService.logout();\n  return({\n    type: 'LOGOUT',\n  });\n}\n\nconst checkLocalAuthState = () => {\n  return function(dispatch: Dispatch, getState: GetState){\n    if (authService.isAuthenticated) {\n      const user = authService.user;\n      const expiry = authService.tokenExpiry;\n      dispatch({\n        type: 'AUTH_SUCCESS',\n        role: authService.role,\n        expires: expiry\n      });\n      return dispatch({\n        type: 'GET_AUTH_USER_SUCCESS',\n        user\n      });\n    }\n    return;\n  }\n}\n\nexport default {\n  onRegister,\n  onLogin,\n  onLogout,\n  checkLocalAuthState,\n  authenticate,\n  checkPassword\n};\n","// @flow\nimport React, { Component } from 'react';\nimport type { Ref } from 'react';\nimport moment from 'moment';\nimport logo from '../media/ua-logo.png';\nimport {NavLink, Redirect} from 'react-router-dom';\nimport copy from '../copy';\nimport type { AuthState, AuthUserState, SettingsState } from '../types/store';\n\ntype Props = {\n  onLogout: () => void,\n  settings: SettingsState,\n  auth: AuthState,\n  authUser: AuthUserState,\n  setLanguage: (string) => void\n}\ntype State = {\n  isHamburgerActive: boolean,\n  redirect: ?string\n}\nclass Navbar extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      isHamburgerActive: false,\n      redirect: null\n    }\n  }\n\n  hamburgerRef: ?HTMLButtonElement;\n\n  toggleHamburger = () => {\n    this.setState({\n     isHamburgerActive: !this.state.isHamburgerActive\n    });\n  }\n  handleClick = (e: MouseEvent) => {\n    if (this.hamburgerRef && this.hamburgerRef.contains(e.target)) {\n      this.toggleHamburger();\n    } else {\n      this.setState({\n        isHamburgerActive: false\n      });\n    }\n  }\n  componentDidMount() {\n    document.addEventListener('mouseup', this.handleClick, false);\n  }\n  componentWillReceiveProps(nextProps: Props) {\n    if (nextProps.settings.languagePref != this.props.settings.languagePref) {\n      moment.locale(nextProps.settings.languagePref)\n    }\n  }\n  componentWillUnmount() {\n    document.removeEventListener('mouseup', this.handleClick, false);\n  }\n\n  handleLogout = () => {\n    this.setState({\n      redirect: \"/\",\n    });\n    this.props.onLogout();\n  }\n\n  render() {\n    const lang = this.props.settings.languagePref;\n    if (this.state.redirect) {\n      return <Redirect to={this.state.redirect}/>\n    }\n\n    else {\n      const isLoggedIn = this.props.auth.loggedIn;\n      const signInRoute=\"/login\";\n      const registerRoute=\"/register\"\n      const username = this.props.authUser.data && this.props.authUser.data.username\n      const uid = this.props.authUser.data && this.props.authUser.data.id\n\n    return(\n      <nav className=\"navbar is-transparent\" role=\"navigation\" aria-label=\"main navigation\">\n        <div className='container is-widescreen'>\n          <div className=\"navbar-brand\">\n            <a href='/' className='navbar-item'>\n              <img src={logo} style={{marginRight: '10px'}}/>\n              {copy['site-title'][lang]}\n            </a>\n\n            <button ref={node => this.hamburgerRef = node} className={this.state.isHamburgerActive?\"button navbar-burger is-active\":\"button navbar-burger\"} >\n              <span></span>\n              <span></span>\n              <span></span>\n            </button>\n          </div>\n\n          <div className={this.state.isHamburgerActive?'navbar-menu is-active':'navbar-menu'}>\n            {/* <div className='navbar-start'>\n              <NavLink className='navbar-item' to='/posts' activeClassName='is-active'>\n                <div className='navbar-content'>{copy['posts'][lang]}</div>\n              </NavLink>\n              <NavLink className='navbar-item' to='/artists' activeClassName='is-active'>\n                <div className='navbar-content'>{copy['artists'][lang]}</div>\n              </NavLink>\n            </div> */}\n\n            <div className='navbar-end'>\n              <div className='navbar-item'>{lang==\"en\" ? <a onClick={(e)=> {this.props.setLanguage(\"fr\")}}>Francais</a> : <a onClick={(e)=>{this.props.setLanguage(\"en\")}}>English</a>} </div>\n              {isLoggedIn==true ? (\n                <div className='navbar-item has-dropdown is-hoverable'>\n                  <NavLink className='navbar-link'to={`/users/${uid}`}>\n                    <span className=\"icon\" style={{ paddingRight: '8px' }}>\n                      <i className=\"fa fa-user\"/>\n                    </span>\n                    {username}\n                  </NavLink>\n                  <div className='navbar-dropdown is-boxed'>\n                    <NavLink className='navbar-item' to={`/users/${uid}`} activeClassName='is-active'>\n                      <div className='navbar-content'>\n                        {copy['profile'][lang]}\n                      </div>\n                    </NavLink>\n                    <a className='navbar-item' onClick={this.handleLogout}>\n                      <div className='navbar-content'><button className='button is-danger'>{copy['logout'][lang]}</button></div>\n                    </a>\n                  </div>\n                </div> ) : (\n\n                <div className=\"navbar-item\">\n                  <div className=\"field is-grouped\">\n                    <p className=\"control\">\n                      <a className=\"button is-info\" href='/register'>\n                        <span>{copy['register'][lang]}</span>\n                      </a>\n                    </p>\n                    <p className=\"control\">\n                      <a className={`button is-primary `} href='/login'>\n                        <span>{copy['sign-in'][lang]}</span>\n                      </a>\n                    </p>\n                  </div>\n                </div>\n              )}\n            </div>{/* end of \"navbar-end\" */}\n          </div>{/* end of \"navbar-menu\" */}\n        </div>\n      </nav>\n    )\n    }\n  }\n}\n\nexport default Navbar;\n\n","import C from '../constants';\nimport moment from 'moment';\nimport 'moment/min/locales'\n\nlet baseURL = C.SERVER_URL;\n\nconst initSettings = () => {\n  const savedLanguage = localStorage.getItem('languagePref');\n  const initLanguage = savedLanguage ? savedLanguage : \"en\";\n  return function(dispatch, getState) {\n    localStorage.setItem('languagePref', initLanguage||\"en\")\n    dispatch(setLanguage(initLanguage));\n  }\n}\nexport const setLanguage = (languagePref) => {\n  moment.locale(languagePref);\n  return function(dispatch, getState) {\n    localStorage.setItem('languagePref', languagePref)\n    dispatch({type: 'SET_LANGUAGE', languagePref: languagePref});\n  }\n}\nexport default {initSettings, setLanguage};\n\n\n\n\n\n\n\n","import React, { Component } from 'react';\nimport authActions from '../actions/auth';\nimport {connect} from 'react-redux';\nimport Navbar from '../components/Navbar';\nimport settingsActions from '../actions/settings';\nvar mapStateToProps = function(appState){\n  return {\n    auth: appState.auth,\n    authUser: appState.authUser,\n    settings: appState.settings\n  }\n}\n\nvar mapDispatchToProps = function(dispatch){\n  return {\n    onLogout: function(){ dispatch(authActions.onLogout()); },\n    checkLocalAuthState: function(){ dispatch(authActions.checkLocalAuthState()); },\n    setLanguage: function(lang){ dispatch(settingsActions.setLanguage(lang)) }\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Navbar);\n\n","// @flow\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport copy from '../copy';\nimport githubLogo from '../media/github-logo.png';\nimport type { SettingsState } from '../types/store';\nimport { Link } from 'react-router-dom';\nimport { setLanguage } from '../actions/settings';\n\ntype Props = {\n  settings: SettingsState,\n  setLanguage: (string) => void\n}\n\nclass Footer extends Component<Props> {\n  toggleLanguagePref = () => {\n    let nextLang = this.props.settings.languagePref == 'en' ? 'fr' : 'en';\n    this.props.setLanguage(nextLang);\n  }\n  render() {\n    const lang = this.props.settings.languagePref;\n    return(\n      <div className='footer' style={{ textAlign: 'center', display: 'flex', flexDirection: 'vertical', alignItems: 'center', alignContent: 'center', justifyContent: 'space-between' }}>\n          <div className='container is-centered'>\n            <div className='columns is-centered'>\n              <div className='column is-3 is-centered'>\n                <p>\n                  <Link\n                    to='/about'\n                  >{copy['about'][lang]}</Link>\n                </p>\n                <p>\n                  <Link\n                    to='/support'\n                  >{copy['support'][lang]}</Link>\n                </p>\n              </div>\n\n              <div className='column is-3 is-centered'>\n                <p>\n                  <Link\n                    to='/privacy-policy'\n                  >{copy['privacy_policy'][lang]}</Link>\n                </p>\n                <p>\n                  <Link\n                    to='/terms-of-service'\n                  >{copy['terms_of_service'][lang]}</Link>\n                </p>\n              </div>\n\n              <div className='column is-3 is-centered'>\n                <p>\n                  <a\n                    onClick={this.toggleLanguagePref}\n                    to='/terms-of-service'\n                  >{lang == 'en' ? 'Urban Applause en Francais' : 'Urban Applause in English'}</a>\n                </p>\n              </div>\n            </div>\n            <div style={{ textAlign: 'center', marginTop: '48px' }}>\n              <p className='is-centered' style={{ marginBottom: '12px' }}>\n              Urban Applause &copy;2019\n              </p>\n\n              <a target='_blank' className='social-link' href='https://github.com/flannerykj/urbanapplause-web' target='_blank'>\n                <span className='icon'>\n                  <img src={githubLogo} />\n                </span>\n              </a>\n            </div>\n        </div>\n      </div>\n    )\n  }\n}\nvar mapStateToProps = (appState) => {\n  return ({\n    settings: appState.settings\n  })\n}\nexport default connect(mapStateToProps, {\n  setLanguage\n})(Footer);\n","// @flow\nimport AWS from 'aws-sdk';\nimport C from '../constants';\nimport apiService from './api-service';\n\nconst spacesEndpoint = new AWS.Endpoint('nyc3.digitaloceanspaces.com');\nconst s3 = new AWS.S3({\n      endpoint: spacesEndpoint,\n      accessKeyId: C.AWS_ACCESS_KEY_ID,\n      secretAccessKey: C.AWS_SECRET_ACCESS_KEY\n});\nconst bucketName = C.AWS_BUCKET_NAME;\n\nclass ImageService {\n  get uploadsDir() {\n    return 'uploads'\n  }\n\n  upload(files: [File], postId: number): Promise<string> {\n    return apiService.upload(`/posts/${postId}/images`, files, 'images[]')\n  }\n\n  download(filename: string): Promise<Buffer> {\n    return new Promise((resolve, reject) => {\n      const Key = `${this.uploadsDir}/${filename}`;\n      const params = {\n        Bucket: bucketName,\n        Key\n      };\n      return s3.getObject(params, (err, data) => {\n        if (data) {\n          /* var arrayBufferView = new Uint8Array(data.Body);\n          var blob = new Blob( [ arrayBufferView ], { type: \"image/jpeg\" } );\n          var urlCreator = window.URL || window.webkitURL;\n          var imageUrl = urlCreator.createObjectURL( blob );\n          return resolve(imageUrl);\n        */\n          return resolve(data.Body);\n        }\n        if (err) {\n          console.log(err);\n        }\n        return reject(err);\n      });\n    });\n  }\n}\n\nexport default new ImageService();\n","// @flow\nimport React, { Component } from 'react';\nimport type { Ref, ElementType, ElementRef } from 'react';\nimport EXIF from 'exif-js';\n\ntype Props = {\n  src: string,\n  height: ?number,\n  fill: boolean\n}\n\ntype State = {\n}\n\n\n\nclass ExifOrientationImage extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n    }\n    this.canvasRef = React.createRef();\n  }\n  canvasRef: ElementRef<any>;\n\n  componentDidMount() {\n    this.updateImage(this.props);\n  }\n  componentDidUpdate(prevProps: Props, prevState: State) {\n    if (prevProps.src != this.props.src) {\n      this.updateImage(this.props);\n    }\n  }\n  getOrientationFromImageURL = (imageUrl: string): Promise<number> => {\n    return fetch(imageUrl).then((res) => {\n      return res.blob().then((blob) => {\n        return blob.arrayBuffer().then((arrayBuffer) => {\n            return this.getOrientation(arrayBuffer);\n          })\n        })\n    }).catch((err) => -1);\n  }\n  updateImage = (props: Props) => {\n    console.log('updating image');\n    var imageUrl = this.props.src;\n    const canvas = this.canvasRef.current;\n    var ctx = canvas.getContext(\"2d\");\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    if (!canvas) return;\n    var image = new Image(); // Using optional size for image\n    /*\n    const uint = props.src;\n    if (!canvas || !uint) return;\n    var arrayBufferView = new Uint8Array(this.props.src);\n    var blob = new Blob( [ arrayBufferView ], { type: \"image/jpeg\" } );\n    var urlCreator = window.URL || window.webkitURL;\n    var imageUrl = urlCreator.createObjectURL( blob );\n    var image = new Image(); // Using optional size for image\n    */\n    // Load an image of intrinsic size 300x227 in CSS pixels\n    this.getOrientationFromImageURL(imageUrl).then((exifOrientation) => {\n      console.log('exif orienation: ', exifOrientation);\n      image.onload = () => {\n        // Set variables\n        var height = image.height; // this.props.height ? this.props.height : image.height;\n        var width = image.width;// height * image.width / image.height;\n        // set proper canvas dimensions before transform & export\n        if ([5, 6, 7, 8].indexOf(exifOrientation) > -1) {\n            canvas.width = height;\n            canvas.height = width;\n        } else {\n            canvas.width = width;\n            canvas.height = height;\n        }\n        // transform context before drawing image\n        switch (exifOrientation) {\n            case 2:\n                ctx.transform(-1, 0, 0, 1, width, 0);\n                break;\n            case 3:\n                ctx.transform(-1, 0, 0, -1, width, height);\n                break;\n            case 4:\n                ctx.transform(1, 0, 0, -1, 0, height);\n                break;\n            case 5:\n                ctx.transform(0, 1, 1, 0, 0, 0);\n                break;\n            case 6:\n                ctx.transform(0, 1, -1, 0, height, 0);\n                break;\n            case 7:\n                ctx.transform(0, -1, -1, 0, height, width);\n                break;\n            case 8:\n                ctx.transform(0, -1, 1, 0, 0, width);\n                break;\n            default:\n                ctx.transform(1, 0, 0, 1, 0, 0);\n        }\n        if (this.props.fill) {\n          ctx.drawImage(image, (canvas.width - width)/2, (canvas.height - height)/2, width, height);\n        } else {\n          ctx.drawImage(image, 0, 0, width, height);\n        }\n      };\n      image.src = imageUrl;\n    })\n  }\n\n  getOrientation = (buffer: ArrayBuffer): number => {\n      var view = new DataView(buffer);\n      if (view.getUint16(0, false) != 0xFFD8) {\n          return -2;\n      }\n      var length = view.byteLength, offset = 2;\n      while (offset < length) {\n          if (view.getUint16(offset+2, false) <= 8) return -1;\n          var marker = view.getUint16(offset, false);\n          offset += 2;\n          if (marker == 0xFFE1) {\n              if (view.getUint32(offset += 2, false) != 0x45786966) {\n                  return -1;\n              }\n              var little = view.getUint16(offset += 6, false) == 0x4949;\n              offset += view.getUint32(offset + 4, little);\n              var tags = view.getUint16(offset, little);\n              offset += 2;\n              for (var i = 0; i < tags; i++) {\n                  if (view.getUint16(offset + (i * 12), little) == 0x0112) {\n                      return view.getUint16(offset + (i * 12) + 8, little);\n                  }\n              }\n          }\n          else if ((marker & 0xFF00) != 0xFF00) {\n              break;\n          }\n          else {\n              offset += view.getUint16(offset, false);\n          }\n      }\n    return -1\n  }\n  render() {\n    const canvasStyle = {\n      textAlign: 'center',\n      verticalAlign: 'middle'\n    }\n    if (this.props.height) {\n      canvasStyle.height = `${this.props.height}px`\n    } else {\n      canvasStyle.width = '100%';\n    }\n    return (\n      <div style={{ width: '100%', verticalAlign: 'middle' }}>\n        <canvas\n          style={canvasStyle}\n          ref={this.canvasRef}\n          id=\"imageCanvas\" />\n      </div>\n    )\n  }\n}\n\nexport default ExifOrientationImage;\n\nconst style = {\n\n}\n","// @flow\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport type { PostImage } from '../types/post';\nimport imageService from './../services/image-service';\nimport ExifOrientationImage from './ExifOrientationImage';\n\ntype Props = {\n  storageLocation: string,\n  imageCache: {[string]: string},\n  height: ?number\n}\n\ntype State = {\n  imageSrc: ?Uint8Array,\n  imageURL: ?string\n}\n\nclass CacheableImage extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      imageSrc: null,\n      imageURL: null\n    }\n  }\n  componentWillMount() {\n    const storage_location = this.props.storageLocation;\n    const cachedImageURL = this.props.imageCache[storage_location];\n    if (cachedImageURL) {\n      console.log('cached url: ', cachedImageURL);\n      this.setState({\n        imageURL: cachedImageURL\n      });\n      return\n    }\n\n    imageService.download(this.props.storageLocation)\n      .then((body) => {\n        var arrayBufferView = new Uint8Array(body);\n        var blob = new Blob( [ arrayBufferView ], { type: \"image/jpeg\" } );\n        var urlCreator = window.URL || window.webkitURL;\n        var imageURL = urlCreator.createObjectURL( blob );\n        this.setState({\n          imageSrc: body,\n          imageURL\n        });\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  }\n  render() {\n    if (this.state.imageURL) {\n      return <ExifOrientationImage\n        height={this.props.height}\n        fill\n        src={this.state.imageURL}\n      />\n    } else {\n      return <div />\n    }\n  }\n}\nvar mapStoreToState = ({ imageCache }) => ({\n  imageCache\n})\nexport default connect(mapStoreToState)(CacheableImage);\n","// @flow\nimport React, { Component } from 'react';\n\ntype Props = {\n  number: number,\n  iconName: ?string,\n  iconSrc: ?string,\n  iconClassName: string,\n  onClick: () => void,\n  iconWidth: number\n}\n\ntype State = {\n}\n\nclass IconAndText extends Component<Props> {\n  static defaultProps = {\n    iconName: null,\n    iconSrc: null,\n    iconWidth: 23,\n    iconClassName: ''\n  };\n  render() {\n    return (\n      <a\n        className='icon-and-text'\n        onClick={this.props.onClick}>\n        <div style={{ marginRight: '16px', display: 'flex', flexDirection: 'row' }}>\n          <div className='icon' style={{ marginRight: '5px' }} >\n            {this.props.iconName && <i className={`${this.props.iconName} ${this.props.iconClassName}`}/>}\n            {this.props.iconSrc &&\n            <img className={this.props.iconClassName} src={this.props.iconSrc} />\n  }\n          </div>\n          <div>{this.props.number}</div>\n        </div>\n      </a>\n    )\n  }\n}\n\nexport default IconAndText;\n","// @flow\nimport type { AuthRules } from './types/auth';\nimport type { Role } from './types/user';\n\nconst rules: AuthRules = {\n  contributor: {\n    static: [\n      \"post:read\",\n      \"profile:read\",\n      \"artist:read\",\n      \"artist:create\"\n    ],\n    dynamic: {\n      \"userEmail:read\": ({ authUserId, emailOwnerId }) => {\n        if (!authUserId || !emailOwnerId) return false;\n        return authUserId === emailOwnerId;\n      },\n      \"post:update\": ({ authUserId, postOwnerId }) => {\n        if (!authUserId || !postOwnerId) return false;\n        return authUserId === postOwnerId;\n      },\n      \"post:delete\": ({ authUserId, postOwnerId }) => {\n        if (!authUserId || !postOwnerId) return false;\n        return authUserId === postOwnerId;\n      },\n      \"profile:delete\": ({ authUserId, postOwnerId }) => {\n        if (!authUserId || !postOwnerId) return false;\n        return authUserId === postOwnerId;\n      },\n      \"profile:update\": ({ authUserId, profileOwnerId }) => {\n        if (!authUserId || !profileOwnerId) return false;\n        return authUserId === profileOwnerId;\n      },\n    }\n  },\n  admin: {\n    static: [],\n    dynamic: {}\n  },\n  artist: {\n    static: [],\n    dynamic: {}\n  },\n  anonymous: {\n    static: [\"welcomePage:read\", \"loginPage:read\"],\n    dynamic: {}\n  },\n};\n\nexport default rules;\n","// @flow\nimport rules from \"../rbac-rules\";\nimport type { User, Role } from '../types/user';\nimport type { AuthRules } from '../types/auth';\n\nconst check = (rules: AuthRules, role: ?Role, action: string, data: ?{string: any}) => {\n  if (!role) {\n    return false\n  }\n  const permissions = rules[role];\n  if (!permissions) {\n    // role is not present in the rules\n    return false;\n  }\n  const staticPermissions = permissions.static;\n\n  if (staticPermissions && staticPermissions.includes(action)) {\n    // static rule not provided for action\n    return true;\n  }\n\n  const dynamicPermissions = permissions.dynamic;\n\n  if (dynamicPermissions) {\n    const permissionCondition = dynamicPermissions[action];\n    if (!permissionCondition) {\n      // dynamic rule not provided for action\n      return false;\n    }\n    return permissionCondition(data);\n  }\n  return false;\n};\n\ntype Props = {\n  role: ?Role,\n  perform: string,\n  data: ?{[string]: any},\n  yes: () => any,\n  no: () => any,\n}\nconst Can = (props: Props) =>\n  check(rules, props.role, props.perform, props.data)\n    ? props.yes()\n    : props.no();\n\nCan.defaultProps = {\n  data: null,\n  yes: () => null,\n  no: () => null\n};\n\nexport default Can;\n","// @flow\n\nimport React, { Component } from 'react';\nimport CacheableImage from './PostImage';\nimport copy from '../copy';\nimport type { Post } from '../types/post';\nimport type { ContentReportReason } from '../types/content-report';\nimport apiService from '../services/api-service';\n\ntype Props = {\n  post: Post,\n  isActive: boolean,\n  onClose: () => void,\n  lang: string\n}\n\ntype State = {\n  didSubmit: boolean,\n  error: ?string,\n  submitting: boolean\n}\n\nclass ReportContentModal extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      didSubmit: false,\n      error: null,\n      submitting: false\n    }\n  }\n  onSelect = (reason: ContentReportReason) => {\n    console.log('selected: ', reason);\n    apiService.post(`/posts/${this.props.post.id}/flags`, { post_flag: {\n      user_reason: reason\n    }})\n      .then((res) => {\n        this.setState({\n          didSubmit: true,\n          submitting: false\n        });\n      })\n      .catch((err) => {\n        console.log(err);\n        this.setState({\n          submitting: false,\n          error: err\n        });\n      });\n  }\n  render() {\n    const { isActive, onClose, lang } = this.props;\n    const arrowCommonClass = 'fa fa-2x';\n    const reasons = ['suspiciousOrSpam', 'sensitivePhoto', 'abusiveOrHarmful', 'selfHarmOrSuicide'];\n    const promptTitle = copy.report_content_reason_prompt[lang];\n    const successTitle = copy.report_content_success[lang];\n    console.log('prompt: ', promptTitle);\n    return(\n      <div className={`modal ${isActive ? 'is-active' : ''}`}>\n        <div className=\"modal-background\"></div>\n        <div className=\"modal-card\">\n          <header className=\"modal-card-head\">\n            <p className=\"modal-card-title\">\n              {this.state.didSubmit ? successTitle : promptTitle}\n            </p>\n            <button onClick={onClose} className=\"delete\" aria-label=\"close\"></button>\n          </header>\n          {!this.state.didSubmit && <section className=\"modal-card-body\">\n            <ul className='list is-hoverable'>\n              {reasons.map((reason) =>\n                <ReasonButton reason={reason} lang={lang} onSelect={this.onSelect} />\n              )}\n            </ul>\n          </section>}\n          <footer className=\"modal-card-foot\">\n            <button className=\"button\" onClick={onClose}>{this.state.didSubmit ? copy.done[lang] : copy.cancel[lang]}</button>\n          </footer>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default ReportContentModal;\n\n\n// Button\ntype ReasonButtonProps = {\n  reason: ContentReportReason,\n  lang: string,\n  onSelect: (reason: ContentReportReason) => void\n}\nconst ReasonButton = (props: ReasonButtonProps) => {\n  const { lang, reason, onSelect } = props;\n  const reasonCopy = copy[`report_content_reason_${props.reason}`][props.lang]\n  return (\n    <a\n      className='list-item'\n      onClick={() => onSelect(reason)}\n    >\n      {reasonCopy}\n    </a>\n  )\n}\n","// @flow\nimport React, { Component } from 'react';\nimport Can from './Can';\nimport ReportContentModal from './ReportContentModal';\nimport type { User } from '../types/user';\nimport type { Post } from '../types/Post';\nimport type { AuthState } from '../types/store';\nimport copy from '../copy.json';\n\ntype Props = {\n  authUser: User,\n  auth: AuthState,\n  post: Post,\n  onDelete: () => void,\n  lang: string\n}\ntype State = {\n  isActive: boolean,\n  showReportModal: boolean\n}\n\nclass OptionsMenu extends Component<Props, State> {\n  constructor(props: Props){\n    super(props);\n    this.state = {\n      isActive: false,\n      showReportModal: false\n    }\n  }\n  toggleDropdown = () => {\n    this.setState({\n      isActive: !this.state.isActive\n    });\n  }\n  handleClickOutside = (e: Event) => {\n    if (!this.refs.dropdown.contains(e.target)) {\n      this.closeDropdown();\n    }\n  }\n  closeDropdown = () => {\n    this.setState({\n      isActive: false\n    });\n  }\n  componentDidMount() {\n    document.addEventListener('mousedown', this.handleClickOutside);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('mousedown', this.handleClickOutside);\n  }\n\n  onPressReportPost = () => {\n    this.setState({\n      showReportModal: true\n    });\n  }\n  onCloseReportModal = () => {\n    this.setState({\n      showReportModal: false\n    });\n  }\n  render() {\n    const { onDelete, authUser, auth, post, lang } = this.props;\n    return(\n      <div className='comment-options-menu' style={{width: '30px', float: 'right'}}>\n\n          <div className={`dropdown ${this.state.isActive==true ? 'is-active' : ''}`} ref=\"dropdown\" >\n            <div className=\"dropdown-trigger\">\n              <span className='icon' onClick={this.toggleDropdown}>\n                <i className=\"fa fa-ellipsis-v\"/>\n              </span>\n            </div>\n\n            <div className=\"dropdown-menu\" id=\"dropdown-menu\" role=\"menu\">\n              <div className=\"dropdown-content\" onClick={this.closeDropdown}>\n                <Can\n                  role={auth && auth.role}\n                  perform='post:delete'\n                  data={{\n                    authUserId: authUser && authUser.id,\n                    postOwnerId: post.UserId\n                  }}\n                  yes={() => (\n                    <a\n                      name='Delete'\n                      onClick={onDelete}\n                      className=\"dropdown-item\">\n                      {copy.delete[lang]}\n                    </a>\n                  )}\n                  no={() => (\n                    <a\n                      name='Flag'\n                      onClick={this.onPressReportPost}\n                      className=\"dropdown-item\">\n                      {copy.report_this_post[lang]}\n                    </a>\n                  )}\n                />\n              </div>\n            </div>\n\n          </div>\n          <ReportContentModal\n            post={post}\n            isActive={this.state.showReportModal}\n            onClose={this.onCloseReportModal}\n            lang={lang}\n          />\n        </div>\n    )\n  }\n}\n\nexport default OptionsMenu;\n","// @flow\n\nimport React, { Component } from 'react';\nimport CacheableImage from './PostImage';\nimport copy from '../copy';\n\ntype Props = {\n  imageStorageLocations: string[],\n  isActive: boolean,\n  onClose: () => void\n}\n\ntype State = {\n  index: number\n}\nclass ImageModal extends Component<Props, State> {\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      index: 0\n    }\n  }\n  componentDidMount() {\n    document.addEventListener(\"keydown\", this.handleKeyDown, false);\n  }\n  componentWillUnmount(){\n    document.removeEventListener(\"keydown\", this.handleKeyDown, false);\n  }\n\n  handleKeyDown = (event: KeyboardEvent) => {\n    if (event.keyCode === 37) {\n      // left (previous) arrow\n      this.showPrevious();\n    }\n    if (event.keyCode === 39) {\n      // right (next) arrow\n      this.showNext();\n    }\n  }\n  showNext = () => {\n    var nextIndex = this.state.index + 1;\n    if (nextIndex < this.props.imageStorageLocations.length) {\n      this.setState({\n        index: nextIndex\n      });\n    }\n  }\n\n  showPrevious = () => {\n    var nextIndex = this.state.index - 1;\n    if (nextIndex >= 0) {\n      this.setState({\n        index: nextIndex\n      });\n    }\n  }\n\n  render() {\n    const { isActive, imageStorageLocations, onClose } = this.props;\n    const arrowCommonClass = 'fa fa-2x'\n    return(\n      <div className={`modal ${isActive ? 'is-active' : ''}`}>\n        <div class=\"modal-background\"></div>\n\n        <h3 className='subtitle is-4 has-text-grey-lighter' style={{ marginTop: '24px', position: 'absolute', top: '0', textAlign: 'center' }}>{this.state.index + 1} of {imageStorageLocations.length} images</h3>\n        <div class=\"modal-content\" style={{ width: '100%', maxWidth: '1000px' }}>\n          <div className='image' style={{ display: 'flex', flexDirection: 'row', flexWrap: 'nowrap', justifyContent: 'space-between', alignItems: 'center' }}>\n            <a onClick={this.showPrevious}>\n              <span className={`icon is-large ${this.state.index > 0 ? 'has-text-grey-lighter' : 'has-text-grey'}`} >\n                <i className={`fa fa-arrow-left ${arrowCommonClass}`} />\n              </span>\n            </a>\n\n            <div className=\"image is-centered\" style={{ textAlign: 'center'}}>\n\n              <CacheableImage storageLocation={imageStorageLocations[this.state.index]} />\n            </div>\n\n            <a onClick={this.showNext}>\n              <span className={`icon is-large ${this.state.index < imageStorageLocations.length - 1 ? 'has-text-grey-lighter' : 'has-text-grey'}`} >\n              <i className={`fa fa-arrow-right ${arrowCommonClass}`} />\n              </span>\n            </a>\n          </div>\n        </div>\n        <button className=\"modal-close is-large\" onClick={onClose} aria-label=\"close\"></button>\n      </div>\n    )\n  }\n}\n\nexport default ImageModal;\n","// @flow\nimport React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport CacheableImage from '../../PostImage';\nimport {timeSince, formattedStringFromDate, getValidDate} from '../../../services/dateAndTime';\nimport IconAndText from '../../IconAndText';\nimport C from '../../../constants';\nimport copy from '../../../copy';\nimport moment from 'moment';\nimport OptionsMenu from '../../OptionsMenu';\nimport ImageModal from '../../ImageModal';\nimport applauseIcon from '../../../media/applaud.svg';\nimport imageService from '../../../services/image-service';\nimport type { Post } from '../../../types/post';\nimport type { User } from '../../../types/user';\nimport Can from '../../Can';\nimport type { AuthState } from '../../../types/store';\n\ntype Props = {\n  viewComments: (Post) => void,\n  authUser: User,\n  auth: AuthState,\n  post: Post,\n  lang: string,\n  onDelete: (number) => void,\n  // selectPost: (number) => void,\n  applaudPost: (number, number) => void,\n}\ntype State = {\n  isImageModalActive: boolean\n}\nclass PostListItem extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      isImageModalActive: false\n    }\n  }\n  handleDelete = () => {\n    this.props.onDelete(this.props.post.id);\n  }\n  componentWillReceiveProps(nextProps: Props){\n    // moment.locale(nextProps.lang);\n  }\n  handleApplaud = () => {\n    this.props.applaudPost(this.props.post.id, this.props.authUser && this.props.authUser.id);\n  }\n  /* selectPost = () => {\n    this.props.selectPost(this.props.post.id);\n  } */\n  showImageModal = () => {\n    this.setState({\n      isImageModalActive: true\n    });\n  }\n  hideImageModal = () => {\n    this.setState({\n      isImageModalActive: false\n    });\n  }\n  flagPost = () => {\n    // @TODO\n  }\n  render() {\n    const { post, lang, auth, authUser}  = this.props;\n    const cityCopy = post.Location ? copy['in-city'][lang].replace('$$', post.Location.city) : '';\n    const previewImage = post.PostImages.length ? post.PostImages[0] : null;\n    return(\n      <div className=\"card\">\n        <a onClick={this.showImageModal}>\n          <div className='card-image is-5by3 is-vertical-center'>\n            {previewImage && <CacheableImage\n              storageLocation={previewImage.storage_location}\n            />\n            }\n          </div>\n        </a>\n\n        <div className=\"card-content\">\n          <div className=\"media\">\n            <div className=\"media-content\">\n              <h3 className=\"title is-4\">\n                {post.Artists && post.Artists.length ? post.Artists.map((artist, i) => <Link to={`/artists/${artist.id}`}>{artist.signing_name} {i < post.Artists.count - 1 ? ', ' : ''}</Link>) : <span>{copy['unknown-artist'][lang]} </span>}\n                {cityCopy}\n              </h3>\n              <h5 className='subtitle is-5' style={{ verticalAlign: 'middle' }}>\n                {post.Location ? [post.Location.street_address, post.Location.city, post.Location.country, post.Location.postal_code].join(', ') : 'Unknown location'}\n              </h5>\n              <p>\n                {copy['posted-by'][lang]} <Link to={`/users/${post.User ? post.User.id : 0}`}>{post.User ? post.User.username : 'Unknown'} </Link>\n                {moment(new Date(post.createdAt)).calendar()}\n              </p>\n            </div> {/* end of media content */}\n\n            <div className='media-right'>\n              <OptionsMenu\n                lang={lang}\n                auth={auth}\n                authUser={authUser}\n                post={post}\n                onDelete={this.handleDelete}\n                onFlag={this.flagPost}\n              />\n            </div> {/* end of media right */}\n          </div> {/* end of media */}\n          <div className='content'>\n            <div style={{ marginTop: '24px', display: 'flex', flexDirection: 'row', alignItems: 'center', justifyContent: 'flex-start' }}>\n\n              <IconAndText\n                onClick={this.handleApplaud}\n                iconSrc={applauseIcon}\n                iconClassName='applause-icon'\n                number={post.Applause ? post.Applause.length : 0}\n              />\n              <IconAndText\n                onClick={() => { this.props.viewComments(post)}}\n                iconName='far fa-comment fa-lg'\n                number={post.Comments ? post.Comments.length : 0}\n              />\n            </div> { /* end of content */ }\n          </div>{ /* end of content */ }\n          </div> { /* end of card-content */ }\n\n          <ImageModal\n            isActive={this.state.isImageModalActive}\n            imageStorageLocations={post.PostImages.map((img) => img.storage_location)}\n            onClose={this.hideImageModal} />\n      </div>  // end of card\n    )\n  }\n}\n\nexport default PostListItem;\n","// @flow\nimport React, { Component } from 'react';\nimport type { NavigationProps } from '../../types/navigation';\nimport PostListItem from './PostListItem';\nimport copy from '../../copy';\nimport type { Post } from '../../types/post';\nimport type { AuthState, SettingsState, AuthUserState } from '../../types/store';\nimport apiService from '../../services/api-service';\n\nexport type PostQueryParams = {\n  auth: AuthState,\n  postId: ?number,\n  artistId: ?number,\n  userId: ?number,\n  search: ?string,\n  applaudedBy: ?number\n}\n\ntype Props = NavigationProps & {\n  authUser: AuthUserState,\n  settings: SettingsState,\n  query: PostQueryParams,\n  page: number\n}\n\ntype State = {\n  page: number,\n  loading: boolean,\n  posts: [],\n  error: ?string,\n  confirmDeletePost: ?number\n}\n\nclass PostList extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      page: 0,\n      loading: false,\n      error: null,\n      posts: [],\n      confirmDeletePost: null\n    }\n  }\n  get itemLimitPerPage(): number {\n    return 10\n  }\n  get canLoadMore(): boolean {\n    const wasLastPageFull = (this.state.posts.length % this.itemLimitPerPage == 0) && this.state.posts.length > 0;\n    return wasLastPageFull\n  }\n  componentDidMount() {\n    this.getPosts(this.props);\n  }\n  componentWillReceiveProps(nextProps: Props){\n    if (this.props.query !== nextProps.query) {\n      console.log('next query: ', nextProps.query);\n      this.getPosts(nextProps);\n    }\n  }\n  getPosts = (props: Props) => {\n    const query = {\n      ...props.query,\n      page: this.state.page,\n      limit: 10,\n      include: 'applause,comments'\n    };\n    this.setState({\n      error: null,\n      loading: true,\n      posts: this.state.posts && query.page > 0 ? this.state.posts : []\n    });\n    return apiService.get(\"/posts\", {}, query)\n      .then((json) => {\n        if (json.posts) {\n          console.log('json posts: ', json.posts);\n          console.log('state posts: ', this.state.posts);\n          this.setState({\n            loading: false,\n            posts: json.posts.concat(this.state.posts)\n          });\n        } else {\n          console.log(json);\n        }\n      })\n      .catch((error) => {\n        console.log(error);\n        this.setState({\n          posts: [],\n          loading: false,\n          error\n        });\n      });\n    }\n  loadMorePosts = () => {\n    this.setState({\n      page: this.state.page + 1\n    });\n    this.getPosts(this.props);\n  }\n  applaudPost = (PostId: number) => {\n      const UserId = this.props.authUser && this.props.authUser.data && this.props.authUser.data.id;\n      return apiService.post(`/applause`, {\n        applause: { UserId, PostId }\n      })\n        .then((json) => {\n          if(json.applause) {\n            const applause = json.applause;\n            var newItems = this.state.posts.map((item, i) => {\n              if (item.id === applause.PostId) {\n                const updatedApplause = item.Applause ? item.Applause : [];\n                updatedApplause.push(applause);\n                return Object.assign({}, item, {\n                  Applause: updatedApplause\n                })\n              }\n              return item;\n            });\n            this.setState({\n              posts: newItems,\n              loading: false\n            })\n          } else if (json.deleted) {\n            // remove applause\n            const applause = json.deleted;\n            var newItems = this.state.posts.map((item, i) => {\n              if (item.id === applause.PostId) {\n                const updatedApplause = item.Applause ? item.Applause : [];\n                const index = updatedApplause.indexOf(applause);\n                updatedApplause.splice(index, 1)\n                if (index > -1 ) {\n                  return Object.assign({}, item, {\n                    Applause: updatedApplause\n                  })\n                }\n              }\n              return item;\n            });\n            this.setState({\n              posts: newItems,\n              loading: false\n            });\n          } else {\n            console.log(json);\n          }\n        })\n        .catch((error) => {\n          this.setState({\n            loading: false,\n            error\n          });\n        })\n    }\n    selectPost = (postId: number) => {\n      this.props.history.push(`/posts/${postId}`)\n    }\n    deletePost = (postId: number) => {\n      this.setState({\n        confirmDeletePost: postId\n      });\n    }\n    onConfirmDeletePost = () => {\n      if (this.state.confirmDeletePost) {\n        return apiService.delete(\"/posts/\" + this.state.confirmDeletePost, {})\n          .then(data => {\n            const post = data.post;\n            if (post) {\n              var newItems = this.state.posts.filter((item, i) => {\n                return item.id !== post.id\n              })\n              this.setState({\n                posts: newItems,\n                loading: false,\n                confirmDeletePost: null\n              })\n            } else {\n              throw new Error()\n            }\n          })\n          .catch((error) => {\n            this.setState({\n              loading: false,\n              error\n            });\n          })\n      }\n    }\n    viewComments = (post: Post) => {\n      this.props.history.push(`/posts/${post.id}#comments`)\n    }\n    cancelDeletePost = () => {\n      this.setState({\n        confirmDeletePost: null\n      });\n    }\n  render() {\n    const lang = this.props.settings.languagePref;\n    if (this.state.loading && this.state.page == 0) {\n      return (<div className='postlist-container'>{copy['loading'][lang]}...</div>)\n    }\n    if (this.state.error) {\n      return (\n        <article className=\"message is-danger\">\n          <div className=\"message-body\">\n            {this.state.error}\n          </div>\n        </article>\n      );\n    }\n\n    let listItems = this.state.posts.map(post =>\n      <PostListItem\n        auth={this.props.auth}\n        selectPost={this.selectPost}\n        viewComments={this.viewComments}\n        applaudPost={this.applaudPost}\n        key={post.id}\n        post={post}\n        onSearchKeyChange={this.props.onSearchKeyChange}\n        onDelete={this.deletePost}\n        authUser={this.props.authUser && this.props.authUser.data}\n        settings={this.props.settings}\n        showSearchBar\n        showAddButton\n        lang={lang}\n      />\n    );\n    return (\n      <div>\n        {this.props.query.search && this.props.query.search.length ?\n          <p style={{ marginBottom: '24px' }}>\n            {copy[\"showing-results-for\"][lang]} <b><i>{this.props.query.search}</i></b>\n          </p>\n          : ''}\n        {!this.state.posts.length && (\n          <div className='container' style={{ textAlign: 'center' }}>{copy.no_post_results[lang]}</div>\n        )}\n        {listItems}\n        {this.canLoadMore &&\n          <div style={{ textAlign: 'center' }}>\n            <button className={`button ${this.props.loading ? 'is-loading' : ''}`} onClick={this.loadMorePosts}>{copy.load_more[lang]}</button>\n          </div>\n  }\n\n        <div className={`modal ${this.state.confirmDeletePost ? 'is-active' : ''}`}>\n          <div className=\"modal-background\"></div>\n          <div className=\"modal-card\">\n            <header className=\"modal-card-head\">\n              <p className=\"modal-card-title\">{copy['confirm-delete-post-title'][lang]}</p>\n              <button className=\"delete\" aria-label=\"close\" onClick={this.cancelDeletePost}></button>\n            </header>\n            <section className=\"modal-card-body\">\n              {copy['confirm-delete-post-body'][lang]}\n            </section>\n            <footer className=\"modal-card-foot\">\n              <button className=\"button\" onClick={this.cancelDeletePost}>{copy['cancel'][lang]}</button>\n              <button className=\"button is-danger\" onClick={this.onConfirmDeletePost}>{copy.delete[lang]}</button>\n            </footer>\n          </div>\n          <button className=\"modal-close is-large\" aria-label=\"close\" onClick={this.cancelDeletePost}></button>\n        </div>\n      </div>\n    );\n  }\n};\n\nexport default PostList;\n","import React from 'react';\n\nclass SearchBar extends React.Component {\n\n    searchKeyChangeHandler(event) {\n        let searchKey = event.target.value;\n        this.setState({searchKey: searchKey});\n        this.props.onChange(searchKey);\n    }\n\n  clearText = () => {\n        this.setState({searchKey: \"\"});\n        this.props.onChange(\"\");\n    }\n\n    render() {\n        return (\n          <div className=\"field \">\n            <div className='control is-expanded has-icons-left has-icons-right search-bar-field' >\n              <input\n                 className=\"input search-bar\"\n                 type=\"text\"\n                 placeholder={this.props.placeholder ||\"Enter a work description or artist name\"}\n                 value={this.props.searchKey}\n                 onChange={this.searchKeyChangeHandler.bind(this)}/>\n              <span className=\"icon is-small is-left\" >\n                <i className=\"fa fa-search\"/>\n              </span>\n              <span className=\"icon is-right clear\" onClick={this.clearText} >\n                <a className='delete' style={{cursor: 'pointer'}} onClick={this.clearText}  />\n              </span>\n            </div>\n          </div>\n        );\n    }\n};\n\nexport default SearchBar;\n\n","// @flow\nimport React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport { connect } from  'react-redux';\nimport PostList from '../components/PostList';\nimport SearchBar from '../components/SearchBar';\nimport RangeSlider from '../components/RangeSlider';\n// import PostsMapView from '../components/MapKitMap';\nimport copy from '../copy';\nimport type { AuthState, AuthUserState, SettingsState } from '../types/store';\n\ntype Props = {\n  auth: AuthState,\n  authUser: AuthUserState,\n  settings: SettingsState,\n  history: any\n}\ntype State = {\n  searchKey: string,\n  mapView: boolean\n}\nclass PostListPage extends Component<Props, State> {\n    constructor(props) {\n        super(props);\n        this.state = {\n          searchKey: '',\n          mapView: false\n        };\n    }\n    searchKeyChangeHandler(searchKey) {\n      this.setState({ searchKey: searchKey });\n    }\n\n    openMap = () => {\n      this.setState({\n        mapView: true\n      });\n    }\n    closeMap = () => {\n      this.setState({\n        mapView: false\n      });\n    }\n\n  render() {\n    const lang = this.props.settings.languagePref;\n    const auth = this.props.auth;\n    console.log('auth: ', auth);\n    return(\n      <div>\n        <section className=\"section\">\n          <div className='columns'>\n            <div className='column is-6'>\n              <SearchBar\n                searchKey={this.state.searchKey}\n                onChange={this.searchKeyChangeHandler.bind(this)}\n                placeholder={copy['search-for'][lang]}/>\n            </div>\n\n            {/* <div className='column'>\n              <div className='field has-addons is-expanded' style={{width: '100%'}}>\n                <span className='control' onClick={this.closeMap} style={{width: '50%'}}>\n                  <a\n                    className={`button is-primary ${(this.state.mapView==false)?\"is-active\":\"is-outlined\"}`}\n                    style={{ width: '100%'}}>\n                    <span className=\"icon is-small\">\n                      <i className=\"fa fa-list\"/>\n                    </span>\n                    <span>{copy['list'][lang]}</span>\n                  </a>\n                </span>\n                <span className='control' onClick={this.openMap} style={{height: '36px', width: '50%'}}>\n                  <a className={`button is-primary ${(this.state.mapView==true)?\"is-active\":\"is-outlined\"}`} style={{width: '100%'}}>\n                    <span className=\"icon is-small\">\n                      <i className=\"fa fa-map-marker\"/>\n                    </span>\n                    <span>{copy['map'][lang]}</span>\n                  </a>\n                </span>\n              </div>\n            </div> */}\n\n            <div className='column'>\n              <Link className='button is-primary is-expanded' style={{width: '100%'}} to=\"/posts/new\">+ {copy['add-new-post'][lang]}</Link>\n            </div>\n          </div>\n        </section>\n        <div className='is-centered' style={{  }}>\n          <PostList\n            lang={lang}\n            authUser={this.props.authUser}\n            auth={auth}\n            query={{\n              search: this.state.searchKey\n            }}\n            history={this.props.history}\n            settings={this.props.settings}\n          />\n\n          {/* this.state.mapView ?\n          <PostsMapView\n            lang={lang}\n            authUser={this.props.authUser}\n            query={{\n              search: this.state.searchKey\n            }}\n            history={this.props.history}\n            settings={this.props.settings}\n          /> :\n          <PostList\n            lang={lang}\n            authUser={this.props.authUser}\n            auth={this.props.auth}\n            query={{\n              search: this.state.searchKey\n            }}\n            history={this.props.history}\n            settings={this.props.settings}\n          />*/}\n        </div>\n      </div>\n    )\n  }\n}\n\n\nvar mapStateToProps = function(appState){\n  return {\n    auth: appState.auth,\n    authUser: appState.authUser,\n    settings: appState.settings\n  }\n}\nvar mapDispatchToProps = function(dispatch){\n  return {\n  }\n}\nexport default connect(mapStateToProps, mapDispatchToProps)(PostListPage);\n","import React, { Component } from 'react';\n\nclass PostPreview extends Component {\n  render() {\n    return(\n      <div>\n        <h1>New Section</h1>\n      </div>\n    )\n  }\n}\n\nexport default PostPreview;\n","import React, { Component } from 'react';\n\nclass PostPreview extends Component {\n  render() {\n    return(\n      <div>\n        <h1>New Section</h1>\n      </div>\n    )\n  }\n}\n\nexport default PostPreview;\n","import React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\n\nclass UserLink extends Component {\n  render() {\n    const {user_id, username} = this.props;\n    return(\n      <div className='user-link' >\n        <span className=\"icon\">\n          <i className=\"fa fa-user\"/>\n        </span>\n        <Link to={`/users/${user_id}`}>{username}</Link>\n      </div>\n    )\n  }\n}\n\nexport default UserLink;\n","import React, { Component } from 'react';\nimport moment from 'moment';\n// import 'moment/locale/fr';\nimport UserLink from '../../UserLink';\nimport OptionsMenu from '../../OptionsMenu';\nclass EditableComment extends Component {\n  constructor(props){\n    super(props);\n    this.state = {\n      isEditing: false,\n      editedText: null\n    }\n  }\n  componentWillReceiveProps(nextProps){\n    this.setState({\n      editedText: this.props.comment.text\n    });\n    // moment.locale(nextProps.lang);\n  }\n  startEdit = () => {\n    this.setState({\n      isEditing: true,\n      editedText: this.props.comment.content\n    });\n  }\n  cancelEdit = () => {\n    this.setState({\n      isEditing: false,\n      editedText: this.props.comment.text\n    });\n  }\n  saveEdit = () => {\n    this.setState({\n      isEditing: false\n    });\n    this.props.submitEdit(this.state.editedText);\n  }\n  onChangeText = (e) => {\n    this.setState({\n      editedText: e.target.value\n    });\n  }\n  handleDelete = () => {\n    var comment = this.props.comment;\n    this.props.onDelete(comment.id, comment.work_id);\n  }\n  render() {\n    const {comment, auth, authUser } = this.props;\n    console.log('up comment: ', comment);\n    // moment().locale(this.props.lang);\n    var date = moment(new Date(comment.createdAt)).calendar()\n    if (this.state.isEditing == true) {\n      return (\n        <div>\n          <input type='text' value={this.state.editedText} onChange={this.onChangeText} className='input'/>\n          <button className='button' onClick={this.saveEdit}>{this.props.saveEditCopy}</button>\n          <button className='button' onClick={this.cancelEdit}>{this.props.cancelEditCopy}</button>\n        </div>)\n    } else {\n    return(\n      <div>\n        <div className='columns'>\n          <div className='column is-narrow'>\n          <UserLink user_id={comment.UserId} username={comment.User && comment.User.username} />\n          <small> {date}</small>:\n          <div>{comment.content}</div>\n          </div>\n          { authUser && (authUser.id == comment.UserId) ?  (\n              <div className='column ' style={{float: 'right'}}>\n                <OptionsMenu\n                  onEdit={this.startEdit}\n                  onDelete={this.handleDelete}\n                />\n              </div>\n            ) : ''}\n        </div>\n      </div>\n    )\n    }\n  }\n}\n\nexport default EditableComment;\n","// @flow\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport EditableComment from './EditableComment';\nimport copy from '../../copy';\nimport apiService from '../../services/api-service';\nimport C from '../../constants';\nimport type { Post } from '../../types/post';\nimport type { Comment } from '../../types/comment';\nimport type { User } from '../../types/user';\n\ntype Props = {\n  post: Post,\n  history: any,\n  authUser: { data: ?User },\n  auth: { loggedIn: boolean },\n  lang: string,\n  query: {\n    postId: number,\n  },\n}\ntype State = {\n  newCommentText: ?string,\n  showAllComments: boolean,\n  loading: boolean,\n  comments: Comment[],\n  error: ?string,\n  authModalActive: boolean\n}\nclass CommentList extends Component<Props, State> {\n  constructor(props){\n    super(props);\n    this.state = {\n      newCommentText: '',\n      showAllComments: false,\n      loading: false,\n      error: null,\n      comments: [],\n      authModalActive: false\n    }\n  }\n  componentWillMount() {\n    this.getComments(this.props);\n  }\n  componentWillReceiveProps(nextProps: Props) {\n    if (this.props.post !== nextProps.post) {\n      this.getComments(nextProps);\n    }\n  }\n  updateNewCommentText = (e) => {\n    this.setState({\n      newCommentText: e.target.value\n    });\n  }\n  onEnterSubmit = (e) => {\n    if (e.keyCode ==13){\n      this.submitComment();\n    }\n  }\n  getComments = (props: Props) => {\n    this.setState({ loading: true });\n    return apiService.get(`/posts/${props.post.id}/comments`, {})\n      .then((json) => {\n      if (json.comments) {\n        this.setState({\n          loading: false,\n          comments: json.comments\n        });\n      } else {\n        console.log(json);\n      }\n    })\n    .catch((error) => {\n      console.log(error);\n      this.setState({\n        comments: [],\n        loading: false,\n        error\n      });\n    });\n  }\n  submitComment = () => {\n    const content = this.state.newCommentText;\n    const UserId = this.props.authUser.data && this.props.authUser.data.id;\n    if (!UserId) {\n      this.setState({\n        authModalActive: true\n      });\n      console.log('not logged in : ', this.props.auth, this.props.authUser.data);\n      return\n    }\n    if (!this.props.query.postId) {\n      console.log('no post id');\n      return\n    }\n    return apiService.post(`/posts/${this.props.post.id}/comments`, {\n      comment: { UserId, content }\n    })\n      .then((json: { comment: Comment }) => {\n        if(json.comment) {\n          var newComment = Object.assign({}, json.comment, { Post: this.props.post, user: this.props.authUser.data });\n          this.setState({\n            newCommentText: '',\n            comments: this.state.comments.concat([newComment]),\n            loading: false\n          })\n        } else {\n          console.log(json);\n        }\n      })\n      .catch((error) => {\n        this.setState({\n          loading: false,\n          error\n        });\n      })\n    }\n    editComment = (commentId: number, content: string) => {\n      return apiService.put(\"/comments/\" + commentId, { comment: { content }})\n        .then(data => {\n          if (data.comment) {\n            var newItems = this.state.comments.map((item, i) => {\n              if (item.id === data.comment.id) {\n                return data.comment\n              } else {\n                return item\n              }\n            })\n            this.setState({\n              comments: newItems,\n              loading: false\n            })\n          }\n        })\n        .catch((error: string) => {\n          this.setState({\n            loading: false,\n            error\n          });\n        })\n    }\n    deleteComment = (commentId: number) => {\n      return apiService.delete(\"/comments/\" + commentId, {})\n        .then(data => {\n          if (data.comment) {\n            var newItems = this.state.comments.filter((item, i) => {\n              return item.id !== data.comment.id\n            })\n            this.setState({\n              comments: newItems,\n              loading: false\n            })\n          }\n        })\n        .catch((error) => {\n          this.setState({\n            loading: false,\n            error\n          });\n        })\n    }\n  toggleShowAllComments = () => {\n    this.setState({\n      showAllComments: !this.state.showAllComments\n    });\n  }\n\n  render() {\n    const comments = this.state.comments;\n    const lang = this.props.lang;\n\n    const newCommentForm = (\n      <div style={{paddingTop: '20px'}} className='field has-addons'>\n        <div className='control is-expanded'>\n          <input\n            type='text'\n            value={this.state.newCommentText}\n            onChange={this.updateNewCommentText}\n            className='input' placeholder={copy['comment-cta'][lang]}\n            onKeyUp={this.onEnterSubmit}\n          />\n        </div>\n        <div className='control'>\n          <button className='button' onClick={this.submitComment}>{copy['submit-new'][lang]}</button>\n        </div>\n      </div>);\n\n    console.log('comments from list: ', comments);\n    var maxComments = this.state.showAllComments ? comments.length : 3;\n    const visibleComments = comments.slice(0, maxComments);\n    if (visibleComments) {\n      var commentCountText = function(){\n        switch(visibleComments.length){\n          case 0:\n            return copy['no-comments'][lang];\n          case 1:\n            return `1 ${copy['comment'][lang]}`\n          default:\n            return `${visibleComments.length} ${copy['comments'][lang]}`\n        }\n      }\n\n      return(\n          <div>\n            {visibleComments.map((comment, i) => {\n              return (\n                <EditableComment\n                  lang={lang}\n                  comment={comment}\n                  key={i}\n                  onDelete={this.deleteComment}\n                  submitEdit={(editedContent: string) => this.editComment(comment, editedContent)}\n                  deleteCopy={copy['delete'][lang]}\n                  saveEditCopy={copy['save-changes'][lang]}\n                  cancelEditCopy={copy['cancel'][lang]}\n                  auth={this.props.auth}\n                  authUser={this.props.authUser}\n                />\n              )\n            })}\n            {visibleComments.length < comments.length ?\n              <small><Link onClick={this.toggleShowAllComments}>Show all {comments.length} comments </Link></small> :\n              <span>{visibleComments.length > 3 ? <small><a onClick={this.toggleShowAllComments}>Show fewer comments</a></small> : ''}</span>\n            }\n            {this.props.auth.loggedIn ? newCommentForm : (\n              <div>\n                <Link to='/login'>{copy['sign-in'][lang]}</Link> {copy['or'][lang]} <Link href='/register'>{copy['register'][lang]}</Link> {copy['to-comment'][lang]}\n              </div>)}\n          </div>\n        )\n    } else {\n      return(\n        <div>\n          {copy['loading'][lang]}\n        </div>\n      )\n    }\n  }\n}\n\nvar mapStateToProps = function(appState){\n  return {\n    authUser: appState.authUser,\n    auth: appState.auth,\n    settings: appState.settings\n  }\n}\nexport default connect(mapStateToProps, {})(CommentList);\n","// @flow\n\nimport React, { Component } from 'react';\nimport copy from '../copy';\n\ntype Props = {\n  label: ?string,\n  children: ?any,\n  value: ?string,\n  emptyText: string\n}\nclass InfoField extends Component<Props> {\n  static defaultProps = {\n    value: null,\n    emptyText: '',\n    children: null\n  }\n  render() {\n    const { label, value, children, emptyText }  = this.props;\n    return(\n      <div>\n        {label && <label className='label'>{label}</label>}\n        {value && <p>{value}</p>}\n        {children && <p>{children}</p>}\n        {!children && !value &&<p> <i>{emptyText}</i></p>}\n        <br />\n      </div>\n      )\n  }\n}\n\nexport default InfoField;\n\n","// @flow\nimport React, { Component } from 'react';\nimport moment from 'moment';\nimport { Link } from 'react-router-dom';\nimport type { NavigationProps } from '../types/navigation';\nimport type { Post } from '../types/post';\nimport copy from '../copy';\nimport withPostProps from '../hoc/withPostProps';\nimport InfoField from './InfoField'\nimport ImageModal from './ImageModal';\nimport imageService from '../services/image-service';\nimport CacheableImage from './PostImage';\n\nimport C from '../constants';\n\ntype Props = NavigationProps & {\n  post: Post,\n  lang: string\n}\n\ntype State = {\n  galleryModalActive: boolean\n}\nclass PostDetail extends Component<Props, State> {\n    constructor(props: Props) {\n    super(props);\n    this.state = {\n      galleryModalActive: false\n    }\n  }\n  showModal = () => {\n    this.setState({\n      galleryModalActive: true\n    });\n  }\n  hideModal = () => {\n    this.setState({\n      galleryModalActive: false\n    });\n  }\n  render() {\n    const lang = this.props.lang;\n    const post = this.props.post;\n    const previewImage = post && post.PostImages[0];\n    return (\n      <div className=\"container\">\n        {previewImage && <ImageModal\n          isActive={this.state.galleryModalActive}\n          imageStorageLocations={[previewImage.storage_location]}\n          onClose={this.hideModal} />}\n        <div style={{ height: '300px', marginBottom: '24px' }}>\n          {previewImage &&\n            <a onClick={this.showModal}>\n              <CacheableImage\n                storageLocation={previewImage.storage_location}\n                height={300}\n              />\n          </a>}\n        </div>\n        <InfoField\n          label={copy['art-by'][lang]}\n          emptyText={copy['unknown-artist'][lang]}\n        >\n          {post.Artists && post.Artists.length ? post.Artists.map((artist, i) => <Link to={`/artists/${artist.id}`}>{artist.signing_name} {i < post.Artists.count - 1 ? ', ' : ''}</Link>) : <span>{copy['unknown-artist'][lang]} </span>}\n        </InfoField>\n\n        <InfoField\n          label={copy['published-by'][lang]}\n          emptyText='Unknown'\n        >\n          {post.User && <a href={`/users/${post.User.id}`}>{post.User.username}</a>}\n        </InfoField>\n\n        <InfoField\n          label='Posted on'\n        >{moment(new Date(post.createdAt)).calendar()}\n          </InfoField>\n\n        <InfoField\n          label='Description'\n        >\n          {post.description}\n        </InfoField>\n      </div>\n    );\n  }\n};\n\nexport default PostDetail;\n","// @flow\n\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport moment from 'moment';\nimport PostEditForm from '../components/PostEditForm';\nimport apiService from '../services/api-service';\nimport copy from '../copy';\n// import 'moment/locale/fr';\nimport C from '../constants';\nimport CommentList from '../components/CommentList';\nimport type { Post } from '../types/post';\nimport PostDetailInfo from '../components/PostDetailInfo'\nimport type { User } from '../types/user';\nimport type { SettingsState } from '../types/store';\n\ntype State = {\n  isEditing: boolean,\n  loading: boolean,\n  post: ?Post,\n  error: ?string\n}\n\ntype Props = {\n  history: {},\n  match: {\n    params: {\n      id: number\n    }\n  },\n  authUser: {\n    data: ?User\n  },\n  auth: { loggedIn: boolean },\n  post: Post,\n  onUpdate: (number, Post) => void,\n  settings: SettingsState\n}\n\nclass PostDetailPage extends Component<Props, State> {\n  constructor(props: Props){\n    super(props);\n    this.state = {\n      post: null,\n      isEditing: false,\n      loading: false,\n      error: null\n    }\n  }\n  componentWillMount(){\n    this.getPost(this.props.match.params.id);\n  }\n  componentWillReceiveProps(nextProps: Props){\n    if (this.props.match.params.id !== nextProps.match.params.id) {\n      this.getPost(nextProps.match.params.id);\n    }\n  }\n  closeForm = () => {\n    this.setState({\n      isEditing: false\n    });\n  }\n  openForm = () => {\n    this.setState({\n      isEditing: true\n    });\n  }\n  handleUpdate = (id: number, content: Post) => {\n    this.props.onUpdate(id, content);\n  }\n  getPost = (postId: number) => {\n    this.setState({ loading: true });\n    return apiService.get(`/posts/${postId}`, {}, {})\n      .then((json) => {\n        console.log(json);\n        if (json.post) {\n          this.setState({\n            loading: false,\n            post: json.post\n          });\n        } else {\n          console.log(json);\n        }\n      })\n      .catch((error) => {\n        console.log(error);\n        this.setState({\n          post: null,\n          loading: false,\n          error\n        });\n      });\n  }\n  render() {\n    const lang = this.props.settings.languagePref;\n    if (this.state.loading) {\n      return (<div className='postlist-container'>{copy['loading'][lang]}...</div>)\n    }\n    if (this.state.isEditing) {\n      return (\n        <div>\n          <PostEditForm post={this.props.post.data} onSubmit={this.handleUpdate} onCancel={this.closeForm} />\n        </div>\n      );\n    }\n    if (this.state.error) {\n      return (\n        <article className=\"message is-danger\">\n          <div className=\"message-body\">\n            {this.state.error}\n          </div>\n        </article>\n      );\n    }\n    if (!this.state.post) {\n      return <div className='container' style={{ textAlign: 'center' }}>{copy.no_post_results[lang]}</div>\n    }\n    return (\n      <div>\n      <PostDetailInfo\n        post={this.state.post}\n        lang={this.props.settings.languagePref}\n      />\n      <hr/>\n\n       <h3 className='title is-6' id='comments' name='comments' ref='comments'>\n         {copy.comments[lang]}\n       </h3>\n\n       <CommentList\n         post={this.state.post}\n         lang={lang}\n         auth={this.props.auth}\n         authUser={this.props.authUser}\n         history={this.props.history}\n         query={{ postId: this.state.post.id }}\n       />\n     </div>\n    )\n  }\n}\n\nvar mapStateToProps = function(appState){\n  return {\n    auth: appState.auth,\n    authUser: appState.authUser,\n    settings: appState.settings\n  }\n}\nvar mapDispatchToProps = function(dispatch){\n  return {\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PostDetailPage);\n","// @flow\n\nimport React, { Component } from 'react';\nimport copy from '../copy';\nimport ExifOrientationImage from './ExifOrientationImage';\n\ntype Props = {\n  removeImage: () => void,\n  lang: string,\n  imageSource: string,\n  index: number,\n  containerStyle: any\n}\n\ntype State = {\n  isFocused: boolean\n}\nclass SelectedImage extends Component<Props, State> {\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      isFocused: false\n    }\n  }\n\n  handleFocus = () => {\n    if (this.props.removeImage) {\n      this.setState({\n        isFocused: true\n      })\n    }\n  }\n  handleBlur = () => {\n    this.setState({\n      isFocused: false\n    })\n  }\n  render() {\n    console.log('rendering');\n    const { lang, imageSource, index } = this.props;\n\n    const focusStyle = this.state.isFocused ? {\n      backgroundColor: 'black',\n    } : {\n\n    }\n    return(\n      <div\n        key={index}\n        style={{...{\n        overflow: 'hidden',\n          marginRight: '8px',\n          marginBottom: '8px',\n          display: 'inline-block',\n          position: 'relative',\n          textAlign: 'center',\n          verticalAlign: 'middle',\n        }, ...focusStyle, ...this.props.containerStyle}}\n        onMouseOver={this.handleFocus}\n        onMouseOut={this.handleBlur}\n      >\n        <div\n          onClick={this.props.removeImage}\n          style={{\n            verticalAlign: 'middle',\n            color: 'white',\n            position: 'absolute',\n            left: '0',\n            right: '0',\n            marginTop: '35px',\n            zIndex: '101',\n            display: this.state.isFocused ? 'inline-block' : 'none'\n          }}\n        ><a style={{color: 'white' }}>\n          <span className='icon has-text' >\n            <i name='fa fa-trash' color='white'/>\n            Remove\n          </span>\n        </a>\n        </div>\n        <div\n          style={{\n            zIndex: '100',\n            backgroundColor: 'black',\n            opacity: '0.5',\n            width: '100%',\n            height: '100%',\n            position: 'absolute',\n            left: '0',\n            display: this.state.isFocused ? 'inline' : 'none',\n          }}\n        />\n        <div\n          style={{\n            objectFit: 'cover',\n            width: '100%',\n            height: '100%',\n            zIndex: '99',\n            }}\n          >\n          <ExifOrientationImage\n            fill={false}\n            height={null}\n            src={imageSource}\n          />\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default SelectedImage;\n","// @flow\nimport React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\n\nexport type SelectionMode = 'unknown' | 'select' | 'create';\n\ntype SearchableOption = {\n  name: string,\n  id: number\n}\n\ntype Props = {\n  createNewText: string,\n  placeholder: ?string,\n  selectedOption: ?SearchableOption,\n  options: SearchableOption[],\n  onChangeQuery: (string) => void,\n  onSelectCreateNew: () => void\n}\n\ntype State = {\n  query: string,\n  highlightedOptionIndex: number,\n  isCreatingNew: boolean\n}\nclass SelectInput extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      query: '',\n      highlightedOptionIndex: 0,\n      matchList: [],\n      isCreatingNew: false\n    }\n  }\n  activeElement: any\n\n  shouldShowMatches = () => {\n    if (\n      this.state.query.length>0 &&\n      !this.state.isCreatingNew &&\n      this.activeElement==this.refs.input_box.focused\n    ) {\n      return true\n    } else {\n      return false;\n    }\n  }\n  onInputChange = (e) => {\n    this.props.onChangeQuery(e.target.value);\n    this.setState({\n      query: e.target.value\n    });\n  }\n\n  setCreatingNew = () => {\n    this.refs.input_box.focus();\n    this.props.onChangeSelectionMode('create');\n    this.setState({\n      isCreatingNew: true\n    });\n  }\n\n  onKeyDown = (e) => {\n    const { options } = this.props;\n    const { highlightedOptionIndex } = this.state;\n    if (e.keyCode == 13) {\n      e.preventDefault();\n      if(highlightedOptionIndex == options.length) {\n        this.setCreatingNew();\n      } else {\n        this.onSelectOption(options[highlightedOptionIndex], highlightedOptionIndex);\n      }\n    }\n    if (e.keyCode == 40) { //down key pressed\n      console.log('down key pressed ', highlightedOptionIndex);\n      if(highlightedOptionIndex < this.props.options.length) {\n        this.setState({\n          highlightedOptionIndex: this.state.highlightedOptionIndex + 1});\n      }\n    }\n    if (e.keyCode == 38) {\n      if (highlightedOptionIndex > 0) {\n        this.setState({\n          highlightedOptionIndex: highlightedOptionIndex- 1\n        })\n      }\n    }\n  }\n  onSelectOption = (option: SearchableOption, index: number) => {\n    this.props.onSelectOption(option);\n  }\n\n  render() {\n    const options = this.props.options;\n    const showMatches = this.shouldShowMatches();\n    return(\n       <div className={showMatches==true?\"dropdown is-active select-input\":\"dropdown select-input\"} style={{width: '100%'}}>\n          <div className='control' style={{width: '100%'}}>\n            <div className=\"dropdown-trigger select-input\">\n              <input\n                  className={`input`}\n                  type='text'\n                  ref='input_box'\n                  value={this.state.query}\n                  onChange={this.onInputChange}\n                  onKeyDown={this.onKeyDown}\n                  placeholder={this.props.placeholder}\n                />\n              </div>\n            </div>\n            <div className='dropdown-menu'>\n              <div className='dropdown-content'>\n                {options.map((option, index) =>\n                  <Link\n                    key={index}\n                    className={(this.state.highlightedOptionIndex==index)?'dropdown-item is-active':'dropdown-item'}\n                    onClick={(e) => this.onSelectOption(option, index)}>\n                      {options[index].name}\n                  </Link>\n                )}\n                <hr className=\"dropdown-divider\"/>\n\n                <a className={(this.state.highlightedOptionIndex === options.length)?'dropdown-item is-active':'dropdown-item'} onClick={this.props.onSelectCreateNew}>\n                  {this.props.createNewText}\n                </a>\n              </div>\n            </div>\n        </div>\n    )\n  }\n}\n\nexport default SelectInput;\n","import React, { Component } from 'react';\n\nclass InputStatusTag extends Component {\n  render() {\n\n    if (this.props.status=='complete'){\n      return(\n        <span className='tag is-success'>\n          {this.props.successText}\n          <span className='delete' onClick={this.props.onClear}></span>\n        </span>\n      )\n    } else if (this.props.status=='uploading'){\n      return (\n\n        <span className='tag is-warning'>\n          Loading {this.props.successText}<a className=\"is-loading\"></a>\n        </span>\n              )\n    } else if (this.props.status==null) {\n      return (\n        <span className='tag is-danger'>\n          {this.props.dangerText || 'None selected'}\n        </span>\n\n      )\n    } else {\n      return (<span></span>)\n    }\n  }\n}\n\nexport default InputStatusTag;\n","// @flow\nimport React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport SelectInput from './SelectInput';\nimport InputStatusTag from './InputStatusTag';\nimport copy from '../copy';\nimport apiService from '../services/api-service';\nimport type { Artist } from '../types/artist';\nimport type { SelectionMode } from './SelectInput';\n\ntype Props = {\n  lang: string,\n  onChange: (string, ?any) => void,\n  artistInputType: SelectionMode,\n  artistName: ?string,\n  artistId: ?number,\n}\n\ntype State = {\n  artistMatches: Artist[],\n  error: ?string,\n  loading: boolean\n}\nclass ChooseArtist extends Component<Props, State> {\n  constructor(props: Props){\n    super(props);\n\n    this.state = {\n      artistMatches: [],\n      loading: false,\n      error: null\n    }\n  }\n  setUnknown = () => {\n    this.props.onChange('artistInputType', 'unknown');\n  }\n  onCreateArtist = (item: { name: string, id: number }) => {\n    this.props.onChange('artistInputType', 'create');\n    this.props.onChange('ArtistId', item.id);\n    this.props.onChange('artist_signing_name', item.name);\n  }\n  clearInput = () => {\n    this.props.onChange('artistInputType', 'select');\n    this.props.onChange('artist_signing_name', '');\n    this.props.onChange('ArtistId', null);\n  }\n  onSelectArtist = (item: { name: string, id: number }) => {\n    this.props.onChange('artistInputType', 'select');\n    this.props.onChange('ArtistId', item.id);\n    this.props.onChange('artist_signing_name', item.name);\n  }\n  getArtistMatches = (query: string) => {\n    this.setState({\n      loading: true\n    });\n    apiService.get('/artists?search=' + query)\n      .then((res) => {\n        this.setState({\n          artistMatches: res.artists,\n          loading: false\n        });\n      })\n      .catch((error) => {\n        this.setState({\n          error: error\n        });\n      });\n  }\n  changeSelectionMode = (mode: SelectionMode) => {\n    this.props.onChange('artistInputType', mode);\n  }\n  render() {\n    const lang = this.props.lang;\n    const artistName = this.props.artistName;\n    console.log('artistName: ', artistName);\n    console.log('inputType: ', this.props.artistInputType);\n    var successText = '';\n    switch (this.props.artistInputType) {\n      case 'create':\n        successText = copy['artist-input-type-new'][lang];\n        break;\n      case 'unknown':\n        successText = copy['artist-input-type-unknown'][lang];\n        break;\n      case 'select':\n        successText = artistName;\n        break;\n    }\n    const selectedOption = (this.props.artistName && this.props.artistId) ? {\n      name: this.props.artistName,\n      id: this.props.artistId\n    } : null;\n\n    return(\n      <div className='form-section'>\n         <div className='field is-grouped'>\n          <label className='label' style={{marginRight: '8px' }}>{copy['artist'][lang]}:</label>\n          <InputStatusTag\n            successText={successText}\n            dangerText={copy['none-selected'][lang]}\n            onClear={this.clearInput}\n            status={this.props.artistId||this.props.artistInputType!='select'?'complete':null} />\n          </div>\n\n          {this.props.artistInputType === 'select' && !this.props.artistId && (\n          <SelectInput\n            createNewText={copy['create-new'][this.props.lang]}\n            options={this.state.artistMatches.map((match) => ({ name: match.signing_name, id: match.id }))}\n            selectedOption={selectedOption}\n            onSelectOption={this.onSelectArtist}\n            placeholder={copy['search-for-artist'][lang]}\n            onChangeQuery={this.getArtistMatches}\n            onSelectCreateNew={() => this.changeSelectionMode('create')}\n          />)}\n          {this.props.artistInputType == 'create' && (\n            <div className='control' style={{width: '100%'}}>\n              <input\n                className={`input`}\n                type='text'\n                ref='input_box'\n                value={this.props.artistName}\n                onChange={(e) => this.props.onChange('artist_signing_name', e.target.value)}\n                placeholder='Name of artist'\n              />\n            </div>\n          )}\n          {this.props.artistId||this.props.artistInputType!='select'?'':(\n            <a onClick={this.setUnknown}>\n              {copy['artist-input-type-unknown-cta'][lang]}\n        </a>)}\n      </div>\n    )\n  }\n}\n\nexport default ChooseArtist;\n","import React, { Component } from 'react';\nimport copy from '../copy';\n\nclass TextInput extends Component {\n  handleChange= (e) => {\n    this.props.onChange(this.props.name, e.target.value);\n  }\n  onFocus = (e) => {\n    typeof this.props.onFocus === \"function\" && this.props.onFocus(this.props.name);\n  }\n  render() {\n    const {label, refName, name, idName, className, type, title, value, defaultValue, onChange, onKeyUp, errorMsg, validationMsg, placeholder, disabled, icon, lang} = this.props;\n    var didError = null;\n    var isValidated = null;\n    if(errorMsg && errorMsg.length>0){\n      didError= true;\n    }\n    if (validationMsg && validationMsg.length>0){\n      isValidated = true;\n    }\n    var inputComponent =\n          <input\n            type={type}\n            ref={refName||''}\n            id={idName}\n            value={value}\n            name={name}\n            title={title||''}\n            onChange={this.handleChange}\n            onFocus={this.onFocus}\n            placeholder={placeholder||''}\n            onKeyUp={onKeyUp?onKeyUp:()=>{}}\n            onKeyDown={this.props.onKeyDown}\n            autoComplete={this.props.disableAutocomplete ? 'off' : 'on'}\n            className={`input ${didError?'is-danger':''} ${isValidated?'is-success':''} ${className}`}/>;\n\n    if (type=='textarea') {\n      inputComponent=\n        <textarea\n          ref={refName}\n          id={idName}\n          onFocus={this.onFocus}\n          className={type}\n          onChange={this.handleChange}\n          defaultValue={value}/>\n    }\n    return(\n      <div className=\"field is-narrow\">\n        {label?\n        <label className='label ' htmlFor={refName}>{label} </label>\n        :''}\n        <div className={`control ${(didError||isValidated)?'has-icons-right':''} ${icon?'has-icons-left':''}`}>\n          {inputComponent}\n          {icon?(\n            <span className=\"icon is-small is-left\">\n\n            <i className={`fa fa-${icon}`}></i>\n          </span>):''\n          }\n          {(didError||isValidated)?\n          (<span className=\"icon is-small is-right\">\n            <i className={`fa fa-${didError?'warning':'check'}`}></i>\n          </span>):''\n          }\n        </div>\n\n            {(errorMsg&&copy['auth-errors'][errorMsg])?<p className=\"help is-danger\">{copy['auth-errors'][errorMsg][lang]}</p>:''}\n    </div>\n    )\n  }\n}\n\nexport default TextInput;\n","import React from 'react'\nimport scriptLoader from 'react-async-script-loader'\nimport constants from '../constants';\n\nclass GoogleMap extends React.Component {\n  constructor(props){\n    super(props);\n    this.state = {\n      map: null,\n      imageData: null\n    };\n  }\n  placeMarker = (position, map) => {\n\n    const google = window.google;\n    var marker = new google.maps.Marker({\n        position: position,\n        map: map\n    });\n    map.panTo(position);\n  }\n  componentWillReceiveProps ({ isScriptLoaded, isScriptLoadSucceed }) {\n    const google = window.google;\n    if (isScriptLoaded && !this.props.isScriptLoaded) { // load finished\n      if (isScriptLoadSucceed) {\n\n        var map  = new google.maps.Map(this.refs.map, {\n          center: {lat: 43.6532, lng: -79.3832},\n          zoom: 12\n        });\n\n        var input = this.refs.locationQuery;\n        var searchBox = new google.maps.places.SearchBox(input);\n        map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);\n\n        const handleLocationChange = function(place){this.props.onLocationChange(place)}.bind(this);\n\n        var markers = [];\n        var geocoder = new google.maps.Geocoder();\n\n        google.maps.event.addListener(map, 'click', function(event) {\n          geocoder.geocode({\n            'latLng': event.latLng\n          }, function(results, status) {\n            if (status == google.maps.GeocoderStatus.OK) {\n              if (results[0]) {\n                const place = results[0];\n                handleLocationChange(place);\n                markers.forEach(function(marker) {\n                  marker.setMap(null);\n                });\n                markers.push(new google.maps.Marker({\n                  map: map,\n                  title: place.name,\n                  position: place.geometry.location\n                }));\n              }\n            }\n          });\n        });\n\n\n        //LISTENERS\n        map.addListener('bounds_changed', function() {\n          searchBox.setBounds(map.getBounds());\n        });\n        map.addListener('click', function(e) {\n          console.log(e);\n                   });\n\n\n        searchBox.addListener('places_changed', function() {\n          var places = searchBox.getPlaces();\n          if (places.length == 0) {\n            return;\n          }\n          // Clear out the old markers.\n          markers.forEach(function(marker) {\n            marker.setMap(null);\n          });\n          markers = [];\n\n          // For each place, get the icon, name and location.\n          var bounds = new google.maps.LatLngBounds();\n          places.forEach(function(place) {\n            if (!place.geometry) {\n              console.log(\"Returned place contains no geometry\");\n              return;\n            }\n            handleLocationChange(place);\n\n            // Create a marker for each place.\n            markers.push(new google.maps.Marker({\n              map: map,\n              title: place.name,\n              position: place.geometry.location\n            }));\n\n            if (place.geometry.viewport) {\n              // Only geocodes have viewport.\n              bounds.union(place.geometry.viewport);\n            } else {\n              bounds.extend(place.geometry.location);\n            }\n            });\n          map.fitBounds(bounds);\n        });\n      }\n\n      else this.props.onError()\n\n    }\n  }\n\n  render(){\n    return (\n      <div>\n        <div className='control'>\n          <input ref='locationQuery' className=\"controls input\" type=\"text\" placeholder={this.props.searchPlaceholder} style={{width: '60%'}} />\n        </div>\n\n        <div ref=\"map\" style={{width: '100%', zIndex: '10', height: '400px',paddingLeft: 'calc(0.625em - 1px)', paddingRight: 'calc(0.625em - 1px)' }}></div>\n    </div>\n    )\n  }\n}\n\nexport default scriptLoader(\n  [\n    `https://maps.googleapis.com/maps/api/js?key=${constants.GOOGLE_MAPS_API_KEY}&libraries=places&language=${localStorage.getItem('languagePref')}`\n  ]\n)(GoogleMap)\n","import React, { Component } from 'react';\nimport GoogleMap from './GoogleMap';\nimport InputStatusTag from './InputStatusTag';\nimport copy from '../copy';\n\nclass ChooseLocation extends Component {\n  handleLocationChange = (place) => {\n    console.log('location change: ', place);\n    this.props.onChange('google_place', place);\n  }\n  handleClear = () => {\n    this.props.onChange('google_place', {});\n  }\n  render() {\n    const lang = this.props.lang;\n    var isSelected = this.props.place && (Object.keys(this.props.place).length>0)\n    return(\n      <div className='form-section'>\n        <div className='field is-grouped'>\n          <label className='label' style={{marginRight: '8px' }}>{copy['location-field-label'][lang]}</label>\n          <InputStatusTag\n            successText={this.props.place?this.props.place.formatted_address:''}\n            onClear={this.handleClear}\n            status={isSelected?'complete':null}\n            dangerText={copy['none-selected'][lang]}\n          />\n        </div>\n        {isSelected==true ? '' : (\n          <GoogleMap\n            lang={lang}\n            onLocationChange={this.handleLocationChange}\n            place={this.props.place}\n            searchPlaceholder={copy['search-for-location'][lang]}\n            onError={()=>{}}/>\n        )}\n      </div>\n    )\n  }\n}\n\nexport default ChooseLocation;\n","// @flow\nimport React, { Component } from 'react';\nimport DayPicker from 'react-day-picker';\nimport 'react-day-picker/lib/style.css';\nimport InputStatusTag from './InputStatusTag';\nimport {getValidDate} from '../services/dateAndTime';\nimport moment from 'moment';\nimport type { Moment } from 'moment';\nimport TextInput from '../components/TextInput';\nimport MomentLocaleUtils from 'react-day-picker/moment'\n// import 'moment/locale/fr';\nimport copy from '../copy';\n\ntype Props = {\n  date: Moment,\n  onChange: (?string) => void,\n  lang: string\n}\nclass ChooseDate extends Component<Props> {\n  componentWillMount(){\n    // moment().locale(this.props.lang);\n  }\n  handleDayChange = (day: string) => {\n    this.props.onChange(day);\n  }\n  handleSetNow = () => {\n    this.props.onChange( null); //leave null if want to use current datetime\n  }\n  handleClear = () => {\n    this.props.onChange(null);\n  }\n  render() {\n    const lang = this.props.lang;\n    var day = this.props.date ? this.props.date : null;\n    console.log('day: ', day);\n    var successText = day ? day.format('MMM Do YY') : '';\n    console.log('success text: ', successText);\n    return(\n      <div className='form-section'>\n        <div className='field is-grouped'>\n          <label className='label' style={{marginRight: '8px' }}>{copy['photo-date-field-label'][lang]}: </label>\n          <InputStatusTag\n            successText={successText}\n            dangerText={copy['none-selected'][lang]}\n            onClear={this.handleClear}\n            status={day ? 'complete' : null} />\n        </div>\n\n        {day ? '' :\n            <DayPicker\n              onDayClick={this.handleDayChange}\n              locale={lang}\n              localeUtils={MomentLocaleUtils}\n            />\n        }\n\n      </div>\n    )\n  }\n}\n\nexport default ChooseDate;\n\nconst styles ={\n  core: {\n    color: 'red',\n    zIndex: '20'\n  }\n}\n","// @flow\nimport React, { Component } from 'react';\nimport withNewPostProps from '../hoc/withNewPostProps';\nimport {Redirect} from 'react-router-dom';\nimport scriptLoader from 'react-async-script-loader'\nimport type { NavigationProps } from '../types/navigation';\nimport type { GoogleMapsPlace, Location } from '../types/location';\nimport SelectedImage from './SelectedImage';\nimport C from '../constants.js';\nimport ChooseArtist from './ChooseArtist';\nimport TextInput from './TextInput';\nimport ChooseLocation from './ChooseLocation';\nimport ChooseDate from './ChooseDate';\nimport copy from '../copy';\nimport type { User } from '../types/user';\nimport type { NewPost } from '../types/post';\n\ntype Props = NavigationProps & {\n  newPost: {\n    photo_date: ?string\n  },\n  history: {},\n  authUser: {\n    data: ?User\n  },\n  lang: string,\n  fileURLs: Array<string|ArrayBuffer>,\n  files: File[],\n  newPost: NewPost,\n  loading: boolean,\n  error: ?string,\n  onSubmit: () => void,\n  removeImage: (index: number) => void,\n  updateNewPost: (string, ?string) => void,\n  onSelectImages: (SyntheticInputEvent<HTMLInputElement>) => void,\n  lang: string,\n  history: {},\n  onCancel: () => void\n}\ntype State = {\n  redirect: ?string\n}\n\nclass NewPostForm extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      redirect: null,\n    }\n  }\n  removeImage = (index: number) => {\n    console.log('remove');\n    this.props.removeImage(index);\n  }\n  render() {\n    const lang = this.props.lang;\n    if (this.state.redirect) {\n      return (\n        <Redirect to={this.state.redirect} />\n      )\n    }\n    const newPost = this.props.newPost;\n    console.log('photo date: ', newPost.photo_date);\n    return (\n            <div>\n        <h1 className='title is-1'>{copy['new-post'][lang]}</h1>\n        <div>\n          <div>\n            <div className={`field ${this.props.files.length>0?'has-addons':''}`}>\n              <p className='control'>\n                <span className=\"file\">\n                  <label className=\"file-label\">\n                  <input className=\"file-input\" type=\"file\" name=\"photos\" ref=\"photos\" onChange={this.props.onSelectImages} multiple={true}/>\n                  <span className=\"file-cta\">\n                    <span className=\"file-icon\">\n                      <i className=\"fa fa-upload\"></i>\n                    </span>\n                    <span className=\"file-label\">\n                      {copy['image-upload-cta'][lang]}\n                    </span>\n                  </span>\n                </label>\n                </span>\n              </p>\n            </div>\n            <div\n              style={{ width: '100%' }}>\n              {this.props.fileURLs.map((url, i) => (\n              <SelectedImage\n                containerStyle={{\n                  height: '100px',\n                  width: '100px',\n                  borderRadius: '8px',\n                  }}\n                lang={lang}\n                imageSource={url}\n                index={i}\n                removeImage={() => this.removeImage(i)}\n              />\n              ))}\n              </div>\n            </div>\n\n            <hr />\n\n            {this.props.files.length ? (\n            <div>\n              <ChooseArtist\n                lang={lang}\n                artistInputType={newPost.artistInputType}\n                artistName={newPost.artist_signing_name||''}\n                artistId={newPost.ArtistId}\n                onChange={(fieldName, value) =>{this.props.updateNewPost(fieldName, value)}}\n              />\n\n              <ChooseLocation\n                lang={lang}\n                onChange={(fieldName, value) =>{this.props.updateNewPost(fieldName, value)}}\n                place={newPost.google_place} />\n\n              <ChooseDate\n                lang={lang}\n                onChange={(value) =>{this.props.updateNewPost(\"photo_date\", value)}}\n                date={newPost.photo_date}\n              />\n\n              <TextInput\n                label={copy['description-field-label'][lang]}\n                type='textarea'\n                name='description'\n                ref='description'\n                value={newPost.description}\n                onChange={(fieldName, value) =>{this.props.updateNewPost(fieldName, value)}}\n                placeholder={copy['description-input-placeholder'][lang]}\n              />\n\n              <hr />\n\n              <div>\n                {this.props.loading ?\n                  <div style={{textAlign: 'center'}}><a className='button is-loading'>Loading</a><br/></div>:\n                 (<div>\n                    <button className='button is-primary' onClick={this.props.onSubmit}>{copy['submit-new'][lang]}</button>\n\n                    <button className='button' onClick={this.props.onCancel}>{copy['cancel'][lang]}</button>\n                  </div>\n                )}\n              </div>\n            </div>\n            ) : ''}\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default NewPostForm;\n","// @flow\nimport { connect } from 'react-redux';\nimport moment from 'moment';\nimport type { Moment } from 'moment';\nimport React, { Component } from 'react';\nimport {Redirect} from 'react-router-dom';\nimport scriptLoader from 'react-async-script-loader'\nimport type { NavigationProps } from '../types/navigation';\nimport { addImagesToCache } from '../actions/image-cache';\nimport type { GoogleMapsPlace, Location } from '../types/location';\nimport C from '../constants.js';\nimport constants from '../constants';\nimport NewPostForm from '../components/NewPostForm';\nimport copy from '../copy';\nimport EXIF from 'exif-js';\nimport apiService from '../services/api-service';\nimport imageService from '../services/image-service';\nimport { buildCoordinatesFromExif } from '../services/location';\nimport type { Post } from '../types/post';\nimport type { SettingsState } from '../types/store';\nimport type { Artist } from '../types/artist';\nimport type { User } from '../types/user';\nimport type { NewPost } from '../types/post';\n\nconst parseExifDate = (dateString: string): Moment => {\n  // format is: 2019:11:19 22:01:39\n  return moment(dateString, 'YYYY:MM:DD HH:MM:SS');\n}\n\ntype Props = {\n  history: any,\n  authUser: { data: ?User },\n  lang: string,\n  settings: SettingsState,\n  addImagesToCache: ({[string]: any}) => void\n}\n\ntype State = {\n  loading: bool,\n  files: Array<File>,\n  fileURLs: Array<URL>,\n  newPost: NewPost,\n  createdPost: ?Post,\n  error: ?string,\n  errors: {}\n}\n\n\nclass NewPostPage extends Component<Props, State> {\n  constructor(props: Props){\n    super(props);\n    this.state = {\n      loading: false,\n      error: null,\n      files: [],\n      fileURLs: [],\n      newPost: {\n        UserId: null,\n        description: '',\n        google_place: null,\n        photo_date: '',\n        ArtistId: null,\n        artist_signing_name: '',\n        artistInputType: 'select',\n        location: {}\n      },\n      createdPost: null,\n      errors: {}\n    }\n  }\n  componentWillUpdate(nextProps, nextState) {\n    if (!this.state.createdPost && nextState.createdPost) {\n      this.props.history.push('/');\n    }\n  }\n  onSelectImages = (e: SyntheticInputEvent<HTMLInputElement>) => {\n      var files = e.target.files;\n      Array.from(files).forEach((file) => {\n        this.getBase64(file)\n      });\n\n      //get Exif data\n      var exifData = [];\n      const setDateIfEmpty = (photo_date) => {\n        if (this.state.newPost.photo_date) { return }\n        let newPost = Object.assign({}, this.state.newPost, {\n          photo_date\n        });\n        this.setState({\n          newPost\n        });\n      };\n    const setGooglePlaceFromCoords = this.setGooglePlaceFromCoords;\n\n    Array.from(files).map((file, i) => {\n      var exif = EXIF.getData(file, function() {\n\n        const GPSLongitude = EXIF.getTag(this, \"GPSLongitude\");\n        const GPSLongitudeRef = EXIF.getTag(this, \"GPSLongitudeRef\");\n        const GPSLatitude = EXIF.getTag(this, \"GPSLatitude\");\n        const GPSLatitudeRef = EXIF.getTag(this, \"GPSLatitudeRef\");\n        const DateTime = EXIF.getTag(this, \"DateTime\");\n\n        const coords = buildCoordinatesFromExif(GPSLongitude, GPSLongitudeRef, GPSLatitude, GPSLatitudeRef);\n\n        if (DateTime) {\n          setDateIfEmpty(parseExifDate(DateTime));\n        }\n        if (coords) {\n          setGooglePlaceFromCoords(coords.lng, coords.lat);\n        }\n        exifData.push({\n          DateTime,\n          coords\n        });\n      });\n    });\n    this.setState({\n      files: Array.from(files),\n      // exifData: exifData\n    });\n    }\n  getBase64 = (file: File) => {\n    var reader = new FileReader();\n    const addFile = (fileURL: URL) => {\n      var urls = this.state.fileURLs;\n      urls.push(fileURL);\n      this.setState({\n        fileURLs: urls\n      });\n    }\n   reader.onload = function () {\n      addFile(reader.result);\n   };\n   reader.onerror = function (error) {\n     console.log('Error: ', error);\n   };\n   reader.readAsDataURL(file);\n  }\n\n  onSubmit = () => {\n    var entry = this.state.newPost;\n    if (entry.google_place) {\n      const entryParts = {}\n\n      entry.google_place.address_components.forEach((comp) => {\n        comp.types.forEach((type) => {\n          let currValues = entryParts[type] ? entryParts[type] : [];\n          currValues.push(comp.long_name);\n          entryParts[type] = currValues\n        })\n      })\n\n      const postal_code = entryParts.postal_code && entryParts.postal_code.join(', ');\n      const locality = entryParts.locality && entryParts.locality.join(', ');\n      const neighbourhood = entryParts.neightbourhood && entryParts.neighbourhood.join(', ');\n      const street_num = entryParts.street_number && entryParts.street_number.join(', ');\n      const route = entryParts.route && entryParts.route.join(', ');\n      const country = entryParts.country && entryParts.country.join(', ');\n\n      let address = ''\n      if (street_num && route) {\n        address += `${street_num} ${route}`\n      }\n      if (neighbourhood) {\n        if (address.length > 1) {\n          address += `, ${neighbourhood}`\n        } else {\n          address = neighbourhood\n        }\n      }\n      entry.location = {\n        coordinates: {\n          longitude: entry.google_place.geometry.location.lng(),\n          latitude: entry.google_place.geometry.location.lat()\n        },\n        street_address: address,\n        city: locality,\n        country,\n        postal_code,\n        google_place_id: entry.google_place.place_id\n      }\n    } else {\n      this.setState({\n        errors: {\n          location: 'Location required'\n        }\n      });\n      return;\n    }\n    entry.UserId = this.props.authUser.data && this.props.authUser.data.id;\n    // this.submitPost(entry, this.state.files);\n      // this.props.submitNewPost(entry, this.state.files);\n\n    apiService.post(`/posts`, {\n        post: entry\n      }).then((json) => {\n        if (json.post) {\n          apiService.upload(`/posts/${json.post.id}/images`, this.state.files, 'images[]').then((res) => {\n            console.log('res: ', res);\n            if (this.state.files.length === res.images.length ) {\n              const cache = {};\n              for (var i = 0; i < res.images.length; i++) {\n                const storage_location: string = res.images[i].storage_location;\n                const objectURL = window.URL.createObjectURL(this.state.files[i]);\n                cache[storage_location] = objectURL;\n              }\n              console.log('cache: ', cache);\n              this.props.addImagesToCache(cache);\n            } else {\n              console.log('files length: ', this.state.files.length);\n            }\n            this.setState({\n              createdPost: json.post,\n              loading: false\n            })\n          })\n        }\n      })\n      .catch((error) => {\n        this.setState({\n          loading: false,\n          error\n        })\n      });\n  }\n  setGooglePlaceFromCoords = (lng, lat) => {\n    var geocoder = new window.google.maps.Geocoder;\n    var latlng = {lat, lng};\n\n    const setPlaceIfEmpty = (place) => {\n      if (this.state.newPost.google_place) { return; }\n      let newPost = this.state.newPost;\n      newPost.google_place = place\n      this.setState({\n        newPost\n      });\n    }\n    geocoder.geocode({'location': latlng}, function(results, status) {\n      if (results && results.length) {\n        setPlaceIfEmpty(results[0]);\n      }\n    })\n  }\n  removeImage = (index: number) => {\n    const files = this.state.files;\n    files.splice(index, 1);\n    const fileURLs = this.state.fileURLs;\n    fileURLs.splice(index, 1);\n    this.setState({\n      files,\n      fileURLs\n    });\n  }\n  updateNewPost = (field: string, value: ?string) => {\n    let newPost = this.state.newPost;\n    newPost[field] = value\n    this.setState({\n      newPost\n    });\n  }\n  render() {\n    const lang = this.props.settings.languagePref;\n    return (\n      <NewPostForm\n        onCancel={() => { this.setState({ files: [], fileURLs: [] }) }}\n        files={this.state.files}\n        fileURLs={this.state.fileURLs}\n        newPost={this.state.newPost}\n        loading={this.state.loading}\n        error={this.state.error}\n        onSubmit={this.onSubmit}\n        removeImage={this.removeImage}\n        updateNewPost={this.updateNewPost}\n        onSelectImages={this.onSelectImages}\n        lang={lang}\n        history={this.props.history}\n        authUser={this.props.authUser}\n      />\n    )\n  }\n}\n\n\nconst mapStateToProps = function(appState){\n  return {\n    auth: appState.auth,\n    authUser: appState.authUser,\n    settings: appState.settings\n  }\n}\n\nexport default connect(mapStateToProps, { addImagesToCache })(scriptLoader(\n  [\n    `https://maps.googleapis.com/maps/api/js?key=${constants.GOOGLE_MAPS_API_KEY}&libraries=places&language=${localStorage.getItem('languagePref')}`\n  ]\n)(NewPostPage));\n","// @flow\nimport request from './request';\nimport constants from '../constants';\n\nexport type GPSLongitudeRef = 'W' | 'E';\nexport type GPSLatitudeRef = 'N' | 'S';\nexport type Coordinates = {\n  lat: number,\n  lng: number\n}\n\ntype ExifData = {\n  GPSLongitude: number[],\n}\n\nexport const buildCoordinatesFromExif = (\n  gpsLongitude: number[],\n  gpsLongitudeRef: GPSLongitudeRef,\n  gpsLatitude: number[],\n  gpsLatitudeRef: GPSLatitudeRef\n): ?Coordinates => {\n\n  if (gpsLongitude && gpsLongitudeRef && gpsLatitude && gpsLatitudeRef) {\n    const lngDegrees = gpsLongitude[0];\n    const lngMinutes = gpsLongitude[1];\n    const lngSeconds = gpsLongitude[2];\n    let lng = lngDegrees + lngMinutes/60 + lngSeconds/3600;\n\n    if (gpsLongitudeRef == 'W') {\n      lng = lng * -1\n    }\n    const latDegrees = gpsLatitude[0];\n    const latMinutes = gpsLatitude[1];\n    const latSeconds = gpsLatitude[2];\n    let lat = latDegrees + latMinutes/60 + latSeconds/3600;\n    if (gpsLatitudeRef == 'S') {\n      lat = lat * -1\n    }\n    return {\n      lng,\n      lat\n    }\n  }\n  return null;\n}\n\n/*\nfunction dataURLtoFile(dataurl, filename) {\n      var arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1],\n          bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);\n      while(n--){\n          u8arr[n] = bstr.charCodeAt(n);\n      }\n      return new File([u8arr], filename, {type:mime});\n  }\n\nconst getAddressComponents = (place) => {\n  var address = {};\n  place.address_components.forEach(function(c) {\n      switch(c.types[0]){\n          case 'street_number':\n              address.StreetNumber = c;\n              break;\n          case 'route':\n              address.StreetName = c;\n              break;\n          case 'neighborhood': case 'locality':    // North Hollywood or Los Angeles?\n              address.City = c;\n              break;\n          case 'administrative_area_level_1':     //  Note some countries don't have states\n              address.State = c;\n              break;\n          case 'postal_code':\n              address.Zip = c;\n              break;\n          case 'country':\n              address.Country = c;\n              break;\n      }\n  });\n\n  return address;\n}\n\nconst getCoord = (number, ref) => {\n    var l = number[0].numerator + number[1].numerator /\n      (60 * number[1].denominator) + number[2].numerator / (3600 * number[2].denominator);\n    if (ref == 'W'|'S') {\n      return l*(-1)\n    } else {\n      return l\n    }\n}\nconst reverseGeocode = (lat, lng)=> {\n  var url = `https://maps.googleapis.com/maps/api/geocode/json?latlng=${lat},${lng}&key=${constants.GOOGLE_MAPS_API_KEY}`\n  return fetch(url)\n      .then(res => res.json())\n      .then((data) => {\n        return data;\n      })\n        .catch((err) => {\n          return({\n            formatted_address: `Reverse geocoding failed. Coordinates for this image are latitude: ${lat}, longitude: ${lng}`,\n            geometry: {\n              location: {\n                lat: lat,\n                lng: lng\n              }\n            },\n            city: 'Unknown',\n          })\n        });\n}\nexport default {\n  getAddressComponents: getAddressComponents,\n  getCoord: getCoord,\n  dataURLtoFile: dataURLtoFile,\n  reverseGeocode: reverseGeocode\n}\n\n\n\n/* export function _getCoord(number, ref) {\n  console.log('get coord: ', number, ref);\n  var l = number[0].numerator + number[1].numerator /\n    (60 * number[1].denominator) + number[2].numerator / (3600 * number[2].denominator);\n  if (ref == 'W'|'S') {\n    return l*(-1)\n  } else {\n    return l\n  }\n}\n\nexport function _reverseGeocode(lat, lng){\n  var url = `https://maps.googleapis.com/maps/api/geocode/json?latlng=${lat},${lng}&key=AIzaSyCN9joc20fO_YTL4VRhjeOtcdC3i04zGCs`\n  return request({url: url})\n      .then((data) => {\n        return data;\n      })\n        .catch((err) => {\n          return({\n            formatted_address: `Reverse geocoding failed. Coordinates for this image are latitude: ${lat}, longitude: ${lng}`,\n            geometry: {\n              location: {\n                lat: lat,\n                lng: lng\n              }\n            },\n            city: 'Unknown',\n          })\n  });\n}\n\n  */\n","// @flow\nimport type { Dispatch, GetState } from '../types/redux';\nimport imageService from '../services/image-service';\n\nexport const addImagesToCache = (images: {[string]: any}) => {\n  return function(dispatch: Dispatch, getState: GetState){\n    return dispatch({ type: 'ADD_IMAGES', images });\n  }\n}\n\n","import React, { Component } from 'react';\nimport {timeSince} from '../../../services/utils';\n\nclass ArtistListItem extends Component {\n  render() {\n    const artist  = this.props.artist;\n    let nameText = '';\n    if (artist.first_name) { nameText += artist.first_name }\n    if (artist.last_name) { nameText += '' + artist.last_name }\n    if (!nameText || nameText.count === 0) {\n      nameText = \"Name unknown\"\n    }\n    return(\n      <div className=\"card\">\n        <div className=\"card-content\">\n          <div className=\"media\">\n            <div className=\"media-content\">\n              <h3 className=\"title is-4\"><a href={`/artists/${artist.id}`}> {artist.signing_name} </a></h3>\n\n              <p className=\"subtitle is-5\">{nameText}</p>\n            </div>\n          </div>\n\n          <div className='content'>\n          </div>\n\n        </div>\n      </div>\n\n    )\n  }\n}\n\nexport default ArtistListItem;\n","import React, { Component } from 'react';\nimport C from '../constants';\nimport apiService from '../services/api-service';\nimport type { Artist } from '../types/artist';\n\ntype Props = {\n  query: {\n    artistId: ?number,\n    artistId: ?number,\n    userId: ?number,\n    search: ?string,\n    applaudedBy: ?number,\n  },\n  history: any,\n  authUser: { data: {} },\n  lang: string\n}\n\ntype State = {\n  loading: bool,\n  artists: [],\n  artist: ?Artist,\n  error: ?string\n}\n\nexport default function withArtistProps(WrappedComponent) {\n  return class extends Component {\n    constructor(props: Props) {\n      super(props);\n      this.state = {\n        loading: false,\n        error: null,\n        artists: [],\n        artist: null,\n        authModalActive: false\n      }\n    }\n    getArtist = (props) => {\n      console.log('getartist: ');\n      const artistId = props.query.artistId;\n      if (!artistId) {\n        return\n      }\n      this.setState({ loading: true });\n      return apiService.get(`/api/artists/${artistId}`, {})\n        .then((json) => {\n        if (json.artist) {\n          this.setState({\n            loading: false,\n            artist: json.artist\n          });\n        } else {\n          console.log(json);\n        }\n      })\n      .catch((error) => {\n        console.log(error);\n        this.setState({\n          artist: null,\n          loading: false,\n          error\n        });\n      });\n    }\n    getArtists = (props: Props) => {\n      this.setState({ loading: true });\n      const values = props.query;\n      let qs = \"\";\n      if (values) {\n        qs = Object.keys(values).map(key => {\n          return encodeURIComponent(key) + '=' + encodeURIComponent(values[key]);\n        }).join('&');\n        qs = \"?\" + qs;\n      }\n      return apiService.get(\"/api/artists\" + qs, {})\n        .then((json) => {\n          console.log('json: ', json);\n        if (json.artists) {\n          this.setState({\n            loading: false,\n            artists: json.artists\n          });\n        } else {\n          console.log(json);\n        }\n      })\n      .catch((error) => {\n        console.log(error);\n        this.setState({\n          artists: [],\n          loading: false,\n          error\n        });\n      });\n    }\n    applaudArtist = (ArtistId: number) => {\n      const UserId = this.props.authUser && this.props.authUser.id;\n      if (!UserId) {\n        this.setState({\n          authModalActive: true\n        });\n        return\n      }\n      console.log('UserId: ', UserId);\n      return apiService.artist(`/api/applause`, {\n        body: { applause: { UserId, ArtistId }}\n      })\n        .then((json) => {\n          if(json.applause) {\n            const applause = json.applause;\n            var newItems = this.state.artists.map((item, i) => {\n              if (item.id === applause.ArtistId) {\n                const updatedApplause = item.Applause ? item.Applause : [];\n                updatedApplause.push(applause);\n                return Object.assign({}, item, {\n                  Applause: updatedApplause\n                })\n              }\n              return item;\n            });\n            this.setState({\n              artists: newItems,\n              loading: false\n            })\n          } else if (json.deleted) {\n            // remove applause\n            const applause = json.deleted;\n            var newItems = this.state.artists.map((item, i) => {\n              if (item.id === applause.ArtistId) {\n                const updatedApplause = item.Applause ? item.Applause : [];\n                const index = updatedApplause.indexOf(applause);\n                updatedApplause.splice(index, 1)\n                if (index > -1 ) {\n                  return Object.assign({}, item, {\n                    Applause: updatedApplause\n                  })\n                }\n              }\n              return item;\n            });\n            this.setState({\n              artists: newItems,\n              loading: false\n            });\n          } else {\n            console.log(json);\n          }\n        })\n        .catch((error) => {\n          this.setState({\n            loading: false,\n            error\n          });\n        })\n    }\n    selectArtist = (artistId: number) => {\n      this.props.history.push(`/artists/${artistId}`)\n    }\n    deleteArtist = (artistId: number) => {\n      return apiService.delete(\"/api/artists/\" + artistId, {})\n        .then(data => {\n          const artist = data.artist;\n          if (artist) {\n            var newItems = this.state.artists.filter((item, i) => {\n              return item.id !== artist.id\n            })\n            this.setState({\n              artists: newItems,\n              loading: false\n            })\n          } else {\n            throw new Error()\n          }\n        })\n        .catch((error) => {\n          this.setState({\n            loading: false,\n            error\n          });\n        })\n    }\n\n    render() {\n      return (\n        <div>\n          <WrappedComponent\n            artist={this.state.artist}\n            artists={this.state.artists}\n            loading={this.state.loading}\n            error={this.state.error}\n            getArtists={this.getArtists}\n            getArtist={this.getArtist}\n            deleteArtist={this.deleteArtist}\n            selectArtist={this.selectArtist}\n            {...this.props}\n          />\n        </div>\n      );\n    }\n  }\n}\n","import React from 'react';\nimport ArtistListItem from './ArtistListItem';\nimport withArtistProps from '../../hoc/withArtistProps';\n\nclass ArtistList extends React.Component {\n  componentWillMount() {\n    this.props.getArtists(this.props);\n  }\n  componentWillReceiveProps(nextProps) {\n    if (this.props.query !== nextProps.query) {\n      this.props.getArtists(nextProps);\n    }\n  }\n  render() {\n    let listItems = this.props.artists.map((artist, i) => (\n      <ArtistListItem\n        key={i}\n        artist={artist}\n        onSearchKeyChange={this.props.onSearchKeyChange}\n      />\n    ));\n    if (this.props.loading) {\n      return <div>Loading...</div>\n    }\n    return (\n      <div>\n        {(this.props.artists && this.props.artists.length>0)?\n            listItems:\n            (<span>\n              <strong>No results. Broaden your search to find matches. </strong>\n            </span>)\n        }\n      </div>\n    );\n  }\n};\n\nexport default withArtistProps(ArtistList);\n","// @flow\nimport React, { Component } from 'react';\nimport InfoField from './InfoField';\nimport copy from '../copy.json';\nimport type { Artist } from '../types/artist';\n\ntype Props = {\n  lang: string,\n  artist: Artist\n}\nclass ArtistInfo extends Component<Props> {\n  render() {\n    const lang = this.props.lang;\n    if (this.props.artist) {\n      const { artist } = this.props;\n      return(\n        <div>\n          <InfoField\n            label='Name'\n            value={artist.signing_name}\n          />\n          <InfoField\n            label='Bio'\n            value={artist.bio}\n            emptyText={copy.none_provided[lang]}\n          />\n        </div>\n      )\n    } else {\n      return (<span>Loading</span>);\n    }\n  }\n}\n\nexport default ArtistInfo;\n","import React, { Component } from 'react';\nimport ArtistList from '../components/ArtistList';\nimport SearchBar from '../components/SearchBar';\nimport RangeSlider from '../components/RangeSlider';\nimport {Route, Switch} from 'react-router-dom';\nimport copy from '../copy';\n\nclass ArtistListPage extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            searchKey: \"\",\n            min: 0,\n            max: 30,\n            artists: [],\n            total: 0,\n            page: 1\n        }\n    }\n  componentDidMount() {\n      this.findArtists();\n    }\n    searchKeyChangeHandler(searchKey) {\n        this.setState({searchKey: searchKey, page: 1}, this.findArtists);\n    }\n\n    rangeChangeHandler(values) {\n        this.setState({min: values[0], max: values[1], page: 1}, this.findArtists);\n    }\n\n  findArtists() {\n        this.props.getArtists({search: this.state.searchKey, min: this.state.min, max: this.state.max, page: this.state.page})\n    }\n\n    nextPageHandler() {\n        let p = this.state.page + 1;\n        this.setState({page: p}, this.findArtists);\n    }\n\n    prevPageHandler() {\n        let p = this.state.page - 1;\n        this.setState({page: p}, this.findArtists);\n    }\n\n\n  render() {\n    const { artists } = this.props;\n    console.log('artists: ', artists);\n    const lang = this.props.settings.languagePref;\n    return(\n      <div>\n            <div>\n              <section className=\"section\">\n                <div className='columns'>\n                  <div className='column'>\n\n                <SearchBar searchKey={this.state.searchKey} onChange={this.searchKeyChangeHandler.bind(this)} placeholder={copy['search-for-artist'][lang]}/>\n              </div>\n      <div className='column is-narrow'>\n              <a className='button is-primary' href='/artists/new'>+ {copy['add-new-artist'][lang]}</a>\n            </div>\n          </div>\n              </section>\n              <section>\n                <ArtistList\n                  artists={artists.data}\n                  loading={artists.loading}\n                  total={artists.total}\n                  hasreceiveddata={artists.hasreceiveddata}\n                />\n              </section>\n            </div>\n      </div>\n    )\n  }\n}\n\nexport default ArtistListPage;\n","import React, { Component } from 'react';\nimport TextInput from './TextInput';\nimport Redirect from 'react-router-dom';\n\nclass ArtistEditForm extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      signing_name: this.props.artist.signing_name||'',\n      bio: this.props.artist.bio ||'',\n      errors: {}\n    }\n  }\n  onInputChange = (fieldName, newValue) => {\n    var newState = this.state;\n    newState[fieldName] = newValue;\n    this.setState({newState});\n  }\n\n  handleSubmit = () => {\n    var entry = {\n      signing_name: this.state.signing_name,\n      bio: this.state.bio,\n    }\n    this.props.onSubmit(this.props.artist.id, entry);\n    this.props.onCancel();\n  }\n\n  render() {\n    const artist = this.state;\n    return (\n      <div>\n\n        <TextInput\n          label='Signing name'\n          type='text'\n          ref='signing_name'\n          name='signing_name'\n          value={artist.signing_name}\n          onChange={this.onInputChange}\n          errorMsg={this.state.errors.signing_name}\n        />\n       <TextInput\n          label='Bio'\n          type='textarea'\n          ref='bio'\n          name='bio'\n          value={artist.bio}\n          onChange={this.onInputChange}\n          errorMsg={this.state.errors.bio}\n        />\n\n      <button className='button is-primary' onClick={this.handleSubmit}>Submit</button>\n        <button className='button' onClick={this.props.onCancel}>Cancel</button>\n      </div>\n        )\n  }\n}\n\nexport default ArtistEditForm;\n","// @flow\nimport React from 'react';\nimport { Link } from 'react-router-dom';\nimport C from '../constants';\nimport type { Post } from '../types/post';\nimport imageService from '../services/image-service';\nimport CacheableImage from './PostImage';\n\ntype Props = {\n  posts: Post[],\n  loading: boolean\n}\ntype State = {\n}\nclass PostGallery extends React.Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      images: {}\n    }\n  }\n  render() {\n    if (this.props.loading) {\n      return (<div className='postlist-container'>Loading...</div>)\n    }\n    return (\n      <div className='gallery'>\n        {this.props.posts.length ? this.props.posts.map((post, i) => {\n          const firstImage = post.PostImages && post.PostImages[0];\n          if (firstImage) {\n          return (\n          <div className='grid-container'>\n\n              <div className='grid-item' key={i}>\n                <Link to={`/posts/${post.id}`}>\n                  <figure style={{  }}>\n                    <CacheableImage\n                      storageLocation={post.PostImages && post.PostImages[0].storage_location}\n                    />\n                  </figure>\n                </Link>\n              </div>\n            </div>\n            )\n          } else {\n            return <div />\n          }\n        }) : <span><strong>No results for this artist. </strong></span>}\n      </div>\n    );\n  }\n};\n\nexport default PostGallery;\n","// @flow\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport ArtistInfo from '../components/ArtistInfo';\nimport C from '../constants';\nimport apiService from '../services/api-service';\nimport type { Artist } from '../types/artist';\nimport type { Post } from '../types/post';\nimport ArtistEditForm from '../components/ArtistEditForm';\nimport PostGallery from '../components/PostGallery';\nimport type { SettingsState } from '../types/store';\n\ntype Props = {\n  match: {\n    params: {\n      id: string\n    }\n  },\n  history: any,\n  authUser: { data: {} },\n  lang: string,\n  auth: {},\n  settings: SettingsState\n}\n\ntype State = {\n  artist: {\n    data: ?Artist,\n    error: ?string,\n    editing: boolean,\n    loading: boolean,\n  },\n  posts: {\n    data: Post[],\n    error: ?string,\n    loading: boolean\n  }\n}\n\nclass ArtistProfilePage extends Component<Props, State> {\n  constructor(props: Props){\n    super(props);\n    this.state = {\n      artist: {\n        data: null,\n        editing: false,\n        loading: false,\n        error: null\n      },\n      posts: {\n        loading: false,\n        data: [],\n        error: null\n      }\n    }\n  }\n  componentWillMount(){\n    this.getArtist(this.props);\n    this.getArtistPosts(this.props);\n  }\n  getArtist = (props: Props) => {\n      const artistId = this.props.match.params.id;\n      if (!artistId) {\n        return\n      }\n    this.setState({\n      artist: {\n        data: null,\n        loading: true,\n        error: null,\n        editing: false\n      }\n    });\n    return apiService.get(`/artists/${artistId}`)\n      .then((json) => {\n        if (json.artist) {\n        this.setState({\n          artist: {\n            editing: false,\n            loading: false,\n            data: json.artist,\n            error: null\n          }\n        });\n      } else {\n        this.setState({\n          artist: {\n            ...this.state.artist,\n            loading: false\n          }\n        });\n      }\n    })\n    .catch((error) => {\n      this.setState({\n        artist: {\n          data: null,\n          loading: false,\n          error,\n          editing: false\n        }\n      });\n    });\n  }\n    getArtistPosts = (props: Props) => {\n      this.setState({ posts: {\n        data: [], loading: true, error: null\n      }});\n      const artistId = this.props.match.params.id;\n      return apiService.get(\"/posts?artistId=\" + artistId)\n        .then((json) => {\n          if (json.posts) {\n          this.setState({\n            posts: {\n              data: json.posts,\n              loading: false,\n              error: null\n            }\n          });\n        } else {\n          this.setState({\n            posts: {\n              data: [],\n              loading: false,\n              error: null\n            }\n          });\n        }\n      })\n      .catch((error) => {\n        this.setState({\n          posts: {\n            data: [],\n            loading: false,\n            error\n          }\n        });\n      });\n    }\n  closeForm = () => {\n    this.setState({\n      artist: {\n        ...this.state.artist,\n        editing: false\n      }\n    });\n  }\n\n  openForm = () => {\n    this.setState({\n      artist: {\n        ...this.state.artist,\n        editing: true\n      }\n    });\n  }\n  handleUpdate = (id: number, content: {}) => {\n    // this.props.onUpdate(id, content);\n  }\n  render() {\n    if (this.state.artist.loading) {\n      return <div>Loading...</div>\n    }\n    const id = this.props.match.params.id;\n    const artist = this.state.artist.data;\n    const artistPosts = this.state.posts.data;\n    const lang = this.props.settings.languagePref;\n    return (\n      <div>\n        <h1 className='title is-1'>{artist && artist.signing_name}</h1>\n\n        {this.state.artist.editing ? (\n        <div>\n          <ArtistEditForm\n            artist={artist}\n            onSubmit={this.handleUpdate}\n            onCancel={this.closeForm}\n          />\n        </div> ) : (\n          <div>\n            <div>\n              <ArtistInfo\n                artist={artist}\n                lang={lang}\n              />\n              <button className='button' onClick={this.openForm}>Edit</button>\n            </div>\n\n            <div style={{ marginTop: '24px' }}>\n              {artist && <h3 className='title is-3'>Posts by {artist.signing_name}</h3>}\n              {this.state.posts.loading && !this.state.artist.loading ? <p>Loading...</p> : (\n              <PostGallery\n                loading={this.state.posts.loading}\n                posts={this.state.posts.data}\n                total={this.state.posts.data.length}\n              />)}\n            </div>\n          </div>\n        )\n      }\n    </div>\n    )\n  }\n}\nconst mapStateToProps = (appState) => ({\n  auth: appState.auth,\n  settings: appState.settings\n})\nexport default connect(mapStateToProps)(ArtistProfilePage)\n","import React, { Component } from 'react';\nimport TextInput from './TextInput';\nimport copy from '../copy';\n\nclass ArtistForm extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      first_name: '',\n      last_name: '',\n      signing_name: '',\n      errors: {},\n    }\n  }\n  onInputChange = (fieldName, newValue) => {\n    var newState = this.state;\n    newState[fieldName] = newValue;\n    this.setState({newState});\n  }\n\n  handleSubmit = () => {\n    var entry = {\n      first_name: this.state.first_name,\n      last_name: this.state.last_name,\n      signing_name: this.state.signing_name\n    }\n    this.props.onSubmit(entry);\n    this.props.onCancel();\n    this.forceUpdate();\n  }\n\n  render() {\n    const lang = this.props.lang;\n    return (\n      <div>\n        <h1>{copy['add-new-artist'][lang]}</h1>\n        <TextInput\n          label={copy['signing_name-field-label'][lang]}\n          type='text'\n          ref='signing_name'\n          name='signing_name'\n          value={this.state.signing_name}\n          onChange={this.onInputChange}\n          errorMsg={this.state.errors.description}\n        />\n        <TextInput\n          label={copy['first_name-field-label'][lang]}\n          type='text'\n          ref='first_name'\n          name='first_name'\n          value={this.state.first_name}\n          onChange={this.onInputChange}\n          errorMsg={this.state.errors.first_name}\n        />\n        <TextInput\n          label={copy['last_name-field-label'][lang]}\n          type='text'\n          ref='last_name'\n          name='last_name'\n          value={this.state.last_name}\n          onChange={this.onInputChange}\n          errorMsg={this.state.errors.last_name}\n        />\n        <button className='button is-primary' onClick={this.handleSubmit}>{copy['submit-new'][lang]}</button>\n        <button className='button' onClick={this.props.onCancel}>{copy['cancel'][lang]}</button>\n      </div>\n        )\n  }\n}\n\nexport default ArtistForm;\n","import React, { Component } from 'react';\nimport ArtistForm from '../components/ArtistForm';\nimport ArtistEditForm from '../components/ArtistEditForm';\nimport {Redirect} from 'react-router-dom';\n\nclass ArtistFormPage extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpen: false,\n      artistQuery: '',\n      redirect: false\n    }\n  }\n  componentDidMount() {\n    this.findArtists(this.state.artistQuery);\n  }\n  findArtists = () => {\n    this.props.getArtists({ name: this.state.artistQuery });\n  }\n  handleCancel = () => {\n    this.setState({\n      redirect: true\n    })\n  }\n  handleUpdate = (id, content) => {\n    this.props.onUpdate(id, content);\n  }\n  render() {\n    const redirectTarget = this.props.artist?'/artists/'+this.props.artist.id:'/artists';\n    if (this.state.redirect==true){\n      return (\n        <Redirect to={redirectTarget} />\n      )\n    }\n    else if (this.props.artist) {\n      return(\n        <ArtistEditForm\n          artist={this.props.artist}\n          onSubmit={this.handleUpdate}\n          onCancel={this.props.onCancel}/>\n      )\n    } else {\n    return(\n      <ArtistForm\n        lang={this.props.settings.languagePref}\n        onCancel={this.handleCancel}\n        onSubmit={this.props.onSubmit}\n        artistList={this.props.artists.items}/>\n      )\n    }\n  }\n}\n\nexport default ArtistFormPage;\n","import C from '../constants';\nlet baseURL = C.SERVER_URL;\n\nfunction requestArtists(values) {\n  return {\n    type: 'GET_ARTISTS_REQUEST',\n  }\n}\n\nfunction receiveArtists(data) {\n  console.log('data: ', data);\n  return {\n    type: 'GET_ARTISTS_SUCCESS',\n    artists: data.artists,\n    page: data.page,\n    pageSize: data.pageSize,\n    total: data.total,\n    receivedAt: Date.now()\n  }\n}\n\nfunction getArtistPosts(artistId: number) {\n  return function(dispatch: Dispatch, getState: GetState) {\n    dispatch({ type: 'GET_ARTIST_POSTS_REQUEST' });\n    const qs = `?ArtistId=${artistId}`;\n    const opts = {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }\n    return fetch(baseURL + \"/api/posts\" + qs, opts)\n      .then((res) => {\n        return res.json()\n      })\n      .then((json) => {\n        if (json.posts) {\n          return dispatch({ type: 'GET_ARTIST_POSTS_SUCCESS', posts: json.posts})\n        }\n      })\n      .catch((error) => {\n        dispatch({\n          type: 'GET_ARTIST_POSTS_ERROR',\n          error\n        })\n      });\n  }\n}\nfunction getArtists(values) {\n  return function(dispatch){\n    dispatch(requestArtists(values));\n    let qs = \"\";\n    if (values) {\n        qs = Object.keys(values).map(key => {\n            return encodeURIComponent(key) + '=' + encodeURIComponent(values[key]);\n        }).join('&');\n        qs = \"?\" + qs;\n    }\n    return fetch(baseURL + \"/api/artists\" + qs)\n      .then(res => res.json())\n      .then(data => {\n        return dispatch(receiveArtists(data))\n      })\n      .catch((error) => {\n        return dispatch({type: 'GET_ARTISTS_ERROR', error })\n      });\n  }\n}\n\nfunction submitNewArtist(values) {\n  console.log('values: ', values);\n  return function(dispatch, getState){\n    dispatch({type: C.AWAIT_NEW_ARTIST_RESPONSE});\n    return fetch(baseURL + \"/api/artists\", {method: \"POST\", body: JSON.stringify({ artist: values }), headers: {'Content-Type': 'application/json'}})\n      .then(res => res.json())\n      .then((json) => {\n          dispatch({type:C.RECEIVE_NEW_ARTIST_RESPONSE, data: json.data});\n          dispatch(getArtists());\n      })\n      .catch((error) => {\n        dispatch({type: C.FAILED_NEW_ARTIST_RESPONSE, error });\n      })\n  }\n}\n\nfunction submitArtistEdit(id, values) {\n  return function(dispatch, getState){\n    dispatch({type: C.START_ARTIST_EDIT, id: id});\n    return fetch(baseURL + \"/api/artists/\" + id, {\n      method: \"PUT\",\n      body: JSON.stringify(values),\n      headers: {'Content-Type': 'application/json'}\n    })\n    .then((res) => res.json())\n      .then((json) => {\n        if (json.successful ==true) {\n        dispatch({type: 'ARTIST_EDIT_SUCCESS', data: json.data});\n          dispatch(findById(id));\n        } else {\n          const errors = {};\n          json.errors.map((error, i) => {\n            errors[error.param] = {\n              msg: error.msg,\n              value: error.value\n            }\n          })\n          dispatch({type: C.ARTIST_EDIT_ERROR, errors: errors});\n        }\n      })\n    }\n  }\n\n\n\nlet findById = (id) => {\n  return function(dispatch){\n    dispatch(requestArtist(id));\n    return fetch(baseURL + \"/api/artists/\" + id)\n      .then(res => res.json())\n      .then(data => dispatch(receiveArtist(data.artist)));\n  }\n}\nfunction requestArtist(id) {\n  return {\n    type: 'GET_ARTIST_REQUEST',\n  }\n}\n\nfunction receiveArtist(data) {\n  return {\n    type: 'GET_ARTIST_SUCCESS',\n    artist: data\n  }\n}\n\nconst startArtistEdit = (qid) => {\n\t\treturn {type:C.START_ARTIST_EDIT,qid};\n}\n\nconst cancelArtistEdit = (qid) => {\n\t\treturn {type:C.FINISH_ARTIST_EDIT,qid};\n}\n\n\n\nexport default {\n  getArtists,\n  findById,\n  submitNewArtist,\n  startArtistEdit,\n  cancelArtistEdit,\n  submitArtistEdit,\n  getArtistPosts\n};\n","import React, { Component } from 'react';\nimport ArtistFormPage from '../pages/ArtistFormPage';\nimport artistActions from '../actions/artists';\nimport {connect} from 'react-redux';\n\n\nvar mapStateToProps = function(appState){\n  return {\n    artists: appState.artists,\n    settings: appState.settings\n  }\n}\nvar mapDispatchToProps = function(dispatch){\n  return {\n    onSubmit: function(artist){ dispatch(artistActions.submitNewArtist(artist)); },\n\n    onUpdate: function(id, content){ dispatch(artistActions.submitArtistEdit(id, content)); },\n    getArtists: function(query){ dispatch(artistActions.getArtists(query)); }\n  }\n}\nexport default connect(mapStateToProps, mapDispatchToProps)(ArtistFormPage);\n","// @flow\nimport React, { Component } from 'react';\nimport {getMonthName} from '../services/utils';\nimport copy from '../copy';\nimport moment from 'moment';\n// import 'moment/locale/fr';\nimport InfoField from './InfoField';\nimport type { User } from '../types/user';\n\ntype Props = {\n  user: {\n    data: ?User,\n    error: ?string,\n    loading: boolean\n  },\n  lang: string\n}\ntype State = {\n}\nclass UserInfo extends Component<Props, State> {\n\n  constructor(props: Props){\n    super(props);\n\n  }\n  componentWillReceiveProps(nextProps: Props){\n    if (nextProps.user.data != this.props.user.data) {\n      this.forceUpdate();\n    }\n    // moment().locale(this.props.lang);\n  }\n\n  render() {\n    const lang = this.props.lang;\n    const user = this.props.user.data;\n    if (this.props.user.loading) {\n      return (<span>Loading</span>);\n    }\n    if (this.props.user.error) {\n      return <p className='is-danger'>{this.props.user.error}</p>\n    }\n    if (user) {\n      const date_joined = this.props.user.data ? moment(user.createdAt) : null;\n      return(\n        <div>\n          <InfoField\n            label={copy['username'][lang]}\n            value={user.username}\n          />\n\n          {date_joined && <InfoField\n            label={copy['member-since'][lang]}\n            value={date_joined.format('YYYY/MM/DD')}\n          />}\n\n          <InfoField\n            label={copy['bio'][lang]}\n            value={user.bio}\n            emptyText={copy.none_provided[lang]}\n          />\n        </div>\n      )\n    }\n    return <p>Something went wrong</p>\n  }\n}\n\nexport default UserInfo;\n","// @flow\nimport React, { Component } from 'react';\nimport TextInput from '../components/TextInput';\nimport copy from '../copy';\nimport type { User } from '../types/user';\n\ntype Props = {\n  user: {\n    data: ?User,\n    error: ?string,\n    loading: boolean\n  },\n  lang: string,\n  onSubmit: (number, User) => void,\n  isNewUser: boolean\n}\n\ntype State = {\n  editedUser: User,\n  errors: {}\n}\nclass UserProfileForm extends Component<Props, State> {\n  constructor(props: Props){\n    super(props);\n    this.state = {\n      editedUser: {},\n      errors: { }\n    }\n  }\n\n  componentDidMount() {\n    if (this.props.user.data) {\n      this.setState({\n        editedUser: this.props.user.data\n      });\n    }\n  }\n\n  onFocus = (fieldName: string) => {\n    var errors = this.state.errors;\n    errors[fieldName] = null;\n    this.setState({\n      errors\n    });\n  }\n\n  onInputChange = (fieldName: string, newValue: ?string) => {\n    var { editedUser } = this.state;\n    editedUser[fieldName] = newValue;\n    this.setState({ editedUser });\n  }\n\n  handleSubmit = () => {\n    console.log('yhandle submit');\n    var errors = {}\n    // validation here\n    this.setState({\n      errors\n    });\n    if (this.props.user.data && Object.keys(errors).length == 0) {\n      this.props.onSubmit(this.props.user.data.id, this.state.editedUser);\n    } else {\n      console.log('errors; ', errors);\n      console.log('user: ', this.props.user.data);\n    }\n  }\n\n  onEnterSubmit = (e: SyntheticKeyboardEvent<>) => {\n    if (e.keyCode == 13){\n      this.handleSubmit();\n    }\n  }\n  render() {\n    const lang = this.props.lang;\n    const errors = this.state.errors;\n    return(\n      <div className='control'>\n        {this.props.user.error ?\n            <div className=\"message is-danger\">\n              <div className=\"message-body\">\n                {copy['bio']['registration-failed'][lang]}\n              </div>\n            </div>:''}\n\n            <TextInput\n              lang={lang}\n              label={copy['bio'][lang]}\n              type='textarea'\n              name='bio'\n              ref='bio'\n              value={this.state.editedUser.bio}\n              onFocus={this.onFocus}\n              onChange={this.onInputChange}\n              errorMsg={errors.bio}\n              disableAutocomplete={this.props.isNewUser}\n            />\n\n            {!this.props.user.loading && this.props.user.error &&\n            <div className='notification is-danger'>{this.props.user.error}</div>}\n\n              <button\n                className={`button is-info${(this.props.user.loading) ? 'is-loading':''}`}\n                onClick={this.handleSubmit}\n              >{copy['save-changes'][lang]}\n              </button>\n      </div>\n    )\n  }\n}\n\nexport default UserProfileForm;\n","// @flow\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport type { NavigationProps } from '../types/navigation';\nimport UserInfo from '../components/UserInfo';\nimport UserProfileForm from '../components/UserProfileForm';\nimport apiService from '../services/api-service';\nimport copy from '../copy';\nimport PostList from '../components/PostList';\nimport Can from '../components/Can';\nimport type { User } from '../types/user';\nimport type { Post } from '../types/post';\nimport type { Applause } from '../types/applause';\nimport type { SettingsState, AuthUserState, AuthState } from '../types/store';\n\ntype Props = NavigationProps & {\n  auth: AuthState,\n  match: {\n    params: {\n      id: number // id of selected user\n    }\n  },\n  // redux props\n  authUser: AuthUserState,\n  settings: SettingsState\n}\n\ntype State = {\n  isEditing: boolean,\n  tabs: Array<string>,\n  activeTab: ?string,\n  user: {\n    loading: boolean,\n    error: ?string,\n    data: ?User\n  }\n}\nclass UserProfilePage extends Component<Props, State> {\n  constructor(props: Props){\n    super(props);\n    this.state = {\n      user: {\n        loading: false,\n        error: null,\n        data: null\n      },\n      isEditing: false,\n      tabs: [],\n      activeTab: null\n    }\n  }\n  componentWillMount(){\n    const tabs = [\"profile\", \"applause\", \"posts\"];\n    if (this.isAuthUser()) {\n      tabs.push(\"account\");\n    }\n    this.setState({\n      tabs: tabs,\n      activeTab: tabs[0]\n    });\n    this.getUser(this.props.match.params.id);\n  }\n  componentWillReceiveProps(nextProps: Props) {\n    if(nextProps.match.params.id !== this.props.match.params.id) {\n      this.getUser(nextProps.match.params.id);\n    }\n  }\n  toggleEditingMode = () => {\n    this.setState({\n      isEditing: !this.state.isEditing\n    });\n  }\n  isAuthUser = (): boolean => {\n    const id = this.props.match.params.id;\n    return (this.props.authUser.data && this.props.authUser.data.id==id)\n  }\n  submitUserEdit = (id: number, values: {}) => {\n    this.setState({\n      user: {\n        data: this.state.user.data,\n        loading: true,\n        error: null\n      }\n    });\n    return apiService.put(\"/users/\" + id, { user: Object.assign({}, values, {\n        UserId: id\n      })})\n      .then((json) => {\n        this.setState({\n          isEditing: false,\n          user: {\n            data: json.user,\n            loading: false,\n            error: null\n          }\n        });\n      })\n      .catch((error) => {\n        this.setState({\n          user: {\n            data: this.state.user.data,\n            loading: false,\n            error\n          }\n        })\n      });\n    }\n\n  getUser = (id: string) => {\n    this.setState({\n      user: {\n        loading: true,\n        data: this.state.user.data,\n        error: null\n      }\n    });\n    return apiService.get(\"/users/\" + id + \"?include=applause\")\n      .then(data => {\n      this.setState({\n        user: {\n          loading: false,\n          data: data.user,\n          error: null\n        }\n      });\n    })\n    .catch((error) => {\n      this.setState({\n        user: {\n          loading: false,\n          data: this.state.user.data,\n          error\n        }\n      });\n    });\n  }\n  setActiveTab = (tabName: string) => {\n    this.setState({\n      activeTab: tabName\n    });\n  }\n  selectPost = (post: Post) => {\n    // this.props.selectPost(post);\n    this.props.history.push(`/posts/${post.id}`)\n  }\n  render() {\n    const id = this.props.match.params.id;\n    const lang = this.props.settings.languagePref;\n    const user = this.state.user.data;\n    var tabContent = '';\n\n    const userId = this.props.match.params.id;\n\n    switch(this.state.activeTab) {\n      case \"profile\":\n        if (!user || this.state.user.loading) {\n          tabContent = <div>{copy.loading[lang]}...</div>;\n          break;\n        }\n        tabContent = (\n          <div>\n            <Can\n              role={this.props.auth.role}\n              perform='profile:update'\n              data={{\n                authUserId: this.props.authUser.data.id,\n                profileOwnerId: this.state.user.data && this.state.user.data.id\n              }}\n              yes={() => (\n              <button\n                className='button'\n                style={{ float: 'right' }}\n                onClick={this.toggleEditingMode}>\n                {this.state.isEditing ? copy.cancel[lang] : copy.edit[lang]}\n              </button>\n              )}\n              no={() => null }\n            />\n            {this.state.isEditing ?\n            <UserProfileForm\n              lang={this.props.settings.languagePref}\n              user={this.state.user}\n              onSubmit={this.submitUserEdit}\n              isNewUser={false}\n            /> : <UserInfo\n              uid={this.props.match.params.id}\n              user={this.state.user}\n              isEditable={this.isAuthUser()}\n              onUpdate={this.props.onSubmitUserEdit}\n              lang={lang}\n            />}\n          </div>\n        );\n        break;\n      case \"applause\":\n        tabContent = (\n          <PostList\n            auth={this.props.auth}\n            settings={this.props.settings}\n            history={this.props.history}\n            authUser={this.props.authUser && this.props.authUser.data}\n            query={{\n              applaudedBy: userId\n            }}\n          />\n        )\n        break;\n\n      case \"posts\":\n          tabContent = (\n            <PostList\n              settings={this.props.settings}\n              history={this.props.history}\n              authUser={this.props.authUser && this.props.authUser.data}\n              query={{\n                userId\n              }}\n            />\n          )\n        break;\n      case \"account\":\n        tabContent = <div> <label className='label'>{copy.email[lang]}</label>{this.state.user.data && this.state.user.data.email}</div>\n        break;\n      default:\n          tabContent = <span>No tab selected</span>\n    }\n\n\n    return (\n      <div>\n        <h1 className='title'> {this.isAuthUser() ? copy['welcome-user'][lang].replace('$$', this.props.authUser.data.username) : this.state.user.data ? this.state.user.data.username : ''}</h1>\n        <div className=\"tabs\">\n          <ul style={{paddingLeft:'0'}}>\n            {this.state.tabs.map((tab, i) => {\n              return (<li\n                className={(this.state.activeTab==tab)?'is-active':''}\n                key={i}>\n              <a\n                name={tab}\n                key={i}\n                value={i}\n                onClick={() => this.setActiveTab(tab)}>\n                {copy[tab][lang]}\n              </a>\n            </li>\n            )})}\n          </ul>\n        </div>\n        <div className='tab-content'>\n          {tabContent}\n        </div>\n      </div>\n    )\n  }\n}\n\nvar mapStateToProps = function(appState){\n  return {\n    authUser: appState.authUser,\n    auth: appState.auth,\n    settings: appState.settings\n  }\n}\nexport default connect(mapStateToProps, {})(UserProfilePage);\n","// @flow\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { NavigationState, NavigationScreenProp } from 'react-router-dom';\nimport TextInput from '../components/TextInput';\nimport copy from '../copy';\nimport apiService from '../services/api-service';\nimport { authenticate, resetAuthForm } from '../actions/auth';\n\ntype Props = NavigationScreenProp<NavigationState> & {\n  resetAuthForm: () => void,\n  children: ?any\n}\n\ntype State = {\n  email: string,\n  username: string,\n  password: string,\n  errors: {[string]: string}\n}\nclass AuthForm extends Component<Props, State> {\n  constructor(props: Props){\n    super(props);\n    this.state = {\n      email: '',\n      username: '',\n      password: '',\n      errors: {}\n    }\n  }\n  componentWillMount() {\n    this.props.resetAuthForm();\n  }\n  componentWillReceiveProps(nextProps){\n    if (nextProps.auth.loggedIn) {\n      nextProps.history.push('/');\n    }\n  }\n\n  onFocus = (fieldName) => {\n    var errors = this.state.errors;\n    errors[fieldName] = null;\n    this.setState({\n      errors\n    });\n  }\n\n  onInputChange = (fieldName, newValue) => {\n    if (this.props.isNewUser && fieldName === 'password') {\n      this.checkPassword(newValue);\n    }\n    var newState = this.state;\n    newState[fieldName] = newValue;\n    this.setState(newState);\n  }\n  checkPassword = (password) => {\n  }\n\n  handleSubmit = () => {\n    var form = {\n      email: this.state.email,\n      username: this.state.username,\n      password: this.state.password,\n    }\n    const lang = this.props.settings.languagePref;\n    var errors = {}\n    if (!form.email || !form.email.length) {\n      errors.email = copy.empty_field_error[lang];\n    }\n    if (!form.password || !form.password.length) {\n      errors.password = copy.empty_field_error[lang];\n    }\n    if (this.props.isNewUser && (!form.username || !form.username.length)) {\n      errors.username = copy.empty_field_error[lang];\n    }\n    this.setState({\n      errors\n    });\n    if (Object.keys(errors).length == 0) {\n      this.props.authenticate(form, this.props.isNewUser);\n    }\n  }\n\n  handleKeyDown = (e: KeyboardEvent) => {\n    if (e.keyCode ==13){\n      this.handleSubmit();\n    }\n  }\n  toggle = () => {\n    if (this.props.isNewUser) {\n      this.props.history.push('/login');\n    } else {\n      this.props.history.push('/register');\n    }\n  }\n  render() {\n    const lang = this.props.settings.languagePref;\n    const errors = this.state.errors;\n    const passwordCheck = this.props.auth.passwordCheck;\n    return(\n      <div className='control'>\n        {(this.props.auth.registrationStatus=='failure')?\n            <div className=\"message is-danger\">\n              <div className=\"message-body\">\n                {copy['auth-errors']['registration-failed'][lang]}\n              </div>\n            </div>:''}\n\n            <TextInput\n              lang={lang}\n              label={copy['email'][lang]}\n              type='text'\n              name='email'\n              ref='email'\n              value={this.state.email}\n              onFocus={this.onFocus}\n              onChange={this.onInputChange}\n              icon=\"envelope\"\n              errorMsg={errors.email}\n              disableAutocomplete={this.props.isNewUser}\n            />\n            {this.props.isNewUser && <TextInput\n              lang={lang}\n              label={copy['username'][lang]}\n              type='text'\n              name='username'\n              ref='username'\n              value={this.state.username}\n              onFocus={this.onFocus}\n              onChange={this.onInputChange}\n              icon=\"user\"\n              disableAutocomplete={this.props.isNewUser}\n              errorMsg={errors.username}\n            />}\n\n          <TextInput\n              lang={lang}\n              label={copy['password'][lang]}\n              type={'password'}\n              name='password'\n              ref='password'\n              value={this.state.password}\n              onFocus={this.onFocus}\n              onChange={this.onInputChange}\n              icon=\"lock\"\n              errorMsg={errors.password}\n              disableAutocomplete={this.props.isNewUser}\n              onKeyDown={this.handleKeyDown}\n            />\n            {passwordCheck && passwordCheck.score ?\n              <div style={{ marginBottom: 12 }}>\n              {passwordCheck.score < 3 ?\n              <div className='notification is-warning'>\n                  <b>{passwordCheck.warning}</b>\n                  <b>{passwordCheck.message}</b>\n                  {passwordCheck.suggestions && passwordCheck.suggestions.map((suggestion) => {\n                    return (<li>{suggestion}</li>)\n                  })}\n                </div> :\n\n                  <div className='notification is-success'>\n                    Strong password\n                </div>\n              }\n            </div>\n            : ''}\n            {this.props.children}\n            {!this.props.auth.loading && this.props.auth.error &&\n            <div className='notification is-danger'>{this.props.auth.error}</div>}\n              <button\n                className={`button is-info ${this.props.auth.loading ? 'is-loading' : ''}`}\n                onClick={this.handleSubmit}>{this.props.isNewUser ? copy['register'][lang] : copy['sign-in'][lang] }</button>\n      </div>\n    )\n  }\n}\n\nconst mapStateToProps = (appState) => ({\n  auth: appState.auth,\n  authUser: appState.authUser,\n  settings: appState.settings\n});\n\nexport default connect(mapStateToProps, {\n  authenticate,\n  resetAuthForm\n})(AuthForm);\n","// @flow\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport TextInput from '../components/TextInput';\nimport copy from '../copy';\nimport AuthForm from '../components/AuthForm';\nimport type { SettingsState } from '../types/store';\n\ntype Props = {\n  settings: SettingsState\n}\n\nclass LoginPage extends Component<Props> {\n  render() {\n    const lang = this.props.settings.languagePref;\n    return (\n      <div>\n        <h1 className='title is-1'>{copy['login'][lang]}</h1>\n        <AuthForm\n          isNewUser={false}\n          history={this.props.history}\n        />\n        <div\n          style={{ marginTop: '24px' }}\n        >\n          <Link\n            to='/'\n          >\n            {copy['switch-to-register'][lang]}\n          </Link>\n        </div>\n      </div>\n    )\n  }\n}\n\n\nexport default connect((appState) => ({ settings: appState.settings }))(LoginPage);\n","import React, { Component } from 'react';\nimport AuthForm from '../components/AuthForm';\nimport copy from '../copy';\n\nclass RegisterPage extends Component {\n  render() {\n    return (<AuthForm\n      isNewUser\n      history={this.props.history}\n      settings={this.props.settings}\n      auth={this.props.auth}\n      checkPassword={this.props.checkPassword}\n      authenticate={this.props.authenticate}\n    />);\n  }\n}\n\nexport default RegisterPage;\n","import React, { Component } from 'react';\n\nclass AboutPage extends Component {\n  render() {\n    return(\n      <div>\n        <h1 className='title is-1' id='top'>About</h1>\n        <ol>\n          <li><a href='#what-is'>What Is Urban Applause</a></li>\n          <li><a href='#how-it-works'>How It Works</a></li>\n          <li><a href='#technology-stack'>Technology Stack</a></li>\n        </ol>\n        <hr />\n        <h2 id='what-is' className='subtitle is-2'>What Is Urban Applause</h2>\n        <p>Urban Applause lets you track street artists. You can use it to find awesome art in your neighbourhood, or to track your favorite artists as they move between cities.\n          <br/>\n          <a href='#top'>Back to top<span className='icon is-medium'><i className='fa fa-arrow-up'/></span></a>\n        </p>\n\n        <h2 id='how-it-works' className='subtitle is-2'>How It Works</h2>\n        <p>Anyone can upload to Urban Applause. Whether or not you know who the artist is, add photos of great street art you find here. If you do know the artist, you can create a new profile for them.\n          <br/>\n          <a href='#top'>Back to top<span className='icon is-medium'><i className='fa fa-arrow-up'/></span></a>\n</p>\n\n      <h2 id='technology-stack' className='subtitle is-2'>Technology Stack</h2>\n         <ul>\n           <li><a href='https://reactjs.org/'>ReactJS</a> (Javascript Framework)</li>\n           <li><a href='https://redux.js.org/'>Redux</a> (Javascript State Manager)</li>\n           <li><a href='https://bulma.io'>Bulma</a> (CSS Framework)</li>\n           <li><a href='https://expressjs.com'>Express</a> (NodeJS Server)</li>\n           <li><a href='https://jwt.io/'>JWT Web Tokens</a> (Authentication API)</li>\n           <li><a href='https://www.postgresql.org/'>PostgreSQL</a> (Database)</li>\n           <li><a href='https://www.digitalocean.com'>Digital Ocean</a> (Cloud Server)</li>\n         </ul>\n          <a href='#top'>Back to top<span className='icon is-medium'><i className='fa fa-arrow-up'/></span></a>\n      </div>\n    )\n  }\n}\n\nexport default AboutPage;\n","import React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\n\nclass ErrorPage extends Component {\n  render() {\n    return(\n      <div>\n        <h1 className='title is-1'>404</h1>\n        <h2 className='subtitle is-2'>Oops, that page doesn't exist.</h2>\n        <p>Go back to the <Link to='/'>main page?</Link></p>\n      </div>\n    )\n  }\n}\n\nexport default ErrorPage;\n","import React, { Component } from 'react';\nimport copy from '../copy';\n\nfunction validateEmail(email) {\n    var re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n    return re.test(String(email).toLowerCase());\n}\n\nclass ContactPage extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      formSubmitted: false,\n      errors: {\n        name: null,\n        email: null,\n        message: null\n      }\n    }\n  }\n  handleSubmit = (e) => {\n    e.preventDefault();\n    var hasErrors = false;\n    var errors = this.validateForm();\n    Object.keys(errors).map((key, i) => {\n      if (errors[key]){\n        hasErrors = true;\n        return;\n      }\n    });\n    if (hasErrors==false) {\n      this.setState({\n        formSubmitted: true\n      });\n      this.refs['contact-form'].submit();\n    } else {\n      this.setState({errors});\n    }\n    console.log(errors);\n  }\n\n  validateForm = () => {\n    var errors = {};\n    if (this.refs.name.value.length==0){\n      errors.name = \"Please provide a name\";\n    }\n    if (validateEmail(this.refs.email.value) == false) {\n      errors.email = \"Provide valid email\"\n    }\n    if (this.refs.message.value.length==0){\n      errors.message = \"Please provide a message\"\n    }\n    return errors;\n  }\n  showForm = () => {\n    this.setState({\n      formSubmitted: false\n    });\n  }\n  render(){\n    const lang = this.props.settings.languagePref;\n    const title = <h1 className='title is-1'>{copy['support'][lang]}</h1>\n    if (this.state.formSubmitted==true) {\n      return (\n        <div>\n          {title}\n          <p>{copy['contact-success-message'][lang]}</p><br/>\n          <button onClick={this.showForm} className='button is-primary'> {copy['contact-again'][lang]}</button>\n        </div>\n        )\n      } else {\n        return(\n          <div>\n\n        {title}\n        <form action=\"https://formspree.io/flannery.jefferson@gmail.com\" method=\"POST\" target=\"_blank\" ref='contact-form'>\n          <div className='field'>\n            <div className='label' htmlFor='name'>{copy['name-field-label'][lang]}</div>\n            <div className='control has-icons-left'>\n              <input className={`input ${this.state.errors.name?'is-danger':''}`} type=\"text\" ref='name' name=\"name\" ref='name'/>\n              <p className=\"help is-danger\">{this.state.errors.name}</p>\n            <span className=\"icon is-small is-left\">\n              <i className=\"fa fa-user\"></i>\n            </span>\n            </div>\n          </div>\n          <div className='field'>\n            <div className='label' htmlFor='email'>{copy['email'][lang]}</div>\n            <div className='control has-icons-left'>\n              <input className={`input ${this.state.errors.email?'is-danger':''}`} type=\"email\" name=\"_replyto\" ref='email'/>\n              <p className=\"help is-danger\">{this.state.errors.email}</p>\n              <span className=\"icon is-small is-left\">\n              <i className=\"fa fa-envelope\"></i>\n            </span>\n            </div>\n          </div>\n           <div className='field'>\n            <div className='label' htmlFor='name'>{copy['message-field-label'][lang]}</div>\n            <div className='control'>\n              <textarea className={`textarea ${this.state.errors.message?'is-danger':''}`}type='text' name='message' ref='message'></textarea>\n              <p className=\"help is-danger\">{this.state.errors.message}</p>\n            </div>\n          </div>\n          <button className='button is-primary' onClick={this.handleSubmit}>{copy['send'][lang]}</button>\n      </form>\n    </div>\n    )\n      }\n  }\n}\n\nexport default ContactPage;\n","import React, { Component } from 'react';\nimport authActions from '../actions/auth';\nimport ContactPage from '../pages/ContactPage';\nimport {connect} from 'react-redux';\n\nvar mapStateToProps = function(appState){\n  return {\n    settings: appState.settings\n  }\n}\nvar mapDispatchToProps = function(dispatch){\n  return {\n    resetLoginStatus: function(){ dispatch(authActions.resetLoginStatus()); },\n  }\n}\nexport default connect(mapStateToProps, mapDispatchToProps)(ContactPage);\n","import React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\n\nclass PrivacyPolicy extends Component {\n  render() {\n    return(\n      <div>\n        <h1 className='title is-1' id='top'>Privacy Policy</h1>\n        <div className='_section'>\n          <p>Urban Applause is an Open Source app. This SERVICE is provided by at no cost and is intended for use as is.</p>\n\n          <p>This page is used to inform visitors of my policies regarding the collection, use, and disclosure of Personal Information, for those who decide to use my Service.</p>\n\n          <p>If you choose to use my Service, then you agree to the collection and use of information in relation to this policy. The Personal Information that I collect is used for providing and improving the Service. I will not use or share your information with anyone except as described in this Privacy Policy.</p>\n\n          <p>The terms used in this Privacy Policy have the same meanings as in our <Link to='/terms-of-service'>Terms of Service</Link> on the Urban Applause website, unless otherwise defined in this Privacy Policy.</p>\n\n          <h3 className='title is-3'>Information Collection and Use</h3>\n          <p><b>iOS App:</b> Beyond the information Apple provides to developers that you can decide to provide, Urban Applause also uses Firebase Services within the app (Firebase's Privacy Policy can be found <a href='https://firebase.google.com/support/privacy' target='_blank'>here</a>, note that Urban Applause only uses a small subset of Firebase's many services). This helps to identify crashes and stability issues (Crashlytics, Performance Monitoring) and why they're caused (eg: a post that is crashing a lot of devices), which greatly speeds up and eases the ability to swiftly fix them. Firebase Analytics is also used within the app in order to better understand which features are being used in order to make development decisions and choose where to focus development effort. The information collected is anonymous. Urban Applause does not sell or rent your data, and the anonymous information is only collected to help make the app better.</p>\n        </div>\n        <div className='_section'>\n          <h3 className='title is-3'>Cookies</h3>\n\n          <p>Cookies are files with a small amount of data that are commonly used as anonymous unique identifiers. These are sent to your browser from the websites that you visit and are stored on your device's internal memory.</p>\n\n          <p>This Service does not use these cookies explicitly. However, the app may use third party code and libraries that use cookies to collect information and improve their services. You have the option to either accept or refuse these cookies and know when a cookie is being sent to your device. If you choose to refuse our cookies, you may not be able to use some portions of this Service.</p>\n        </div>\n        <div className='_section'>\n          <h3 className='title is-3'>Service Providers</h3>\n\n          <p>I may employ third-party companies and individuals due to the following reasons:</p>\n\n            <p>To facilitate our Service; To provide the Service on our behalf; To perform Service-related services; or To assist us in analyzing how our Service is used. I want to inform users of this Service that these third parties have access to your Personal Information. The reason is to perform the tasks assigned to them on our behalf. However, they are obligated not to disclose or use the information for any other purpose.</p>\n          </div>\n          <div className='_section'>\n            <h3 className='title is-3'>Security</h3>\n\n            <p>I value your trust in providing us your Personal Information, thus we are striving to use commercially acceptable means of protecting it. But remember that no method of transmission over the internet, or method of electronic storage is 100% secure and reliable, and I cannot guarantee its absolute security.</p>\n\n          </div>\n          <div className='_section'>\n            <h3 className='title is-3'>Links to Other Sites</h3>\n\n          <p>This Service may contain links to other sites. If you click on a third-party link, you will be directed to that site. Note that these external sites are not operated by me. Therefore, I strongly advise you to review the Privacy Policy of these websites. I have no control over and assume no responsibility for the content, privacy policies, or practices of any third-party sites or services.</p>\n\n          </div>\n          <div className='_section'>\n          <h3 className='title is-3'>Childrens Privacy</h3>\n\n          <p>These Services do not address anyone under the age of 13. I do not knowingly collect personally identifiable information from children under 13. In the case I discover that a child under 13 has provided me with personal information, I immediately delete this from our servers. If you are a parent or guardian and you are aware that your child has provided us with personal information, please <Link to='/support'>contact me</Link> so that I remove this content.</p>\n\n          </div>\n          <div className='_section'>\n          <h3 className='title is-3'>Changes to This Privacy Policy</h3>\n\n          <p>I may update our Privacy Policy from time to time. Thus, you are advised to review this page periodically for any changes. I will notify you of any changes by posting the new Privacy Policy on this page. These changes are effective immediately after they are posted on this page.</p>\n\n          </div>\n          <div className='_section'>\n          <h3 className='title is-3'>Contact Us</h3>\n\n          <p>If you have any questions or suggestions about my Privacy Policy, do not hesitate to contact me at flannery.jefferson@gmail.com.</p>\n        </div>\n\n          <a href='#top'>Back to top<span className='icon is-medium'><i className='fa fa-arrow-up'/></span></a>\n      </div>\n    )\n  }\n}\n\nexport default PrivacyPolicy;\n","import React, { Component } from 'react';\n\nclass TermsOfService extends Component {\n  render() {\n    return(\n      <div>\n        <h1 className='title is-1' id='top'>Terms of Service</h1>\n        <div className='_section'>\n          <p>This site and the mobile applications and services available in connection with this site and mobile application (the App) are made available to you by Flannery Jefferson (\"Urban Applause, We) subject to these Terms of Service, including those set forth in the <a href='/privacy-policy'>Privacy Policy</a> (the Terms). By accessing, using or downloading any materials from the App, you agree to follow and be bound by the Terms, which may be updated by us from time to time without notice to you. You can review the most current version of the Terms at any time here. We and third party providers may make improvements and/or changes in the products, services, mobile applications, features and programs described in this App at any time without notice. Certain provisions of the Terms may be supplemented or superseded by expressly designated legal notices or terms located on particular pages at this App. The App is not intended for and is not designed to attract children under 13 years of age. If you do not agree with the Terms, please do not use this App.</p>\n          <p> BY CONTINUING TO USE THE APP, YOU ARE INDICATING YOUR AGREEMENT TO THE TERMS AND ALL REVISIONS THEREOF. We reserve the right at any time and from time to time to modify or discontinue, temporarily or permanently, the App or any portion thereof with or without notice. You agree that we shall not be liable to you or to any third party for any modification, suspension or discontinuance of the App or any portion thereof.</p>\n          <h3 className='title is-3'>Account registration</h3>\n          <p>Some functionality requires you to complete an account-registration form. You agree that we may use your User Data to provide services on the App, and you represent that you are of legal age to form a binding contract and are not a person barred from receiving services under the laws of any applicable jurisdiction. We have the right to suspend or terminate your account and refuse any and all current or future use of the App at any time. </p>\n          <h3 className='title is-3'>User conduct</h3>\n          <p> You are solely responsible for maintaining the confidentiality of the password associated with your account and for restricting access to your password and to your computer while logged into the App. You accept responsibility for all activities that occur under your account or from your computer. We endeavor to use reasonable security measures to protect against unauthorized access to your account. We cannot, however, guarantee absolute security of your account, your Content or the personal information you provide, and we cannot promise that our security measures will prevent third-party hackers from illegally accessing the App or its contents. You accept all risks of unauthorized access to the User Data and any other information you provide to us. You understand that all information, data, text, software, sound, photographs, graphics, video, messages, tags, or other materials (Content), whether publicly posted or privately transmitted, available in connection with the App are the sole responsibility of the person from whom such Content originated. We do not control or monitor the Content made available in the App by others and do not guarantee the accuracy, integrity, or quality of such Content. You understand that by using the App, you may be exposed to Content that is offensive, indecent, or objectionable. Under no circumstances will we be liable in any way for any Content, including, but not limited to, any errors or omissions in any Content, or any loss or damage of any kind incurred as a result of the use of any Content posted, transmitted or otherwise made available on the App. You agree to not use the App to: </p>\n          <ul>\n            <li>(a) upload, post, transmit or otherwise make available any Content that is unlawful, harmful, threatening, abusive, harassing, tortious, defamatory, vulgar, obscene, libelous, invasive of anothers privacy, hateful, or racially, ethnically or otherwise objectionable; </li>\n            <li>(b) harm minors in any way;</li>\n            <li>(c) impersonate any person or entity, including, but not limited to, an Urban Applause official, or falsely state or otherwise misrepresent your affiliation with a person or entity; </li>\n            <li>(d) upload, post, transmit or otherwise make available any Content that you do not have a right to make available under any law or under contractual or fiduciary relationships; </li>\n            <li>(e) upload, post, transmit or otherwise make available any Content that infringes any patent, trademark, trade secret, copyright or other proprietary rights of any party; </li>\n            <li>(f) upload, post, transmit or otherwise make available any unsolicited or unauthorized advertising, promotional materials, junk mail, spam, chain letters, pyramid schemes, or any other form of solicitation;</li>\n            <li>(g) upload, post, transmit or otherwise make available any material that contains software viruses or any other computer code, files or programs designed to interrupt, destroy or limit the functionality of any computer software or hardware or telecommunications equipment;</li>\n            <li> (h) interfere with or disrupt the App or servers or networks connected to the App, or disobey any requirements, procedures, policies or regulations of networks connected to the App; and/or </li>\n            <li>(i) intentionally or unintentionally violate any applicable local, state, national or international law. </li>\n          </ul>\n          <p>You specifically agree not to access (or attempt to access) the App or the Content through any automated means (including the use of any script, web crawler, robot, spider, or scraper), and that you will not forge or manipulate identifiers in order to disguise the origin of any access (or attempted access) to the App. You acknowledge that we may or may not pre-screen or monitor Content, but that we and our designees shall have the right (but not the obligation) in their sole discretion to pre-screen, monitor, refuse or remove any Content that is available via the App. Without limiting the foregoing, we and our designees shall have the right to remove any Content that violates the Terms or is otherwise objectionable. You agree that you must evaluate, and bear all risks associated with, the use of any Content available in connection with the App, including any reliance on the accuracy, completeness, or usefulness of such Content. You acknowledge, consent and agree that we may access, preserve and disclose your User Data, and other Content if required to do so by law or in a good faith belief that such access preservation or disclosure is reasonably necessary to: </p>\n          <ul>\n            <li>(a) comply with legal process; </li>\n            <li>(b) enforce the Terms; </li>\n            <li>(c) respond to claims that any Content violates the rights of third parties; </li>\n            <li>(d) respond to your requests for customer service; or </li>\n            <li>(e) protect the rights, property or personal safety of us, its users and the public. Subject to the foregoing, we will use reasonable efforts to maintain the confidentiality of your User Data.</li>\n          </ul>\n\n          <p>The App is for your personal and noncommercial use. You may not modify, copy, distribute, transmit, display, perform, reproduce, publish, license, create derivative works from, transfer or sell for any commercial purposes any portion of the App, use of the App or access to the App.</p>\n          <h3 className='title is-3'>Electronic Communications</h3>\n          <p>The App may provide you with the ability to communicate with third party service providers, advertisers, other users, and/or us. You agree to use communication methods available on the App only to send communications and materials related to the subject matter for which we provided the communication method, and you further agree that all such communications by you shall be deemed your Content and shall be subject to and governed by the Terms. By using any of the communications methods available on the App, you acknowledge and agree that</p>\n            <ul>\n              <li>(a) all communications methods constitute public, and not private, means of communication between you and the other party or parties, </li>\n              <li>(b) communications sent to or received from third party service providers, advertisers or other third parties are not endorsed, sponsored or approved by us (unless expressly stated otherwise by Flannery Jefferson) and </li>\n              <li>(c) communications are not pre-reviewed, post-reviewed, screened, archived or otherwise monitored by us in any manner, though we reserve the right to do so at any time at its sole discretion in accordance with the Terms.</li>\n            </ul>\n            <p>You agree that all notices, disclosures and other communications that we provide to you electronically shall satisfy any legal requirement that such communications be in writing.</p>\n            <h3 className='title is-3'>Proprietary Rights</h3>\n            <p>You acknowledge and agree that the App and any necessary software used in connection with the App (if any) contain proprietary and confidential information that is protected by applicable intellectual property and other laws. Except as expressly permitted by applicable law or authorized by us or applicable third party service providers or advertisers, you agree not to modify, rent, lease, loan, sell, distribute or create derivative works based on the App, the software or Content available on the App (other than Content that you may submit), in whole or in part.</p>\n            { /* @TODO: resolve. doesn't apply while the code is open source */ }\n            {/* <p> We grant you a personal, non-transferable and non-exclusive right and license to access and use the App; provided that you do not (and do not allow any third party to) copy, modify, create a derivative work from, reverse engineer, reverse assemble, or otherwise attempt to discover any source code, sell, assign, sublicense, grant a security interest in or otherwise transfer any right in the App.</p> */}\n            <p>You agree not to access the App by any means other than through the interface that is provided by us for use in accessing the App.</p>\n            <p>The terms Urban Applause, the Urban Applause logo; and other Flannery Jefferson logos and product and service names are the exclusive trademarks of, and are owned by Flannery Jefferson, and you may not use or display such trademarks in any manner without our prior written permission. Any third party trademarks or service marks displayed on the App are the property of their respective owners. We reserve all rights not expressly granted hereunder.</p>\n            <h3 className='title is-3'>Disclaimer of Warranties and Liability</h3>\n            <p>THE INFORMATION, SOFTWARE, PRODUCTS, SERVICES, AND CONTENT AVAILABLE IN THE APP ARE PROVIDED TO YOU AS IS AND WITHOUT WARRANTY. FLANNERY JEFFERSON AND HER SUBSIDIARIES, AFFILIATES, OFFICERS, EMPLOYEES, AGENTS, PARTNERS, AND LICENSORS HEREBY DISCLAIM ALL WARRANTIES WITH REGARD TO SUCH INFORMATION, SOFTWARE, PRODUCTS, SERVICES AND CONTENT, INCLUDING, WITHOUT LIMITATION, ALL IMPLIED WARRANTIES AND CONDITIONS OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, TITLE AND NONINFRINGEMENT. FLANNERY JEFFERSON AND HER SUBSIDIARIES, AFFILIATES, OFFICERS, EMPLOYEES, AGENTS, PARTNERS, AND LICENSORS MAKE NO WARRANTY THAT (a) THE SERVICE WILL MEET YOUR REQUIREMENTS; (b) THE SERVICE WILL BE UNINTERRUPTED, TIMELY, SECURE, OR ERROR-FREE; (c) THE RESULTS THAT MAY BE OBTAINED FROM THE USE OF THE SERVICE WILL BE ACCURATE OR RELIABLE; (d) THE QUALITY OF ANY PRODUCTS, SERVICES, INFORMATION, OR OTHER MATERIAL PURCHASED OR OBTAINED BY YOU THROUGH THE SERVICE WILL MEET YOUR EXPECTATIONS; AND (e) ANY ERRORS IN THE APP WILL BE CORRECTED. YOU EXPRESSLY AGREE TO RELEASE FLANNERY JEFFERSON AND HER SUBSIDIARIES, AFFILIATES, OFFICERS, AGENTS, REPRESENTATIVES, EMPLOYEES, PARTNERS AND LICENSORS (THE RELEASED PARTIES) FROM ANY AND ALL LIABILITY CONNECTED WITH YOUR ACTIVITIES, AND PROMISE NOT TO SUE THE RELEASED PARTIES FOR ANY CLAIMS, ACTIONS, INJURIES, DAMAGES, OR LOSSES ASSOCIATED WITH YOUR ACTIVITIES. YOU ALSO AGREE THAT IN NO EVENT SHALL THE RELEASED PARTIES BE LIABLE TO YOU OR ANY THIRD PARTY FOR ANY DIRECT, INDIRECT, PUNITIVE, INCIDENTAL, SPECIAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF OR IN ANY WAY CONNECTED WITH (a) YOUR USE OR MISUSE OF THE APP, (b) YOUR DEALINGS WITH THIRD PARTY SERVICE PROVIDERS OR ADVERTISERS AVAILABLE THROUGH THE APP, (c) ANY DELAY OR INABILITY TO USE THE APP EXPERIENCED BY YOU, (d) ANY INFORMATION, SOFTWARE, PRODUCTS, SERVICES, OR CONTENT OBTAINED THROUGH THE APP, WHETHER BASED ON CONTRACT, TORT, STRICT LIABILITY, OR OTHERWISE, EVEN IF FLANNERY JEFFERSON HAS BEEN ADVISED OF THE POSSIBILITY OF DAMAGES. BECAUSE SOME STATES/JURISDICTIONS DO NOT ALLOW THE EXCLUSION OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES, THE ABOVE LIMITATION MAY NOT APPLY TO YOU. </p>\n            <h3 className='title is-3'>Indemnity</h3>\n            <p>You agree to indemnify and hold us and our subsidiaries, affiliates, officers, agents, representatives, employees, partners and licensors harmless from any claim or demand, including reasonable attorneys fees, made by any third party due to or arising out of Content you submit, post, transmit or otherwise seek to make available through the App, your use of the App, your connection to the App, your violation of the Terms, or your violation of any rights of another person or entity.</p>\n            <h3 className='title is-3'>Termination</h3>\n            <p>You agree that we may, under certain circumstances and without prior notice, immediately terminate your account and/or access to the App. Cause for such termination shall include, but not be limited to, (a) breaches or violations of the Terms or other incorporated agreements or guidelines, (b) requests by law enforcement or other government agencies, (c) a request by you (self-initiated account deletions), (d) discontinuance or material modification to the App (or any portion thereof), (e) unexpected technical or security issues or problems, (f) and/or extended periods of inactivity Termination of your account may include (x) removal of access to all offerings within the App, (y) deletion of your information, files and Content associated with or inside your account, and (z) barring of further use of the App.</p>\n            <p>Further, you agree that all terminations for cause shall be made in our sole discretion and that we shall not be liable to you or any third party for any termination of your account or access to the App.</p>\n            <h3 className='title is-3'>Applicable laws</h3>\n            <p>This App is controlled by Flannery Jefferson from within Canada. We make no representation that the Content in the App or the App are appropriate or available for use in other locations, and access to them from territories where their content or use is illegal is prohibited. Those who choose to access this App from locations outside of Canada do so on their own initiative and are responsible for compliance with applicable local laws. You may not use or export the Content in violation of Canadian export laws and regulations.</p>\n\n            <p>If any party hereto brings any suit or action against another for relief, declaratory or otherwise, arising out of these Terms, the prevailing party will have and recover against the other party, in addition to all court costs and disbursements, such sum as the court may adjudge to be reasonable attorneys fees. Except to the extent prohibited by applicable law, the parties agree that any claim or cause of action arising out of or related to use of the App or the Terms must be filed within one (1) year after such claim or cause of action arose or be forever barred. Sections 9, 11, 12, 13, 15 and 16 shall survive termination of your account and/or the Terms.</p>\n            <h3 className='title is-3'>General</h3>\n            <p>You agree that no joint venture, partnership, employment, or agency relationship exists between you and Flannery Jefferson as a result of the Terms or your use of the App. The Terms constitute the entire agreement between you and Flannery Jefferson with respect to your use of the App. The failure of us to exercise or enforce any right or provision of the Terms shall not constitute a waiver of such right or provision. If any provision of the Terms is found by a court of competent jurisdiction to be invalid, the parties nevertheless agree that the court should endeavor to give effect to the parties intentions as reflected in the provision, and the other provisions of the Terms remain in full force and effect. You may not assign, delegate or otherwise transfer your account or your obligations under these Terms without the prior written consent of us. We have the right, in its sole discretion, to transfer or assign all or any part of its rights under these Terms and will have the right to delegate or use third party contractors to fulfill its duties and obligations under these Terms and in connection with the App. Our notice to you via email, regular mail, or notices or links on the App shall constitute acceptable notice to you under the Terms. A printed version of the Terms and of any notice given in electronic form shall be admissible in judicial or administrative proceedings based upon or relating to the Terms to the same extent and subject to the same conditions as other business documents and records originally generated and maintained in printed form.</p>\n            <p>Section titles and headings in the Terms are for convenience only and have no legal or contractual effect. Any rights not expressly granted herein are reserved.</p>\n        </div>\n        <a href='#top'>Back to top<span className='icon is-medium'><i className='fa fa-arrow-up'/></span></a>\n      </div>\n    )\n  }\n}\n\nexport default TermsOfService;\n","// @flow\nimport React, { Component } from 'react';\nimport {connect} from 'react-redux';\nimport TextInput from '../components/TextInput';\nimport copy from '../copy';\nimport AuthForm from '../components/AuthForm';\nimport { APIService } from '../services/api-service';\n\n\nconst apiService = new APIService('auth');\n\ntype Props = {\n  settings: {\n    languagePref: string\n  },\n  submitPassword: (string) => void,\n  match: {\n    params: {\n      token: string\n    }\n  },\n  location: {\n    search: string\n  }\n}\n\ntype State = {\n  fieldErrors: {\n    password: ?string,\n    password_again: ?string\n  },\n  formError: ?string,\n  pageError: ?string,\n  password: string,\n  password_again: string,\n  loading: boolean,\n  didSucceed: boolean,\n  didCheckToken: boolean\n}\n\ntype Input = {\n  password: string\n}\n\ntype Output = FormError[];\n\ntype FormError = {\n  field: string,\n  code?: string,\n  message?: string\n}\n\nclass UpdatePasswordPage extends Component<Props, State> {\n  constructor(props: Props){\n    super(props);\n    this.state = {\n      password: '',\n      password_again: '',\n      loading: false,\n      fieldErrors: {},\n      formError: null,\n      pageError: null,\n      didSucceed: false,\n      didCheckToken: false\n    }\n  }\n\n  componentWillMount() {\n    console.log('mounting reset ');\n    const { token } = this.props.match.params;\n    const { search } = this.props.location;\n    apiService.get(`/update-password/${token}${search}`).then((res) => {\n      this.setState({\n        didCheckToken: true\n      });\n    }).catch((err) => {\n      this.setState({\n        pageError: err,\n        didCheckToken: true\n      });\n    });\n  }\n\n  onInputChange = (fieldName: string, newValue: string) => {\n    this.setState({\n      [fieldName]: newValue\n    });\n  }\n\n  handleSubmit = () => {\n    this.setState({\n      fieldErrors: {\n        password: null,\n        password_again: null\n      },\n      formError: null\n    });\n    const { password, password_again }  = this.state;\n    const lang = this.props.settings.languagePref;\n\n    var errors = {}\n    if (!password || !password.length) {\n      this.setState({\n        fieldErrors: {\n          ...this.state.fieldErrors,\n          password: copy.empty_field_error[lang]\n        }\n      });\n    }\n    if (!password_again || !password_again.length) {\n      this.setState({\n        fieldErrors: {\n          ...this.state.fieldErrors,\n          password_again: copy.empty_field_error[lang]\n        }\n      });\n    }\n    if (password !== password_again) {\n      this.setState({\n        formError: copy[\"auth-errors\"][\"passwords-dont-match\"][lang]\n      });\n    }\n    if (!this.state.fieldErrors.password && !this.state.fieldErrors.password_again && !this.state.formError) {\n      const { search } = this.props.location;\n      const [, email] = search.split('=');\n      const { token } = this.props.match.params;\n      this.setState({\n        loading: true\n      });\n      return apiService.put(`/update-password/${token}`, {\n        user: {\n          password,\n          email\n        }\n      })\n        .then((json) => {\n          if (json.user) {\n            this.setState({\n              loading: false,\n              didSucceed: true\n            });\n          } else {\n            console.log(json);\n          }\n      })\n      .catch((error) => {\n        console.log(error);\n        this.setState({\n          loading: false,\n          formError: error\n        });\n      });\n    } else {\n      console.log('form has errors: ', this.state.formError);\n    }\n  }\n\n  onEnterSubmit = (e: Event) => {\n    if (e.keyCode ==13){\n      this.handleSubmit();\n    }\n  }\n\n  validate = (hash: Input): Output => {\n    const rules = {\n      password: (input: string): ?string => {\n        if (input.length < 1) {\n          return 'password_presence';\n        }\n        return input.length > 8 ? null : 'password_length';\n      }\n    };\n    return Object.keys(hash).reduce((memo, key) => {\n      const error = rules[key](hash[key]);\n      if (error) {\n        return memo.concat({\n          field: key,\n          code: error\n        });\n      }\n      return memo;\n    }, []);\n  }\n  render() {\n\n    const lang = this.props.settings.languagePref;\n    if (!this.state.didCheckToken) {\n      return (\n        <div className='control'>\n          <h1 className='title is-1'>{copy['reset-password'][lang]}</h1>\n          <div>Verifying reset token...</div>\n        </div>\n      )\n    }\n    if (this.state.didSucceed) {\n      return (\n        <div className='control'>\n          <h1 className='title is-1'>{copy['reset-password'][lang]}</h1>\n          <div className='notification is-success'>{copy['reset-password-success'][lang]}</div>\n        </div>\n      )\n    }\n    if (this.state.pageError) {\n      return (\n        <div className='control'>\n          <h1 className='title is-1'>{copy['reset-password'][lang]}</h1>\n          <div className='notification is-danger'>{this.state.pageError}</div>\n        </div>\n      )\n    }\n    const { fieldErrors, password, password_again } = this.state;\n\n    const { token } = this.props.match.params;\n    const { search } = this.props.location;\n\n    return (\n      <div className='control'>\n        <h1 className='title is-1'>{copy['reset-password'][lang]}</h1>\n        <TextInput\n          lang={lang}\n          label={copy['new-password'][lang]}\n          type='password'\n          name='password'\n          ref='password'\n          value={password}\n          onChange={this.onInputChange}\n          icon=\"lock\"\n          errorMsg={fieldErrors.password}\n          disableAutocomplete\n        />\n        <TextInput\n          lang={lang}\n          label={copy['new-password-again'][lang]}\n          type='password'\n          name='password_again'\n          ref='password_again'\n          value={password_again}\n          onChange={this.onInputChange}\n          icon=\"lock\"\n          errorMsg={fieldErrors.password_again}\n          disableAutocomplete\n        />\n        {!this.state.loading && this.state.formError &&\n          <div className='notification is-danger'>{this.state.formError}</div>\n        }\n        <button\n          className={`button is-info${this.state.loading ? 'is-loading' : ''}`}\n          onClick={this.handleSubmit}>\n          {copy['submit-new-password'][lang]}\n        </button>\n\n      </div>\n)\n  }\n}\n\nvar mapStateToProps = function(appState){\n  return {\n    settings: appState.settings\n  }\n}\nvar mapDispatchToProps = function(dispatch){\n  return {\n  }\n}\nexport default connect(mapStateToProps, mapDispatchToProps)(UpdatePasswordPage);\n","import React, { Component } from 'react';\n\nclass CookieUsage extends Component {\n  render() {\n    return(\n      <div>\n        <h1 className='title is-1' id='top'>Cookie Usage</h1>\n        <div className='_section'>\n          <p>Cookies are files with a small amount of data that are commonly used as anonymous unique identifiers. These are sent to your browser from the websites that you visit and are stored on your device's internal memory.</p>\n\n          <p>This Service does not use these cookies explicitly. However, the app may use third party code and libraries that use cookies to collect information and improve their services. You have the option to either accept or refuse these cookies and know when a cookie is being sent to your device. If you choose to refuse our cookies, you may not be able to use some portions of this Service.</p>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default CookieUsage;\n","// @flow\nimport React, { Component } from 'react';\nimport { MapkitProvider, Map, useMap, Marker } from 'react-mapkit'\nimport jwt from 'jsonwebtoken';\nimport apiService from '../services/api-service';\nimport type { Post } from '../types/post';\nimport type { PostQueryParams } from '../hoc/withPostProps';\nimport withPostProps from '../hoc/withPostProps';\n\ntype Props = {\n  posts: Post[],\n  getPosts: (PostQueryParams) => Promise<any>,\n  query: PostQueryParams\n}\ntype State = {\n  error: ?string,\n  map: any,\n  markers: any[]\n}\n\nconst Mark = () => {\n  return <div style={{ width: '100px', height: '200px', backgroundColor: 'white' }}/>\n}\n\nclass MapWithUseMap extends Component<Props, State> {\n  constructor(props: Props){\n    super(props);\n    this.state = {\n      map: null,\n      markers: [],\n      error: null\n    };\n  }\n  componentWillReceiveProps(nextProps, nextState) {\n    if (!this.state.markers.length && nextProps.posts && this.state.map) {\n      const markers = [];\n      nextProps.posts.map((post) => {\n        const coords = post.Location.coordinates.coordinates;\n        const coordinates = new window.mapkit.Coordinate(coords[0], coords[1])\n        const AnnotationCallout = {\n           calloutElementForAnnotation: <div style={{ width: '100px', height: '200px', backgroundColor: 'white', border: '2px solid red' }} />\n        }\n        const annotation = new window.mapkit.MarkerAnnotation(coordinates, {\n           data: { /* Custom data here */ },\n          // color: 'green'\n          callout: AnnotationCallout\n        })\n\n        markers.push(annotation);\n        this.state.map.addAnnotation(annotation)\n      });\n      this.setState({\n        markers\n      });\n    }\n  }\n\n  componentDidMount() {\n    this.props.getPosts({ ...this.props.query });\n    apiService.get('/mapkit/token')\n      .then((res) => {\n        if (res.token) {\n          window.mapkit.init({\n            authorizationCallback: done => {\n              done(\n                res.token\n              );\n            }\n          });\n          var map = new window.mapkit.Map(\"map\");\n          this.setState({\n            map\n          });\n        }\n      })\n    .catch((error) => {\n      this.setState({\n        error\n      });\n    });\n  }\n  render() {\n      return <div id=\"map\" style={{ height: '600px', width: '800px' }}></div>\n  }\n}\n\nexport default withPostProps(MapWithUseMap);\n","// @flow\nimport React, { Component } from 'react';\nimport C from '../constants';\nimport apiService from '../services/api-service';\nimport type { Post } from '../types/post';\nimport copy from '../copy.json';\nimport type { SettingsState, AuthUserState } from '../types/store';\n\nexport type PostQueryParams = {\n  postId: ?number,\n  artistId: ?number,\n  userId: ?number,\n  search: ?string,\n  applaudedBy: ?number,\n  page: number\n}\ntype Props = {\n  query: PostQueryParams,\n  history: any,\n  authUser: AuthUserState,\n  settings: SettingsState,\n  lang: string,\n  page: number,\n  limit: number\n}\n\ntype State = {\n  loading: boolean,\n  posts: [],\n  post: ?Post,\n  error: ?string,\n  confirmDeletePost: ?number\n}\n\nexport default function withPostProps(WrappedComponent) {\n  return class extends Component<Props, State> {\n    constructor(props: Props) {\n      super(props);\n      this.state = {\n        loading: false,\n        error: null,\n        posts: [],\n        post: null,\n        authModalActive: false,\n        confirmDeletePost: null\n      }\n    }\n\n    getPosts = (query: PostQueryParams) => {\n      this.setState({\n        loading: true,\n        posts: this.state.posts && query.page > 0 ? this.state.posts : []\n      });\n      return apiService.get(\"/posts\", {}, query)\n        .then((json) => {\n          if (json.posts) {\n            this.setState({\n              loading: false,\n              posts: json.posts.concat(this.state.posts)\n            });\n          } else {\n            console.log(json);\n          }\n        })\n        .catch((error) => {\n          console.log(error);\n          this.setState({\n            posts: [],\n            loading: false,\n            error\n          });\n        });\n    }\n    getPost = (props: Props) => {\n      const postId = props.query.postId;\n      if (!postId) {\n        return\n      }\n      this.setState({ loading: true });\n      return apiService.get(`/posts/${postId}`, {})\n        .then((json) => {\n          console.log(json);\n          if (json.post) {\n            this.setState({\n              loading: false,\n              post: json.post\n            });\n          } else {\n            console.log(json);\n          }\n        })\n        .catch((error) => {\n          console.log(error);\n          this.setState({\n            post: null,\n            loading: false,\n            error\n          });\n        });\n    }\n\n    applaudPost = (PostId: number) => {\n      console.log(this.props);\n      const UserId = this.props.authUser && this.props.authUser.data && this.props.authUser.data.id;\n      if (!UserId) {\n        this.setState({\n          authModalActive: true\n        });\n        return\n      }\n      console.log('UserId: ', UserId);\n      return apiService.post(`/applause`, {\n        applause: { UserId, PostId }\n      })\n        .then((json) => {\n          if(json.applause) {\n            const applause = json.applause;\n            var newItems = this.state.posts.map((item, i) => {\n              if (item.id === applause.PostId) {\n                const updatedApplause = item.Applause ? item.Applause : [];\n                updatedApplause.push(applause);\n                return Object.assign({}, item, {\n                  Applause: updatedApplause\n                })\n              }\n              return item;\n            });\n            this.setState({\n              posts: newItems,\n              loading: false\n            })\n          } else if (json.deleted) {\n            // remove applause\n            const applause = json.deleted;\n            var newItems = this.state.posts.map((item, i) => {\n              if (item.id === applause.PostId) {\n                const updatedApplause = item.Applause ? item.Applause : [];\n                const index = updatedApplause.indexOf(applause);\n                updatedApplause.splice(index, 1)\n                if (index > -1 ) {\n                  return Object.assign({}, item, {\n                    Applause: updatedApplause\n                  })\n                }\n              }\n              return item;\n            });\n            this.setState({\n              posts: newItems,\n              loading: false\n            });\n          } else {\n            console.log(json);\n          }\n        })\n        .catch((error) => {\n          this.setState({\n            loading: false,\n            error\n          });\n        })\n    }\n    selectPost = (postId: number) => {\n      this.props.history.push(`/posts/${postId}`)\n    }\n    deletePost = (postId: number) => {\n      this.setState({\n        confirmDeletePost: postId\n      });\n    }\n    onConfirmDeletePost = () => {\n      if (this.state.confirmDeletePost) {\n        return apiService.delete(\"/posts/\" + this.state.confirmDeletePost, {})\n          .then(data => {\n            const post = data.post;\n            if (post) {\n              var newItems = this.state.posts.filter((item, i) => {\n                return item.id !== post.id\n              })\n              this.setState({\n                posts: newItems,\n                loading: false,\n                confirmDeletePost: null\n              })\n            } else {\n              throw new Error()\n            }\n          })\n          .catch((error) => {\n            this.setState({\n              loading: false,\n              error\n            });\n          })\n      }\n    }\n    viewComments = (post: number) => {\n      this.props.history.push(`/posts/${post.id}#comments`)\n    }\n    cancelDeletePost = () => {\n      this.setState({\n        confirmDeletePost: null\n      });\n    }\n    render() {\n      const lang = this.props.settings.languagePref;\n      return (\n        <div>\n          <div className={`modal ${this.state.confirmDeletePost ? 'is-active' : ''}`}>\n            <div className=\"modal-background\"></div>\n            <div className=\"modal-card\">\n              <header className=\"modal-card-head\">\n                <p className=\"modal-card-title\">{copy['confirm-delete-title'][lang].replace('$$', 'post')}</p>\n                <button className=\"delete\" aria-label=\"close\" onClick={this.cancelDeletePost}></button>\n              </header>\n              <section className=\"modal-card-body\">\n                {copy['confirm-delete-body'][lang]}\n              </section>\n              <footer className=\"modal-card-foot\">\n                <button className=\"button\" onClick={this.cancelDeletePost}>{copy['cancel'][lang]}</button>\n                <button className=\"button is-danger\" onClick={this.onConfirmDeletePost}>Delete</button>\n              </footer>\n            </div>\n            <button className=\"modal-close is-large\" aria-label=\"close\" onClick={this.cancelDeletePost}></button>\n          </div>\n          <WrappedComponent\n            post={this.state.post}\n            posts={this.state.posts}\n            loading={this.state.loading}\n            error={this.state.error}\n            getPosts={this.getPosts}\n            getPost={this.getPost}\n            deletePost={this.deletePost}\n            selectPost={this.selectPost}\n            viewComments={this.viewComments}\n            applaudPost={this.applaudPost}\n            {...this.props}\n          />\n        </div>\n      );\n    }\n  }\n}\n","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport copy from '../copy';\nimport AuthForm from '../components/AuthForm';\nimport iphoneImg from '../media/iphone_app.png';\nimport type { SettingsState } from '../types/store';\n\ntype Props = {\n  settings: SettingsState\n}\n\nclass IntroPage extends Component<Props> {\n  render() {\n    const lang = this.props.settings.languagePref;\n    const iosAppStoreButton = require(`../media/ios_app_store_button_${lang}.png`);\n    const agreementCopy = copy.agreement_on_register[lang];\n    const copyParts = agreementCopy.split('$$');\n    return (\n      <div className='public-page-wrapper'>\n        <div className='columns'>\n          <div className='column'>\n            <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center' }}>\n              <img src={iphoneImg} style={{ height: '400px', marginBottom: '24px' }} />\n              <a href='https://apps.apple.com/ca/app/urban-applause/id1488053225' target=\"_blank\"><img src={iosAppStoreButton} style={{ height: '40px' }}/></a>\n            </div>\n          </div>\n          <div className='column'>\n\n            <h3 className='title is-1'>Urban Applause</h3>\n            <h4 className='subtitle is-3'>{copy.tagline[lang]}</h4>\n            <AuthForm\n              isNewUser\n              history={this.props.history}\n              settings={this.props.settings}\n              auth={this.props.auth}\n              checkPassword={this.props.checkPassword}\n              authenticate={this.props.authenticate}\n            >\n              <p style={{ marginBottom: '24px' }}>\n                {copyParts[0]}<Link to='/terms-of-service'>{copy.terms_of_service[lang]}</Link>{copyParts[1]}<Link to='/privacy-policy'>{copy.privacy_policy[lang]}</Link>\n              </p>\n            </AuthForm>\n            <div\n              style={{ marginTop: '24px' }}\n            >\n              <Link to='/login'>\n                {copy['switch-to-login'][lang]}\n              </Link>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\nconst mapStateToProps = (appState) => ({ settings: appState.settings });\nexport default connect(mapStateToProps)(IntroPage);\n","// @flow\n\nimport React, { Component } from 'react';\nimport { Route, Redirect } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport Can from './Can';\nimport authService from '../services/auth-service';\nimport type { AuthState } from '../types/store';\n\ntype Props = {\n  auth: AuthState\n}\n\ntype State = {\n  shouldRedirect: boolean\n}\n\nclass PrivateRoute extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      shouldRedirect: false\n    }\n  }\n\n  render() {\n    const { auth, ...rest } = this.props;\n    return (\n    <Route\n      {...rest}\n      render={props =>\n      <Can\n        role={authService.role}\n        perform='post:read'\n        yes={() => (\n          <Component {...props} />\n          )}\n        no={() => (\n          <Redirect to={{ pathname: '/', state: { from: props.location } }} />\n        )}\n      />\n      }\n    />\n  )\n  }\n}\n\nexport default PrivateRoute;\n","// @flow\n\nimport { createBrowserHistory } from \"history\";\n\nexport default createBrowserHistory();\n","// @flow\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { MapkitProvider } from 'react-mapkit';\nimport Cookie from 'js-cookie';\nimport { Provider } from 'react-redux';\nimport store from './store';\nimport { router } from './router';\nimport settingsActions from './actions/settings';\nimport authActions from './actions/auth';\nimport './sass/main.scss';\nimport C from './constants';\nimport type { Store } from './types/store';\n\nconst locale = Cookie.get('locale') || 'en';\n// require(\"react-datepicker/dist/react-datepicker-cssmodules.css\");\n\ntype Props = {}\n\nclass App extends React.Component<Props> {\n  render() {\n    return (\n      <Provider store={store}>\n          <div>{router(store)}</div>\n      </Provider>\n    );\n  }\n};\n\nstore.dispatch(settingsActions.initSettings());\nstore.dispatch(authActions.checkLocalAuthState());\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n","// @flow\nimport React from 'react';\nimport ScrollToTop from '../components/ScrollToTop';\nimport Navbar from '../hoc/NavbarContainer';\nimport Footer from '../components/Footer';\n\nimport {Router, Route, Redirect, Switch} from 'react-router-dom';\n\n// redux-connected pages\nimport PostListPage from '../pages/PostListPage';\nimport PostDetailPage from '../pages/PostDetailPage';\nimport NewPostPage from '../pages/NewPostPage';\n\nimport ArtistListPage from '../pages/ArtistListPage';\nimport ArtistProfilePage from '../pages/ArtistProfilePage';\nimport ArtistFormPage from '../hoc/ArtistFormContainer';\n\nimport UserProfilePage from '../pages/UserProfilePage';\nimport RegisterPage from '../pages/RegisterPage';\nimport LoginPage from '../pages/LoginPage';\n\n//static pages\nimport AboutPage from '../pages/AboutPage';\nimport ErrorPage from '../pages/ErrorPage';\nimport ContactPage from '../hoc/ContactPageContainer';\nimport PrivacyPolicy from '../pages/PrivacyPolicy';\nimport TermsOfService from '../pages/TermsOfService';\nimport UpdatePassword from '../pages/UpdatePasswordPage';\nimport CookieUsage from '../pages/CookieUsage';\nimport Map from '../components/MapKitMap';\nimport Intro from '../pages/IntroPage';\nimport Can from '../components/Can';\nimport PrivateRoute from '../components/PrivateRoute';\n\nimport type { Store } from '../types/store';\n\nimport history from './history';\n\nexport const router = (store: Store ) => (\n  <Router history={history}>\n      <ScrollToTop>\n        <div className=\"wrapper page-content\">\n          <Switch>\n            <Route exact path='/' render={(props) => {\n              if (store.getState().auth.loggedIn) {\n                return <Redirect to='/posts'/>\n              }\n              return <Intro {...props} />}}\n\n            />\n            {/* routes with navbar */}\n            <Route path='/'>\n              {/* public routes */}\n              <Route path='/:currentRoute' component={Navbar}/>\n              <Switch>\n                <Route exact path='/login' component={LoginPage}/>\n                <Route exact path='/register' render={() => <Redirect to='/' />} />\n                <Route exact path='/about' component={AboutPage}/>\n                <Route exact path='/support' component={ContactPage}/>\n                <Route exact path='/update-password/:token' component={UpdatePassword} />\n                <Route exact path='/privacy-policy' component={PrivacyPolicy} />\n                <Route exact path='/terms-of-service' component={TermsOfService} />\n                <Route exact path='/cookie-usage' component={CookieUsage} />\n\n                {/* auth routes */}\n                <PrivateRoute exact path='/map' component={Map} />\n                <PrivateRoute exact path='/posts' component={PostListPage}/>\n                <PrivateRoute exact path='/posts/new' component={NewPostPage}/>\n                <PrivateRoute exact path='/posts/:id' component={PostDetailPage}/>\n                <PrivateRoute exact path='/users/:id' component={UserProfilePage}/>\n                { /* <Route exact path='/artists' component={ArtistListPage}/> */ }\n                <PrivateRoute exact path='/artists/new' component={ArtistFormPage}/>\n                <PrivateRoute exact path='/artists/:id' component={ArtistProfilePage}/>\n                <Route path='/:route' component={ErrorPage}/>\n              </Switch>\n            </Route>\n            <Route path='/:route' component={ErrorPage}/>\n          </Switch>\n        </div>\n      </ScrollToTop>\n      <Footer />\n    </Router>\n)\n\n"],"sourceRoot":""}